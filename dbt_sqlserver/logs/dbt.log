

============================== 2022-08-22 04:06:00.491361 | 8590d47b-1102-4e0f-a2f9-3bf3c385e793 ==============================
[0m04:06:00.491361 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:06:00.492361 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m04:06:00.492361 [debug] [MainThread]: Tracking: tracking
[0m04:06:00.506362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DE29F4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DE29F760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DE29F5B0>]}
[0m04:06:00.506362 [info ] [MainThread]: Setting up your profile.
[0m04:06:14.334101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DE29F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DE29F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259DE29CD00>]}


============================== 2022-08-22 04:06:21.788274 | 603c56da-eb16-4165-acc2-2eecfd8624c9 ==============================
[0m04:06:21.788274 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:06:21.789246 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:06:21.789246 [debug] [MainThread]: Tracking: tracking
[0m04:06:21.802247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE6B2FE170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE6B2FC2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE6B2FEC50>]}
[0m04:06:21.806247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE6B2F5EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE6B2F79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE6B2FEC50>]}


============================== 2022-08-22 04:07:53.283857 | c380ab37-81fe-41b0-9b1b-9f89a411146b ==============================
[0m04:07:53.283857 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:07:53.284858 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:53.284858 [debug] [MainThread]: Tracking: tracking
[0m04:07:53.297858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A67B4E4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A67B4FC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A67B4D300>]}
[0m04:07:53.302857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A67B47850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A67B47E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A67B4D300>]}


============================== 2022-08-22 04:09:44.129412 | 8d9b74ef-0e63-42d2-a953-c2b8ed327c3a ==============================
[0m04:09:44.129412 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:09:44.130383 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:09:44.130383 [debug] [MainThread]: Tracking: tracking
[0m04:09:44.142413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F52D2EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F52D2DAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F52D2D300>]}
[0m04:09:44.147412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F52D26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F52D27850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F52D2D300>]}


============================== 2022-08-22 04:12:10.592996 | 533f942a-92f8-41f9-8233-c7a823aa35e7 ==============================
[0m04:12:10.592996 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:12:10.593535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:12:10.593535 [debug] [MainThread]: Tracking: tracking
[0m04:12:10.593535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB39A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB398FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB398520>]}
[0m04:12:10.603823 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m04:12:10.603823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '533f942a-92f8-41f9-8233-c7a823aa35e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB397250>]}
[0m04:12:10.777676 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:12:10.815600 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:12:10.817600 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m04:12:10.825600 [debug] [MainThread]: Parsing macros\materializations\merge.sql
[0m04:12:10.828600 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m04:12:10.832600 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m04:12:10.833601 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m04:12:10.837600 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m04:12:10.838600 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:12:10.838600 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:12:10.839601 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:12:10.840600 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:12:10.840600 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:12:10.853600 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:12:10.861601 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:12:10.864601 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:12:10.867600 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:12:10.873600 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:12:10.877601 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:12:10.890601 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:12:10.892600 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:12:10.899601 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:12:10.903600 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:12:10.905600 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:12:10.905600 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:12:10.906601 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:12:10.907601 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:12:10.908601 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:12:10.910601 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:12:10.912600 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:12:10.914602 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:12:10.918601 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:12:10.922601 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:12:10.930601 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:12:10.932602 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:12:10.946600 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:12:10.959602 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:12:10.961602 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:12:10.966601 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:12:10.969600 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:12:10.971601 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:12:10.972602 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:12:10.977600 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:12:10.992601 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:12:10.998634 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:12:11.008602 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:12:11.018603 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:12:11.020632 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:12:11.033632 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:12:11.035634 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:12:11.039631 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:12:11.040633 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:12:11.041601 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:12:11.042633 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:12:11.043633 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:12:11.044603 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:12:11.049633 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:12:11.050633 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:12:11.051633 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:12:11.052603 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:12:11.053602 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:12:11.054636 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:12:11.055634 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:12:11.056632 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:12:11.057633 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:12:11.058632 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:12:11.060633 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:12:11.061602 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:12:11.062602 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:12:11.063602 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:12:11.064603 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:12:11.065602 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:12:11.067632 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:12:11.284685 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:12:11.296685 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:12:11.299687 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:12:11.303685 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m04:12:11.308098 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m04:12:11.315098 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m04:12:11.316098 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m04:12:11.320068 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m04:12:11.324068 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m04:12:11.328068 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m04:12:11.423067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB4BBCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB4BBEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABEB4BBEB0>]}


============================== 2022-08-22 04:14:02.256589 | e9410919-f5b4-4710-ab59-8f93b9c24056 ==============================
[0m04:14:02.256589 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:14:02.257590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:14:02.257590 [debug] [MainThread]: Tracking: tracking
[0m04:14:02.257590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759206B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759206BAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017592068070>]}
[0m04:14:02.266589 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m04:14:02.266589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759206B490>]}
[0m04:14:02.307587 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m04:14:02.308589 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m04:14:02.308589 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:14:02.345587 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:14:02.346588 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m04:14:02.356084 [debug] [MainThread]: Parsing macros\materializations\merge.sql
[0m04:14:02.359297 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m04:14:02.363449 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m04:14:02.364453 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m04:14:02.368453 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m04:14:02.369454 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:14:02.369454 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:14:02.370462 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:14:02.371454 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:14:02.371454 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:14:02.383461 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:14:02.391491 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:14:02.394491 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:14:02.396492 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:14:02.402492 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:14:02.406492 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:14:02.418493 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:14:02.420494 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:14:02.427488 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:14:02.431492 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:14:02.432462 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:14:02.433491 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:14:02.434493 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:14:02.434493 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:14:02.436462 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:14:02.437491 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:14:02.439491 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:14:02.441495 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:14:02.445491 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:14:02.449492 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:14:02.457491 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:14:02.458493 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:14:02.471493 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:14:02.484533 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:14:02.486501 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:14:02.491532 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:14:02.494530 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:14:02.496531 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:14:02.497530 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:14:02.502530 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:14:02.517531 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:14:02.522531 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:14:02.533530 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:14:02.543531 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:14:02.544530 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:14:02.558530 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:14:02.559531 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:14:02.563531 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:14:02.565530 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:14:02.566531 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:14:02.567531 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:14:02.567531 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:14:02.568531 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:14:02.573531 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:14:02.574973 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:14:02.575897 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:14:02.576897 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:14:02.577897 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:14:02.578897 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:14:02.579926 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:14:02.580930 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:14:02.582633 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:14:02.584061 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:14:02.586173 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:14:02.587211 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:14:02.588278 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:14:02.589367 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:14:02.590452 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:14:02.591536 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:14:02.592623 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:14:02.798862 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:14:02.810837 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:14:02.814843 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:14:02.819158 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m04:14:02.822830 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m04:14:02.830475 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m04:14:02.831475 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m04:14:02.835472 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m04:14:02.839472 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m04:14:02.843472 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m04:14:02.982080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759218F280>]}
[0m04:14:03.004048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759203A260>]}
[0m04:14:03.004048 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 269 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:14:03.005082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017592031750>]}
[0m04:14:03.006079 [info ] [MainThread]: 
[0m04:14:03.007081 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:14:03.008049 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m04:14:03.019079 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:14:03.019079 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:14:03.019079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:05.548615 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.53 seconds
[0m04:14:05.555566 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:14:06.158098 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m04:14:06.164098 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:14:06.165098 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:14:06.165098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:07.780563 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.62 seconds
[0m04:14:07.789517 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:14:08.358575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175921A1630>]}
[0m04:14:08.359543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:14:08.360543 [info ] [MainThread]: 
[0m04:14:08.374963 [debug] [Thread-1 (]: Began running node model.dbtdemo.src_hosts
[0m04:14:08.374963 [debug] [Thread-2 (]: Began running node model.dbtdemo.src_listings
[0m04:14:08.375963 [debug] [Thread-3 (]: Began running node model.dbtdemo.src_reviews
[0m04:14:08.375963 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.src_hosts"
[0m04:14:08.376965 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.src_listings"
[0m04:14:08.376965 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.src_reviews"
[0m04:14:08.377964 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.src_hosts
[0m04:14:08.377964 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.src_listings
[0m04:14:08.378963 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.src_reviews
[0m04:14:08.378963 [debug] [Thread-1 (]: Compiling model.dbtdemo.src_hosts
[0m04:14:08.378963 [debug] [Thread-2 (]: Compiling model.dbtdemo.src_listings
[0m04:14:08.379962 [debug] [Thread-3 (]: Compiling model.dbtdemo.src_reviews
[0m04:14:08.382961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.src_hosts"
[0m04:14:08.386970 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.src_listings"
[0m04:14:08.389999 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.src_reviews"
[0m04:14:08.396111 [debug] [Thread-1 (]: finished collecting timing info
[0m04:14:08.396111 [debug] [Thread-2 (]: finished collecting timing info
[0m04:14:08.396111 [debug] [Thread-3 (]: finished collecting timing info
[0m04:14:08.397107 [debug] [Thread-1 (]: Finished running node model.dbtdemo.src_hosts
[0m04:14:08.398108 [debug] [Thread-2 (]: Finished running node model.dbtdemo.src_listings
[0m04:14:08.399111 [debug] [Thread-3 (]: Finished running node model.dbtdemo.src_reviews
[0m04:14:08.400107 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_hosts_cleamsed
[0m04:14:08.400107 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_hosts_cleansed
[0m04:14:08.400107 [debug] [Thread-2 (]: Began running node model.dbtdemo.dim_listings_cleansed
[0m04:14:08.401110 [debug] [Thread-3 (]: Began running node model.dbtdemo.fct_reviews
[0m04:14:08.401110 [info ] [Thread-4 (]: 1 of 6 START table model dev.dim_hosts_cleamsed ................................ [RUN]
[0m04:14:08.402107 [info ] [Thread-1 (]: 2 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m04:14:08.402107 [info ] [Thread-2 (]: 3 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m04:14:08.402107 [info ] [Thread-3 (]: 4 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m04:14:08.404106 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:14:08.405056 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:14:08.406105 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:14:08.406656 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_hosts_cleamsed
[0m04:14:08.406656 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.fct_reviews"
[0m04:14:08.407195 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_hosts_cleansed
[0m04:14:08.407735 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.dim_listings_cleansed
[0m04:14:08.407735 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_hosts_cleamsed
[0m04:14:08.408271 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.fct_reviews
[0m04:14:08.408803 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_hosts_cleansed
[0m04:14:08.409335 [debug] [Thread-2 (]: Compiling model.dbtdemo.dim_listings_cleansed
[0m04:14:08.419664 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:14:08.419664 [debug] [Thread-3 (]: Compiling model.dbtdemo.fct_reviews
[0m04:14:08.424665 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:14:08.430699 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:14:08.436667 [debug] [Thread-3 (]: finished collecting timing info
[0m04:14:08.436667 [debug] [Thread-1 (]: finished collecting timing info
[0m04:14:08.436667 [debug] [Thread-4 (]: finished collecting timing info
[0m04:14:08.436667 [debug] [Thread-2 (]: finished collecting timing info
[0m04:14:08.437666 [debug] [Thread-3 (]: Compilation Error in model fct_reviews (models\fct\fct_reviews.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:14:08.437666 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_hosts_cleansed
[0m04:14:08.438263 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_hosts_cleamsed
[0m04:14:08.438522 [debug] [Thread-2 (]: Began executing node model.dbtdemo.dim_listings_cleansed
[0m04:14:08.438773 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017592609120>]}
[0m04:14:08.461810 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:14:08.463810 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:14:08.465810 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:14:08.465810 [error] [Thread-3 (]: 4 of 6 ERROR creating incremental model dev.fct_reviews ........................ [[31mERROR[0m in 0.03s]
[0m04:14:08.467780 [debug] [Thread-3 (]: Finished running node model.dbtdemo.fct_reviews
[0m04:14:08.468778 [debug] [Thread-3 (]: Began running node model.dbtdemo.mart_fullmoon_reviews
[0m04:14:08.468778 [info ] [Thread-3 (]: 5 of 6 SKIP relation dev.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m04:14:08.469780 [debug] [Thread-3 (]: Finished running node model.dbtdemo.mart_fullmoon_reviews
[0m04:14:08.470780 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:14:08.471780 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:14:08.471780 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:14:08.472778 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:14:08.472778 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
create or replace transient table airbnb.dev.dim_hosts_cleamsed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:14:08.472778 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
),src_listings AS (
    SELECT
    *
    FROM
    __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
      );
[0m04:14:08.472778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:14:08.472778 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:14:08.473778 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:14:11.454068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.98 seconds
[0m04:14:11.456058 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:14:11.457059 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m04:14:11.466186 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.99 seconds
[0m04:14:11.468213 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:14:11.468213 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleamsed TO ROLE REPORTER
[0m04:14:11.777480 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.3 seconds
[0m04:14:11.785441 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:14:11.786483 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m04:14:11.794439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.34 seconds
[0m04:14:11.847155 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.38 seconds
[0m04:14:11.870205 [debug] [Thread-1 (]: finished collecting timing info
[0m04:14:11.873216 [debug] [Thread-4 (]: finished collecting timing info
[0m04:14:11.873216 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: Close
[0m04:14:11.874175 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: Close
[0m04:14:12.129422 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.34 seconds
[0m04:14:12.131422 [debug] [Thread-2 (]: finished collecting timing info
[0m04:14:12.131422 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: Close
[0m04:14:12.432138 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759261BEE0>]}
[0m04:14:12.434132 [info ] [Thread-4 (]: 1 of 6 OK created table model dev.dim_hosts_cleamsed ........................... [[32mSUCCESS 1[0m in 4.03s]
[0m04:14:12.436086 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_hosts_cleamsed
[0m04:14:12.468026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175925D46D0>]}
[0m04:14:12.469023 [info ] [Thread-1 (]: 2 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 4.06s]
[0m04:14:12.471028 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_hosts_cleansed
[0m04:14:12.689599 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175926383A0>]}
[0m04:14:12.690598 [info ] [Thread-2 (]: 3 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 4.28s]
[0m04:14:12.691566 [debug] [Thread-2 (]: Finished running node model.dbtdemo.dim_listings_cleansed
[0m04:14:12.692580 [debug] [Thread-3 (]: Began running node model.dbtdemo.dim_listings_w_hosts
[0m04:14:12.692580 [info ] [Thread-3 (]: 6 of 6 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m04:14:12.693564 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:14:12.693564 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.dim_listings_w_hosts
[0m04:14:12.693564 [debug] [Thread-3 (]: Compiling model.dbtdemo.dim_listings_w_hosts
[0m04:14:12.696564 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:14:12.698595 [debug] [Thread-3 (]: finished collecting timing info
[0m04:14:12.698595 [debug] [Thread-3 (]: Began executing node model.dbtdemo.dim_listings_w_hosts
[0m04:14:12.700564 [debug] [Thread-3 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:14:12.702588 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:14:12.703564 [debug] [Thread-3 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (WITH 
l AS (
    SELECT
    *
    FROM
    airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
      );
[0m04:14:12.703564 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:14:15.219963 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.52 seconds
[0m04:14:15.222879 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:14:15.222879 [debug] [Thread-3 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m04:14:15.547617 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:14:15.551668 [debug] [Thread-3 (]: finished collecting timing info
[0m04:14:15.552619 [debug] [Thread-3 (]: On model.dbtdemo.dim_listings_w_hosts: Close
[0m04:14:16.147128 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9410919-f5b4-4710-ab59-8f93b9c24056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759265ADD0>]}
[0m04:14:16.147647 [info ] [Thread-3 (]: 6 of 6 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.45s]
[0m04:14:16.148680 [debug] [Thread-3 (]: Finished running node model.dbtdemo.dim_listings_w_hosts
[0m04:14:16.149711 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:14:16.150231 [info ] [MainThread]: 
[0m04:14:16.150231 [info ] [MainThread]: Finished running 1 incremental model, 5 table models in 0 hours 0 minutes and 13.14 seconds (13.14s).
[0m04:14:16.150756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:14:16.151308 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:14:16.151308 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m04:14:16.151308 [debug] [MainThread]: Connection 'model.dbtdemo.dim_hosts_cleansed' was properly closed.
[0m04:14:16.151855 [debug] [MainThread]: Connection 'model.dbtdemo.dim_listings_cleansed' was properly closed.
[0m04:14:16.151855 [debug] [MainThread]: Connection 'model.dbtdemo.dim_listings_w_hosts' was properly closed.
[0m04:14:16.151855 [debug] [MainThread]: Connection 'model.dbtdemo.dim_hosts_cleamsed' was properly closed.
[0m04:14:16.175587 [info ] [MainThread]: 
[0m04:14:16.176587 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:14:16.177137 [info ] [MainThread]: 
[0m04:14:16.178144 [error] [MainThread]: [33mCompilation Error in model fct_reviews (models\fct\fct_reviews.sql)[0m
[0m04:14:16.178144 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:14:16.179143 [info ] [MainThread]: 
[0m04:14:16.179143 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m04:14:16.180143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175925E81C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759218E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001759278D270>]}


============================== 2022-08-22 04:14:57.022207 | dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a ==============================
[0m04:14:57.022207 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:14:57.023208 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:14:57.023208 [debug] [MainThread]: Tracking: tracking
[0m04:14:57.024208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C89A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C8990C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C898430>]}
[0m04:14:57.054207 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m04:14:57.055208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C89B8E0>]}
[0m04:14:57.145908 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m04:14:57.146909 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m04:14:57.147909 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:14:57.183909 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:14:57.184910 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m04:14:57.192909 [debug] [MainThread]: Parsing macros\materializations\merge.sql
[0m04:14:57.196909 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m04:14:57.200909 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m04:14:57.201910 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m04:14:57.204909 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m04:14:57.205909 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:14:57.206909 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:14:57.206909 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:14:57.207909 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:14:57.208909 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:14:57.219908 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:14:57.228908 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:14:57.230909 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:14:57.232909 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:14:57.239909 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:14:57.242909 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:14:57.255909 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:14:57.257909 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:14:57.264909 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:14:57.268909 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:14:57.269909 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:14:57.270910 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:14:57.270910 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:14:57.271910 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:14:57.272909 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:14:57.274910 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:14:57.276909 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:14:57.278909 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:14:57.282909 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:14:57.286909 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:14:57.294909 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:14:57.295909 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:14:57.309908 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:14:57.322909 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:14:57.324909 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:14:57.329909 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:14:57.332909 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:14:57.334908 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:14:57.335909 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:14:57.340998 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:14:57.356373 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:14:57.361373 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:14:57.372373 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:14:57.382375 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:14:57.383377 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:14:57.397373 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:14:57.399373 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:14:57.403373 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:14:57.405373 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:14:57.405373 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:14:57.406344 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:14:57.407375 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:14:57.408344 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:14:57.414375 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:14:57.414985 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:14:57.415919 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:14:57.416950 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:14:57.417953 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:14:57.418952 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:14:57.419918 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:14:57.420919 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:14:57.422948 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:14:57.423948 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:14:57.425949 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:14:57.426949 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:14:57.427949 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:14:57.428948 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:14:57.429948 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:14:57.430917 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:14:57.432948 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:14:57.435948 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m04:14:57.439921 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m04:14:57.439921 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m04:14:57.448948 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m04:14:57.451948 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m04:14:57.453948 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m04:14:57.455949 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m04:14:57.457950 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m04:14:57.459948 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m04:14:57.470951 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m04:14:57.473948 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m04:14:57.477951 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m04:14:57.482951 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m04:14:57.484919 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m04:14:57.489949 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m04:14:57.494948 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m04:14:57.495917 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m04:14:57.517958 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m04:14:57.532957 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m04:14:57.541990 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m04:14:57.546993 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m04:14:57.551997 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m04:14:57.555984 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m04:14:57.561987 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m04:14:57.564990 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m04:14:57.568958 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m04:14:57.573987 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m04:14:57.576989 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m04:14:57.584988 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m04:14:57.585958 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m04:14:57.595987 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m04:14:57.598042 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m04:14:57.599050 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m04:14:57.602049 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m04:14:57.621120 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m04:14:57.622120 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m04:14:57.627122 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m04:14:57.660812 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m04:14:57.674407 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m04:14:57.683964 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m04:14:57.693996 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m04:14:57.707996 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m04:14:57.756007 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m04:14:57.764040 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m04:14:57.765035 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m04:14:57.766033 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m04:14:57.800038 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m04:14:57.815102 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m04:14:57.825047 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m04:14:57.837072 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m04:14:57.850076 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m04:14:57.871075 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m04:14:57.880254 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m04:14:57.886574 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m04:14:57.893929 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m04:14:57.927000 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m04:14:57.940000 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m04:14:57.951001 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m04:14:57.962005 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m04:14:57.975998 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m04:14:57.977001 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m04:14:57.984999 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m04:14:57.985970 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m04:14:57.986971 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m04:14:57.988000 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m04:14:57.990002 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m04:14:57.991971 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m04:14:57.994000 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m04:14:57.996001 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m04:14:57.998001 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m04:14:57.999005 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m04:14:58.000001 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m04:14:58.004000 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m04:14:58.008971 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m04:14:58.011001 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m04:14:58.019003 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m04:14:58.021000 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m04:14:58.023000 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m04:14:58.024001 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m04:14:58.025003 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m04:14:58.026003 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m04:14:58.027002 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m04:14:58.031001 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m04:14:58.032001 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m04:14:58.038970 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m04:14:58.039971 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m04:14:58.041972 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m04:14:58.043001 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m04:14:58.045005 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m04:14:58.047000 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m04:14:58.052001 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m04:14:58.055998 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m04:14:58.058000 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m04:14:58.058971 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m04:14:58.061000 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m04:14:58.062001 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m04:14:58.064001 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m04:14:58.067004 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m04:14:58.068970 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m04:14:58.070969 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m04:14:58.071970 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m04:14:58.079970 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m04:14:58.081969 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m04:14:58.082970 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m04:14:58.084969 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m04:14:58.085970 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m04:14:58.088001 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m04:14:58.091000 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m04:14:58.091989 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m04:14:58.093763 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m04:14:58.096153 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m04:14:58.097185 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m04:14:58.098379 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m04:14:58.100002 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m04:14:58.101111 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m04:14:58.120886 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m04:14:58.124886 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m04:14:58.130919 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m04:14:58.133887 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m04:14:58.138916 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m04:14:58.141916 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m04:14:58.143916 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m04:14:58.146916 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m04:14:58.148917 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m04:14:58.154916 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m04:14:58.155916 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m04:14:58.157916 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m04:14:58.158887 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m04:14:58.163916 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m04:14:58.164916 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m04:14:58.166916 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m04:14:58.169916 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m04:14:58.171916 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m04:14:58.174917 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m04:14:58.177886 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m04:14:58.187916 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m04:14:58.194920 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m04:14:58.195916 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m04:14:58.197916 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m04:14:58.891410 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:14:58.903409 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:14:58.908416 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:14:58.912441 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m04:14:58.916442 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m04:14:58.936442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m04:14:58.938411 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m04:14:58.942411 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m04:14:58.947411 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m04:14:58.951411 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m04:14:59.132012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CB868F0>]}
[0m04:14:59.168012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C8972B0>]}
[0m04:14:59.168980 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 633 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:14:59.168980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CB7DB70>]}
[0m04:14:59.170981 [info ] [MainThread]: 
[0m04:14:59.171980 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:14:59.172981 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m04:14:59.184010 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:14:59.185012 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:14:59.185012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:01.346108 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.16 seconds
[0m04:15:01.349109 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:15:02.215807 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m04:15:02.221805 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:15:02.221805 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:15:02.221805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:03.834105 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.61 seconds
[0m04:15:03.836108 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:15:05.035655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CB854B0>]}
[0m04:15:05.035655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:15:05.036657 [info ] [MainThread]: 
[0m04:15:05.040659 [debug] [Thread-1 (]: Began running node model.dbtdemo.src_hosts
[0m04:15:05.040659 [debug] [Thread-2 (]: Began running node model.dbtdemo.src_listings
[0m04:15:05.041656 [debug] [Thread-3 (]: Began running node model.dbtdemo.src_reviews
[0m04:15:05.041656 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.src_hosts"
[0m04:15:05.041656 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.src_listings"
[0m04:15:05.042655 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.src_reviews"
[0m04:15:05.042655 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.src_hosts
[0m04:15:05.042655 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.src_listings
[0m04:15:05.043655 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.src_reviews
[0m04:15:05.043655 [debug] [Thread-1 (]: Compiling model.dbtdemo.src_hosts
[0m04:15:05.044026 [debug] [Thread-2 (]: Compiling model.dbtdemo.src_listings
[0m04:15:05.044277 [debug] [Thread-3 (]: Compiling model.dbtdemo.src_reviews
[0m04:15:05.046285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.src_hosts"
[0m04:15:05.049283 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.src_listings"
[0m04:15:05.052282 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.src_reviews"
[0m04:15:05.053281 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:05.054282 [debug] [Thread-2 (]: finished collecting timing info
[0m04:15:05.054282 [debug] [Thread-3 (]: finished collecting timing info
[0m04:15:05.054282 [debug] [Thread-1 (]: Finished running node model.dbtdemo.src_hosts
[0m04:15:05.055282 [debug] [Thread-2 (]: Finished running node model.dbtdemo.src_listings
[0m04:15:05.055282 [debug] [Thread-3 (]: Finished running node model.dbtdemo.src_reviews
[0m04:15:05.056283 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_hosts_cleamsed
[0m04:15:05.056283 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_hosts_cleansed
[0m04:15:05.056283 [debug] [Thread-2 (]: Began running node model.dbtdemo.dim_listings_cleansed
[0m04:15:05.056283 [debug] [Thread-3 (]: Began running node model.dbtdemo.fct_reviews
[0m04:15:05.056283 [info ] [Thread-4 (]: 1 of 6 START table model dev.dim_hosts_cleamsed ................................ [RUN]
[0m04:15:05.057283 [info ] [Thread-1 (]: 2 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m04:15:05.057283 [info ] [Thread-2 (]: 3 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m04:15:05.057283 [info ] [Thread-3 (]: 4 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m04:15:05.058283 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:15:05.059283 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:15:05.059283 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:15:05.059283 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_hosts_cleamsed
[0m04:15:05.059283 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:05.060283 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_hosts_cleansed
[0m04:15:05.060283 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.dim_listings_cleansed
[0m04:15:05.060283 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_hosts_cleamsed
[0m04:15:05.060283 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.fct_reviews
[0m04:15:05.060283 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_hosts_cleansed
[0m04:15:05.061283 [debug] [Thread-2 (]: Compiling model.dbtdemo.dim_listings_cleansed
[0m04:15:05.071282 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:15:05.072282 [debug] [Thread-3 (]: Compiling model.dbtdemo.fct_reviews
[0m04:15:05.077281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:15:05.083283 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:15:05.097281 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.fct_reviews"
[0m04:15:05.097281 [debug] [Thread-4 (]: finished collecting timing info
[0m04:15:05.098318 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_hosts_cleamsed
[0m04:15:05.108284 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:05.108284 [debug] [Thread-2 (]: finished collecting timing info
[0m04:15:05.122313 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:15:05.123316 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_hosts_cleansed
[0m04:15:05.123316 [debug] [Thread-2 (]: Began executing node model.dbtdemo.dim_listings_cleansed
[0m04:15:05.127313 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:15:05.127313 [debug] [Thread-3 (]: finished collecting timing info
[0m04:15:05.129315 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:15:05.130283 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:15:05.130283 [debug] [Thread-3 (]: Began executing node model.dbtdemo.fct_reviews
[0m04:15:05.131283 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
create or replace transient table airbnb.dev.dim_hosts_cleamsed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:15:05.139281 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:15:05.140284 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:15:05.157282 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:05.157282 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:15:05.157282 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
),src_listings AS (
    SELECT
    *
    FROM
    __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
      );
[0m04:15:05.158283 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:15:05.158283 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
),src_reviews AS (
SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m04:15:05.160316 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:15:05.160316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:15:05.161282 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:15:07.773451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.61 seconds
[0m04:15:07.781451 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:15:07.782450 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m04:15:08.009279 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.85 seconds
[0m04:15:08.017277 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:15:08.018273 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m04:15:08.084494 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.93 seconds
[0m04:15:08.087523 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:15:08.088523 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleamsed TO ROLE REPORTER
[0m04:15:08.116499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:15:08.151498 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:08.151498 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: Close
[0m04:15:08.177525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.02 seconds
[0m04:15:08.186878 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:08.186878 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:15:08.332748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.31 seconds
[0m04:15:08.334740 [debug] [Thread-2 (]: finished collecting timing info
[0m04:15:08.334740 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: Close
[0m04:15:08.411234 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:15:08.412239 [debug] [Thread-4 (]: finished collecting timing info
[0m04:15:08.413238 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: Close
[0m04:15:08.502184 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.31 seconds
[0m04:15:08.507178 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:08.507178 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m04:15:08.731619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CE171F0>]}
[0m04:15:08.732139 [info ] [Thread-1 (]: 2 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 3.67s]
[0m04:15:08.733184 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_hosts_cleansed
[0m04:15:08.817806 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.31 seconds
[0m04:15:08.831806 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:08.831806 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:15:08.942400 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CE14670>]}
[0m04:15:08.944394 [info ] [Thread-2 (]: 3 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 3.88s]
[0m04:15:08.948400 [debug] [Thread-2 (]: Finished running node model.dbtdemo.dim_listings_cleansed
[0m04:15:08.950450 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_listings_w_hosts
[0m04:15:08.951447 [info ] [Thread-1 (]: 5 of 6 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m04:15:08.954395 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:15:08.955401 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_listings_w_hosts
[0m04:15:08.956438 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_listings_w_hosts
[0m04:15:08.973445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:15:08.981450 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:08.982444 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_listings_w_hosts
[0m04:15:08.990390 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:15:08.996473 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:15:08.996473 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (WITH 
l AS (
    SELECT
    *
    FROM
    airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
      );
[0m04:15:08.997479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:15:08.999851 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CE15240>]}
[0m04:15:09.002251 [info ] [Thread-4 (]: 1 of 6 OK created table model dev.dim_hosts_cleamsed ........................... [[32mSUCCESS 1[0m in 3.94s]
[0m04:15:09.005244 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_hosts_cleamsed
[0m04:15:09.140600 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.31 seconds
[0m04:15:09.155554 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:09.157554 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m04:15:09.481449 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.32 seconds
[0m04:15:09.492443 [debug] [Thread-3 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:15:09.509445 [debug] [Thread-3 (]: Writing runtime SQL for node "model.dbtdemo.fct_reviews"
[0m04:15:09.512278 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:09.513289 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
BEGIN
[0m04:15:09.850783 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.34 seconds
[0m04:15:09.851788 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:09.851788 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m04:15:10.314382 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.46 seconds
[0m04:15:10.315370 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:10.316669 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
COMMIT
[0m04:15:11.091481 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.77 seconds
[0m04:15:11.097483 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:15:11.097483 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m04:15:11.410035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.41 seconds
[0m04:15:11.412035 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:15:11.412035 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m04:15:11.417034 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:15:11.418034 [debug] [Thread-3 (]: finished collecting timing info
[0m04:15:11.419035 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: Close
[0m04:15:11.742638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:15:11.747631 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:11.748583 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_w_hosts: Close
[0m04:15:12.015045 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9D013B20>]}
[0m04:15:12.016056 [info ] [Thread-3 (]: 4 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 6.96s]
[0m04:15:12.019014 [debug] [Thread-3 (]: Finished running node model.dbtdemo.fct_reviews
[0m04:15:12.023017 [debug] [Thread-2 (]: Began running node model.dbtdemo.mart_fullmoon_reviews
[0m04:15:12.025009 [info ] [Thread-2 (]: 6 of 6 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m04:15:12.027035 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:15:12.028059 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.mart_fullmoon_reviews
[0m04:15:12.028059 [debug] [Thread-2 (]: Compiling model.dbtdemo.mart_fullmoon_reviews
[0m04:15:12.037055 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:15:12.043119 [debug] [Thread-2 (]: finished collecting timing info
[0m04:15:12.043119 [debug] [Thread-2 (]: Began executing node model.dbtdemo.mart_fullmoon_reviews
[0m04:15:12.049079 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:15:12.053958 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:15:12.053958 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
[0m04:15:12.053958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:15:12.338509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9D15E9E0>]}
[0m04:15:12.339954 [info ] [Thread-1 (]: 5 of 6 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.38s]
[0m04:15:12.344973 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_listings_w_hosts
[0m04:15:18.769043 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.72 seconds
[0m04:15:18.771590 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:15:18.771590 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_reviews TO ROLE REPORTER
[0m04:15:19.093354 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:15:19.095354 [debug] [Thread-2 (]: finished collecting timing info
[0m04:15:19.095354 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: Close
[0m04:15:19.707268 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9e4ec4-17bb-4fa7-8303-72ca58fecf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9D16A230>]}
[0m04:15:19.709274 [info ] [Thread-2 (]: 6 of 6 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 7.68s]
[0m04:15:19.713222 [debug] [Thread-2 (]: Finished running node model.dbtdemo.mart_fullmoon_reviews
[0m04:15:19.718267 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:15:19.719267 [info ] [MainThread]: 
[0m04:15:19.721894 [info ] [MainThread]: Finished running 5 table models, 1 incremental model in 0 hours 0 minutes and 20.55 seconds (20.55s).
[0m04:15:19.723917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:15:19.724954 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:15:19.724954 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m04:15:19.725962 [debug] [MainThread]: Connection 'model.dbtdemo.dim_listings_w_hosts' was properly closed.
[0m04:15:19.725962 [debug] [MainThread]: Connection 'model.dbtdemo.mart_fullmoon_reviews' was properly closed.
[0m04:15:19.726965 [debug] [MainThread]: Connection 'model.dbtdemo.fct_reviews' was properly closed.
[0m04:15:19.726965 [debug] [MainThread]: Connection 'model.dbtdemo.dim_hosts_cleamsed' was properly closed.
[0m04:15:19.783266 [info ] [MainThread]: 
[0m04:15:19.783778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:15:19.784303 [info ] [MainThread]: 
[0m04:15:19.785206 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m04:15:19.785711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CB4BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9CAA7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9D03A8F0>]}


============================== 2022-08-22 04:29:25.489399 | a8abdcfb-6348-426f-932b-5481532eb157 ==============================
[0m04:29:25.489399 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:29:25.490369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:29:25.490369 [debug] [MainThread]: Tracking: tracking
[0m04:29:25.491369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA536830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA5350F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA534400>]}
[0m04:29:25.538368 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:29:25.539368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135E33AFD60>]}
[0m04:29:25.672369 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m04:29:25.673368 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m04:29:25.674368 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:29:25.715369 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:29:25.717368 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m04:29:25.725368 [debug] [MainThread]: Parsing macros\materializations\merge.sql
[0m04:29:25.729366 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m04:29:25.733367 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m04:29:25.734368 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m04:29:25.737366 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m04:29:25.738368 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:29:25.739367 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:29:25.740368 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:29:25.740368 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:29:25.741370 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:29:25.753367 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:29:25.761367 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:29:25.764366 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:29:25.766368 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:29:25.773366 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:29:25.777368 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:29:25.790367 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:29:25.792369 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:29:25.799367 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:29:25.803368 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:29:25.804367 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:29:25.805367 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:29:25.806367 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:29:25.806367 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:29:25.808367 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:29:25.809367 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:29:25.811367 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:29:25.813367 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:29:25.817399 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:29:25.821367 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:29:25.829367 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:29:25.830399 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:29:25.844400 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:29:25.857369 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:29:25.860368 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:29:25.864369 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:29:25.867399 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:29:25.869398 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:29:25.871399 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:29:25.876369 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:29:25.891404 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:29:25.896399 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:29:25.907399 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:29:25.918396 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:29:25.919399 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:29:25.934371 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:29:25.936399 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:29:25.940369 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:29:25.941403 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:29:25.942399 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:29:25.943369 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:29:25.944369 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:29:25.945370 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:29:25.951371 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:29:25.952369 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:29:25.953367 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:29:25.954399 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:29:25.955399 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:29:25.956399 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:29:25.957400 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:29:25.958400 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:29:25.959399 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:29:25.960401 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:29:25.962399 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:29:25.964369 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:29:25.965387 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:29:25.967369 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:29:25.968368 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:29:25.969368 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:29:25.971367 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:29:25.974368 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m04:29:25.978369 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m04:29:25.979369 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m04:29:25.987367 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m04:29:25.990368 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m04:29:25.992367 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m04:29:25.994367 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m04:29:25.996367 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m04:29:25.998367 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m04:29:26.009370 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m04:29:26.012368 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m04:29:26.016368 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m04:29:26.021399 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m04:29:26.023398 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m04:29:26.028370 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m04:29:26.034368 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m04:29:26.035368 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m04:29:26.057370 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m04:29:26.071369 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m04:29:26.082369 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m04:29:26.086369 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m04:29:26.091369 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m04:29:26.095370 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m04:29:26.101369 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m04:29:26.105369 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m04:29:26.108370 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m04:29:26.142367 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m04:29:26.145367 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m04:29:26.153367 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m04:29:26.154367 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m04:29:26.164367 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m04:29:26.166367 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m04:29:26.167367 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m04:29:26.169367 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m04:29:26.188367 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m04:29:26.190367 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m04:29:26.194367 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m04:29:26.228368 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m04:29:26.240394 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m04:29:26.250398 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m04:29:26.260398 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m04:29:26.277369 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m04:29:26.296368 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m04:29:26.304368 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m04:29:26.305367 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m04:29:26.306368 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m04:29:26.340399 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m04:29:26.354398 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m04:29:26.365400 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m04:29:26.377399 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m04:29:26.389398 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m04:29:26.410370 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m04:29:26.419399 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m04:29:26.425402 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m04:29:26.432401 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m04:29:26.466400 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m04:29:26.478399 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m04:29:26.489402 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m04:29:26.500399 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m04:29:26.514400 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m04:29:26.515401 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m04:29:26.523399 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m04:29:26.524401 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m04:29:26.525372 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m04:29:26.526399 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m04:29:26.528369 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m04:29:26.530369 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m04:29:26.533400 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m04:29:26.534399 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m04:29:26.536399 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m04:29:26.538399 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m04:29:26.538399 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m04:29:26.542399 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m04:29:26.547399 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m04:29:26.549399 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m04:29:26.557368 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m04:29:26.559367 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m04:29:26.560368 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m04:29:26.561368 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m04:29:26.563367 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m04:29:26.564368 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m04:29:26.565367 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m04:29:26.568367 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m04:29:26.569399 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m04:29:26.576399 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m04:29:26.577368 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m04:29:26.579399 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m04:29:26.580367 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m04:29:26.582399 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m04:29:26.583399 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m04:29:26.588403 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m04:29:26.593399 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m04:29:26.594399 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m04:29:26.595394 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m04:29:26.598399 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m04:29:26.599399 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m04:29:26.600399 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m04:29:26.603399 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m04:29:26.605399 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m04:29:26.606400 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m04:29:26.608400 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m04:29:26.615404 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m04:29:26.617401 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m04:29:26.618369 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m04:29:26.620399 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m04:29:26.622406 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m04:29:26.624401 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m04:29:26.626399 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m04:29:26.627369 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m04:29:26.629398 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m04:29:26.631397 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m04:29:26.632369 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m04:29:26.633369 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m04:29:26.634369 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m04:29:26.635370 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m04:29:26.656399 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m04:29:26.659400 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m04:29:26.665402 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m04:29:26.669368 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m04:29:26.673367 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m04:29:26.676368 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m04:29:26.678367 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m04:29:26.681367 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m04:29:26.685367 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m04:29:26.690399 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m04:29:26.691399 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m04:29:26.693403 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m04:29:26.694399 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m04:29:26.699399 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m04:29:26.700401 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m04:29:26.702396 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m04:29:26.705399 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m04:29:26.707399 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m04:29:26.710399 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m04:29:26.713399 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m04:29:26.722394 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m04:29:26.729401 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m04:29:26.731400 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m04:29:26.732399 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m04:29:27.453368 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:29:27.465368 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:29:27.470396 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:29:27.474401 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m04:29:27.478370 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m04:29:27.500400 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m04:29:27.501399 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m04:29:27.505400 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m04:29:27.510400 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m04:29:27.514399 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m04:29:27.690406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA82AEC0>]}
[0m04:29:27.728370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA516770>]}
[0m04:29:27.728370 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 633 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:29:27.729368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA821570>]}
[0m04:29:27.731372 [info ] [MainThread]: 
[0m04:29:27.731372 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:29:27.733369 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m04:29:27.745371 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:29:27.745371 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:29:27.745371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:29.865817 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.12 seconds
[0m04:29:29.868238 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:29:30.458539 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m04:29:30.478598 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:29:30.479597 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:29:30.480597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:29:32.409353 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.93 seconds
[0m04:29:32.411354 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:29:33.006926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA6798A0>]}
[0m04:29:33.007955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:29:33.008928 [info ] [MainThread]: 
[0m04:29:33.020484 [debug] [Thread-1 (]: Began running node model.dbtdemo.src_hosts
[0m04:29:33.020484 [debug] [Thread-2 (]: Began running node model.dbtdemo.src_listings
[0m04:29:33.021486 [debug] [Thread-3 (]: Began running node model.dbtdemo.src_reviews
[0m04:29:33.021486 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.src_hosts"
[0m04:29:33.022487 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.src_listings"
[0m04:29:33.023488 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.src_reviews"
[0m04:29:33.024537 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.src_hosts
[0m04:29:33.024537 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.src_listings
[0m04:29:33.025482 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.src_reviews
[0m04:29:33.026514 [debug] [Thread-1 (]: Compiling model.dbtdemo.src_hosts
[0m04:29:33.026514 [debug] [Thread-2 (]: Compiling model.dbtdemo.src_listings
[0m04:29:33.027481 [debug] [Thread-3 (]: Compiling model.dbtdemo.src_reviews
[0m04:29:33.032518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.src_hosts"
[0m04:29:33.038518 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.src_listings"
[0m04:29:33.043484 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.src_reviews"
[0m04:29:33.046479 [debug] [Thread-1 (]: finished collecting timing info
[0m04:29:33.047479 [debug] [Thread-3 (]: finished collecting timing info
[0m04:29:33.047479 [debug] [Thread-2 (]: finished collecting timing info
[0m04:29:33.048513 [debug] [Thread-1 (]: Finished running node model.dbtdemo.src_hosts
[0m04:29:33.048513 [debug] [Thread-3 (]: Finished running node model.dbtdemo.src_reviews
[0m04:29:33.049479 [debug] [Thread-2 (]: Finished running node model.dbtdemo.src_listings
[0m04:29:33.050480 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_hosts_cleamsed
[0m04:29:33.050480 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_hosts_cleansed
[0m04:29:33.051064 [debug] [Thread-3 (]: Began running node model.dbtdemo.fct_reviews
[0m04:29:33.051563 [info ] [Thread-4 (]: 1 of 6 START table model dev.dim_hosts_cleamsed ................................ [RUN]
[0m04:29:33.051894 [debug] [Thread-2 (]: Began running node model.dbtdemo.dim_listings_cleansed
[0m04:29:33.051894 [info ] [Thread-1 (]: 2 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m04:29:33.051894 [info ] [Thread-3 (]: 3 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m04:29:33.052899 [info ] [Thread-2 (]: 4 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m04:29:33.052899 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:29:33.053900 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:29:33.053900 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_hosts_cleamsed
[0m04:29:33.054901 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:33.054901 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:29:33.054901 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_hosts_cleansed
[0m04:29:33.054901 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_hosts_cleamsed
[0m04:29:33.054901 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.fct_reviews
[0m04:29:33.055899 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.dim_listings_cleansed
[0m04:29:33.055899 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_hosts_cleansed
[0m04:29:33.065901 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:29:33.066899 [debug] [Thread-3 (]: Compiling model.dbtdemo.fct_reviews
[0m04:29:33.066899 [debug] [Thread-2 (]: Compiling model.dbtdemo.dim_listings_cleansed
[0m04:29:33.071930 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:29:33.084930 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.fct_reviews"
[0m04:29:33.091899 [debug] [Thread-4 (]: finished collecting timing info
[0m04:29:33.091899 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:29:33.092902 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_hosts_cleamsed
[0m04:29:33.106935 [debug] [Thread-1 (]: finished collecting timing info
[0m04:29:33.116899 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:29:33.116899 [debug] [Thread-3 (]: finished collecting timing info
[0m04:29:33.117899 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_hosts_cleansed
[0m04:29:33.117899 [debug] [Thread-3 (]: Began executing node model.dbtdemo.fct_reviews
[0m04:29:33.121898 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:29:33.121898 [debug] [Thread-2 (]: finished collecting timing info
[0m04:29:33.122898 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:29:33.146898 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:33.146898 [debug] [Thread-2 (]: Began executing node model.dbtdemo.dim_listings_cleansed
[0m04:29:33.147900 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
create or replace transient table airbnb.dev.dim_hosts_cleamsed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:29:33.147900 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
),src_reviews AS (
SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m04:29:33.150900 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:29:33.151899 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:29:33.151899 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:29:33.151899 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:29:33.152900 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:29:33.155902 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:29:33.156898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:29:33.157900 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
),src_listings AS (
    SELECT
    *
    FROM
    __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
      );
[0m04:29:33.158899 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:29:36.363668 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.21 seconds
[0m04:29:36.376646 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:36.377688 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:29:36.479954 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.33 seconds
[0m04:29:36.484956 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:29:36.485920 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleamsed TO ROLE REPORTER
[0m04:29:36.537159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.38 seconds
[0m04:29:36.540156 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:29:36.540156 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m04:29:36.682456 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.3 seconds
[0m04:29:36.689453 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:36.689453 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m04:29:36.781781 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.29 seconds
[0m04:29:36.823777 [debug] [Thread-4 (]: finished collecting timing info
[0m04:29:36.823777 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: Close
[0m04:29:36.842762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.3 seconds
[0m04:29:36.844769 [debug] [Thread-1 (]: finished collecting timing info
[0m04:29:36.844769 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: Close
[0m04:29:36.876742 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.72 seconds
[0m04:29:36.878741 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:29:36.878741 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m04:29:36.987303 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.3 seconds
[0m04:29:37.001302 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:37.001302 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:29:37.215303 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.34 seconds
[0m04:29:37.217307 [debug] [Thread-2 (]: finished collecting timing info
[0m04:29:37.217307 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: Close
[0m04:29:37.295303 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.29 seconds
[0m04:29:37.299302 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:37.299302 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m04:29:37.380301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAA23E20>]}
[0m04:29:37.381301 [info ] [Thread-4 (]: 1 of 6 OK created table model dev.dim_hosts_cleamsed ........................... [[32mSUCCESS 1[0m in 4.33s]
[0m04:29:37.382302 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_hosts_cleamsed
[0m04:29:37.407132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAAA4CD0>]}
[0m04:29:37.407132 [info ] [Thread-1 (]: 2 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 4.35s]
[0m04:29:37.409129 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_hosts_cleansed
[0m04:29:37.584098 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.28 seconds
[0m04:29:37.592099 [debug] [Thread-3 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:29:37.603098 [debug] [Thread-3 (]: Writing runtime SQL for node "model.dbtdemo.fct_reviews"
[0m04:29:37.605099 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:37.606100 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
BEGIN
[0m04:29:37.790122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAAA5E40>]}
[0m04:29:37.791196 [info ] [Thread-2 (]: 4 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 4.74s]
[0m04:29:37.792253 [debug] [Thread-2 (]: Finished running node model.dbtdemo.dim_listings_cleansed
[0m04:29:37.793321 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_listings_w_hosts
[0m04:29:37.793321 [info ] [Thread-4 (]: 5 of 6 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m04:29:37.795332 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:29:37.795332 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_listings_w_hosts
[0m04:29:37.795332 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_listings_w_hosts
[0m04:29:37.800735 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:29:37.803336 [debug] [Thread-4 (]: finished collecting timing info
[0m04:29:37.803850 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_listings_w_hosts
[0m04:29:37.808863 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:29:37.811862 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:29:37.812861 [debug] [Thread-4 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (WITH 
l AS (
    SELECT
    *
    FROM
    airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
      );
[0m04:29:37.812861 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:29:37.915119 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.31 seconds
[0m04:29:37.915119 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:37.915119 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m04:29:38.571118 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.65 seconds
[0m04:29:38.571118 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:38.571118 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
COMMIT
[0m04:29:38.943320 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.37 seconds
[0m04:29:38.945319 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:29:38.945319 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m04:29:39.253616 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.31 seconds
[0m04:29:39.254608 [debug] [Thread-3 (]: finished collecting timing info
[0m04:29:39.255609 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: Close
[0m04:29:39.911831 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAC96CE0>]}
[0m04:29:39.911831 [info ] [Thread-3 (]: 3 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 6.86s]
[0m04:29:39.912832 [debug] [Thread-3 (]: Finished running node model.dbtdemo.fct_reviews
[0m04:29:39.913832 [debug] [Thread-2 (]: Began running node model.dbtdemo.mart_fullmoon_reviews
[0m04:29:39.913832 [info ] [Thread-2 (]: 6 of 6 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m04:29:39.913832 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:29:39.914833 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.mart_fullmoon_reviews
[0m04:29:39.914833 [debug] [Thread-2 (]: Compiling model.dbtdemo.mart_fullmoon_reviews
[0m04:29:39.917830 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:29:39.919832 [debug] [Thread-2 (]: finished collecting timing info
[0m04:29:39.919832 [debug] [Thread-2 (]: Began executing node model.dbtdemo.mart_fullmoon_reviews
[0m04:29:39.923833 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:29:39.926843 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:29:39.926843 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
[0m04:29:39.926843 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:29:40.350534 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.54 seconds
[0m04:29:40.359551 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:29:40.360502 [debug] [Thread-4 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m04:29:40.693167 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:29:40.695164 [debug] [Thread-4 (]: finished collecting timing info
[0m04:29:40.695164 [debug] [Thread-4 (]: On model.dbtdemo.dim_listings_w_hosts: Close
[0m04:29:41.355943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAAE9FF0>]}
[0m04:29:41.355943 [info ] [Thread-4 (]: 5 of 6 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.56s]
[0m04:29:41.357908 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_listings_w_hosts
[0m04:29:44.961187 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.03 seconds
[0m04:29:44.964192 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:29:44.965193 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_reviews TO ROLE REPORTER
[0m04:29:45.299062 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:29:45.301062 [debug] [Thread-2 (]: finished collecting timing info
[0m04:29:45.301062 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: Close
[0m04:29:45.898555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8abdcfb-6348-426f-932b-5481532eb157', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAD4D0C0>]}
[0m04:29:45.899552 [info ] [Thread-2 (]: 6 of 6 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 5.98s]
[0m04:29:45.901652 [debug] [Thread-2 (]: Finished running node model.dbtdemo.mart_fullmoon_reviews
[0m04:29:45.903663 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:29:45.903663 [info ] [MainThread]: 
[0m04:29:45.904699 [info ] [MainThread]: Finished running 5 table models, 1 incremental model in 0 hours 0 minutes and 18.17 seconds (18.17s).
[0m04:29:45.905666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:29:45.906694 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:29:45.906694 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m04:29:45.906694 [debug] [MainThread]: Connection 'model.dbtdemo.dim_hosts_cleansed' was properly closed.
[0m04:29:45.907663 [debug] [MainThread]: Connection 'model.dbtdemo.mart_fullmoon_reviews' was properly closed.
[0m04:29:45.907663 [debug] [MainThread]: Connection 'model.dbtdemo.fct_reviews' was properly closed.
[0m04:29:45.907663 [debug] [MainThread]: Connection 'model.dbtdemo.dim_listings_w_hosts' was properly closed.
[0m04:29:45.950188 [info ] [MainThread]: 
[0m04:29:45.951187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:29:45.952188 [info ] [MainThread]: 
[0m04:29:45.952188 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m04:29:45.953187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FA7DCC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAA9B070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135FAA9AF80>]}


============================== 2022-08-22 04:30:51.405151 | 625f1137-ac88-463e-917e-f93bc23fa3b5 ==============================
[0m04:30:51.405151 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:30:51.406145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:30:51.406145 [debug] [MainThread]: Tracking: tracking
[0m04:30:51.406145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF25A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF259030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF2584C0>]}
[0m04:30:51.539176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:30:51.539176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:30:51.546177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF535DB0>]}
[0m04:30:51.583147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF3F31F0>]}
[0m04:30:51.584146 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 633 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:30:51.584146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF3F3250>]}
[0m04:30:51.586146 [info ] [MainThread]: 
[0m04:30:51.587147 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:30:51.588147 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m04:30:51.601148 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:30:51.601148 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:30:51.601148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:53.642546 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.04 seconds
[0m04:30:53.646781 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:30:54.221094 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m04:30:54.241132 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:30:54.242132 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:30:54.242132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:55.920874 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.68 seconds
[0m04:30:55.927874 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:30:56.493575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF5652D0>]}
[0m04:30:56.494574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:30:56.494574 [info ] [MainThread]: 
[0m04:30:56.498575 [debug] [Thread-1 (]: Began running node model.dbtdemo.src_hosts
[0m04:30:56.498575 [debug] [Thread-2 (]: Began running node model.dbtdemo.src_listings
[0m04:30:56.498575 [debug] [Thread-3 (]: Began running node model.dbtdemo.src_reviews
[0m04:30:56.499573 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.src_hosts"
[0m04:30:56.499573 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.src_listings"
[0m04:30:56.500574 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.src_reviews"
[0m04:30:56.500574 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.src_hosts
[0m04:30:56.500574 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.src_listings
[0m04:30:56.501574 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.src_reviews
[0m04:30:56.501574 [debug] [Thread-1 (]: Compiling model.dbtdemo.src_hosts
[0m04:30:56.501574 [debug] [Thread-2 (]: Compiling model.dbtdemo.src_listings
[0m04:30:56.501574 [debug] [Thread-3 (]: Compiling model.dbtdemo.src_reviews
[0m04:30:56.505576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.src_hosts"
[0m04:30:56.507572 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.src_listings"
[0m04:30:56.509573 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.src_reviews"
[0m04:30:56.511573 [debug] [Thread-1 (]: finished collecting timing info
[0m04:30:56.511573 [debug] [Thread-2 (]: finished collecting timing info
[0m04:30:56.512573 [debug] [Thread-3 (]: finished collecting timing info
[0m04:30:56.512573 [debug] [Thread-1 (]: Finished running node model.dbtdemo.src_hosts
[0m04:30:56.512573 [debug] [Thread-2 (]: Finished running node model.dbtdemo.src_listings
[0m04:30:56.513574 [debug] [Thread-3 (]: Finished running node model.dbtdemo.src_reviews
[0m04:30:56.513574 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_hosts_cleamsed
[0m04:30:56.514574 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_hosts_cleansed
[0m04:30:56.514574 [debug] [Thread-2 (]: Began running node model.dbtdemo.dim_listings_cleansed
[0m04:30:56.514574 [debug] [Thread-3 (]: Began running node model.dbtdemo.fct_reviews
[0m04:30:56.515573 [info ] [Thread-4 (]: 1 of 6 START table model dev.dim_hosts_cleamsed ................................ [RUN]
[0m04:30:56.515573 [info ] [Thread-1 (]: 2 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m04:30:56.515573 [info ] [Thread-2 (]: 3 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m04:30:56.515573 [info ] [Thread-3 (]: 4 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m04:30:56.516573 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:30:56.517576 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:30:56.517576 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:30:56.518574 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_hosts_cleamsed
[0m04:30:56.518574 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.fct_reviews"
[0m04:30:56.518574 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_hosts_cleansed
[0m04:30:56.518574 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.dim_listings_cleansed
[0m04:30:56.518574 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_hosts_cleamsed
[0m04:30:56.519574 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.fct_reviews
[0m04:30:56.519574 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_hosts_cleansed
[0m04:30:56.519574 [debug] [Thread-2 (]: Compiling model.dbtdemo.dim_listings_cleansed
[0m04:30:56.529572 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:30:56.530573 [debug] [Thread-3 (]: Compiling model.dbtdemo.fct_reviews
[0m04:30:56.536575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:30:56.542572 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:30:56.570572 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.fct_reviews"
[0m04:30:56.573573 [debug] [Thread-4 (]: finished collecting timing info
[0m04:30:56.573573 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_hosts_cleamsed
[0m04:30:56.573573 [debug] [Thread-1 (]: finished collecting timing info
[0m04:30:56.573573 [debug] [Thread-2 (]: finished collecting timing info
[0m04:30:56.579604 [debug] [Thread-3 (]: finished collecting timing info
[0m04:30:56.597573 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:30:56.598574 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_hosts_cleansed
[0m04:30:56.598574 [debug] [Thread-2 (]: Began executing node model.dbtdemo.dim_listings_cleansed
[0m04:30:56.598574 [debug] [Thread-3 (]: Began executing node model.dbtdemo.fct_reviews
[0m04:30:56.601576 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:30:56.604605 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:30:56.605574 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:30:56.628604 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:30:56.629576 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
create or replace transient table airbnb.dev.dim_hosts_cleamsed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:30:56.629576 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
),src_reviews AS (
SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m04:30:56.629576 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:30:56.630575 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:30:56.631573 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:30:56.633404 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:30:56.635405 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:30:56.635405 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
),src_listings AS (
    SELECT
    *
    FROM
    __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
      );
[0m04:30:56.636405 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:30:56.636405 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:30:59.017570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.38 seconds
[0m04:30:59.020577 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:30:59.020577 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m04:30:59.229470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.6 seconds
[0m04:30:59.236476 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:30:59.237473 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleamsed TO ROLE REPORTER
[0m04:30:59.332822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.31 seconds
[0m04:30:59.387797 [debug] [Thread-1 (]: finished collecting timing info
[0m04:30:59.388763 [debug] [Thread-1 (]: On model.dbtdemo.dim_hosts_cleansed: Close
[0m04:30:59.563764 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:30:59.565764 [debug] [Thread-4 (]: finished collecting timing info
[0m04:30:59.566764 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleamsed: Close
[0m04:30:59.958580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF796020>]}
[0m04:30:59.959532 [info ] [Thread-1 (]: 2 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 3.44s]
[0m04:30:59.962536 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_hosts_cleansed
[0m04:30:59.976495 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.34 seconds
[0m04:30:59.982495 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:30:59.983486 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m04:31:00.185878 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF796DD0>]}
[0m04:31:00.186849 [info ] [Thread-4 (]: 1 of 6 OK created table model dev.dim_hosts_cleamsed ........................... [[32mSUCCESS 1[0m in 3.67s]
[0m04:31:00.189428 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_hosts_cleamsed
[0m04:31:00.300452 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:31:00.302451 [debug] [Thread-2 (]: finished collecting timing info
[0m04:31:00.302451 [debug] [Thread-2 (]: On model.dbtdemo.dim_listings_cleansed: Close
[0m04:31:00.575125 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.94 seconds
[0m04:31:00.596233 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:00.598196 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:31:00.878611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF794CD0>]}
[0m04:31:00.878611 [info ] [Thread-2 (]: 3 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 4.36s]
[0m04:31:00.879611 [debug] [Thread-2 (]: Finished running node model.dbtdemo.dim_listings_cleansed
[0m04:31:00.880612 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_listings_w_hosts
[0m04:31:00.880612 [info ] [Thread-1 (]: 5 of 6 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m04:31:00.880612 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:31:00.881611 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_listings_w_hosts
[0m04:31:00.881611 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_listings_w_hosts
[0m04:31:00.884611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:31:00.886611 [debug] [Thread-1 (]: finished collecting timing info
[0m04:31:00.886611 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_listings_w_hosts
[0m04:31:00.889611 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:31:00.891611 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:31:00.891611 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (WITH 
l AS (
    SELECT
    *
    FROM
    airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
      );
[0m04:31:00.892611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:00.910612 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.31 seconds
[0m04:31:00.913611 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:00.913611 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m04:31:01.207559 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.29 seconds
[0m04:31:01.233551 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:01.234551 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:31:01.532334 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.3 seconds
[0m04:31:01.547337 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:01.548335 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m04:31:01.860314 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.31 seconds
[0m04:31:01.884309 [debug] [Thread-3 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:31:01.908307 [debug] [Thread-3 (]: Writing runtime SQL for node "model.dbtdemo.fct_reviews"
[0m04:31:02.024306 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:02.025311 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
BEGIN
[0m04:31:02.375647 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.34 seconds
[0m04:31:02.375647 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:02.375647 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m04:31:02.770231 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.39 seconds
[0m04:31:02.771232 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:02.772184 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
COMMIT
[0m04:31:03.122187 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.35 seconds
[0m04:31:03.124187 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:31:03.124187 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m04:31:03.418440 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.29 seconds
[0m04:31:03.420439 [debug] [Thread-3 (]: finished collecting timing info
[0m04:31:03.420439 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: Close
[0m04:31:03.560216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.67 seconds
[0m04:31:03.568216 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:31:03.569216 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m04:31:03.894554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:31:03.896550 [debug] [Thread-1 (]: finished collecting timing info
[0m04:31:03.897551 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_w_hosts: Close
[0m04:31:03.965137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF813880>]}
[0m04:31:03.966105 [info ] [Thread-3 (]: 4 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 7.45s]
[0m04:31:03.967102 [debug] [Thread-3 (]: Finished running node model.dbtdemo.fct_reviews
[0m04:31:03.968105 [debug] [Thread-2 (]: Began running node model.dbtdemo.mart_fullmoon_reviews
[0m04:31:03.968105 [info ] [Thread-2 (]: 6 of 6 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m04:31:03.969103 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:31:03.969103 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.mart_fullmoon_reviews
[0m04:31:03.969103 [debug] [Thread-2 (]: Compiling model.dbtdemo.mart_fullmoon_reviews
[0m04:31:03.973100 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:31:03.975102 [debug] [Thread-2 (]: finished collecting timing info
[0m04:31:03.975102 [debug] [Thread-2 (]: Began executing node model.dbtdemo.mart_fullmoon_reviews
[0m04:31:03.979100 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:31:03.981537 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:31:03.981537 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
[0m04:31:03.981537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:31:04.461103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EFA06260>]}
[0m04:31:04.462102 [info ] [Thread-1 (]: 5 of 6 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.58s]
[0m04:31:04.463071 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_listings_w_hosts
[0m04:31:09.188225 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 5.21 seconds
[0m04:31:09.195218 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:31:09.196207 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_reviews TO ROLE REPORTER
[0m04:31:09.487899 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.29 seconds
[0m04:31:09.493904 [debug] [Thread-2 (]: finished collecting timing info
[0m04:31:09.493904 [debug] [Thread-2 (]: On model.dbtdemo.mart_fullmoon_reviews: Close
[0m04:31:10.035030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625f1137-ac88-463e-917e-f93bc23fa3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF9C9DE0>]}
[0m04:31:10.035030 [info ] [Thread-2 (]: 6 of 6 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 6.07s]
[0m04:31:10.036031 [debug] [Thread-2 (]: Finished running node model.dbtdemo.mart_fullmoon_reviews
[0m04:31:10.037030 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:31:10.038030 [info ] [MainThread]: 
[0m04:31:10.038030 [info ] [MainThread]: Finished running 5 table models, 1 incremental model in 0 hours 0 minutes and 18.45 seconds (18.45s).
[0m04:31:10.039030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:10.039030 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:31:10.039030 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m04:31:10.039030 [debug] [MainThread]: Connection 'model.dbtdemo.dim_listings_w_hosts' was properly closed.
[0m04:31:10.039030 [debug] [MainThread]: Connection 'model.dbtdemo.mart_fullmoon_reviews' was properly closed.
[0m04:31:10.040033 [debug] [MainThread]: Connection 'model.dbtdemo.fct_reviews' was properly closed.
[0m04:31:10.040033 [debug] [MainThread]: Connection 'model.dbtdemo.dim_hosts_cleamsed' was properly closed.
[0m04:31:10.079030 [info ] [MainThread]: 
[0m04:31:10.079030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:10.080031 [info ] [MainThread]: 
[0m04:31:10.081031 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m04:31:10.081031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF565D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF7A59C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1EF9B7FD0>]}


============================== 2022-08-22 04:36:36.848193 | 5a0de104-4491-4e4c-94b7-f903db16cdab ==============================
[0m04:36:36.848193 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:36:36.848193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:36:36.849163 [debug] [MainThread]: Tracking: tracking
[0m04:36:36.849163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF096860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF096380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF094430>]}
[0m04:36:36.885195 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:36:36.886194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027997F0E890>]}
[0m04:36:36.982198 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m04:36:36.983195 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m04:36:36.984195 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:36:37.019195 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:36:37.021197 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m04:36:37.029196 [debug] [MainThread]: Parsing macros\materializations\merge.sql
[0m04:36:37.032196 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m04:36:37.036196 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m04:36:37.037181 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m04:36:37.040196 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m04:36:37.042196 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:36:37.042196 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:36:37.043196 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:36:37.043196 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:36:37.044197 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:36:37.055197 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:36:37.064196 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:36:37.066196 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:36:37.068199 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:36:37.075200 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:36:37.079201 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:36:37.091168 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:36:37.093197 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:36:37.100197 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:36:37.104198 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:36:37.105201 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:36:37.106168 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:36:37.107198 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:36:37.107198 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:36:37.109200 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:36:37.110192 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:36:37.113169 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:36:37.115169 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:36:37.118198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:36:37.122198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:36:37.130198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:36:37.131198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:36:37.144198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:36:37.157198 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:36:37.160203 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:36:37.164198 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:36:37.167198 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:36:37.169202 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:36:37.171198 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:36:37.175199 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:36:37.190199 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:36:37.196202 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:36:37.206202 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:36:37.216199 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:36:37.217203 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:36:37.231199 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:36:37.233204 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:36:37.237186 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:36:37.238199 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:36:37.239218 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:36:37.240200 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:36:37.241200 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:36:37.242199 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:36:37.248205 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:36:37.250200 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:36:37.251200 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:36:37.252200 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:36:37.253170 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:36:37.254201 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:36:37.255201 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:36:37.255201 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:36:37.257200 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:36:37.258200 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:36:37.260199 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:36:37.261200 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:36:37.262201 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:36:37.263171 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:36:37.264200 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:36:37.265202 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:36:37.267197 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:36:37.270169 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m04:36:37.274201 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m04:36:37.274201 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m04:36:37.282202 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m04:36:37.285202 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m04:36:37.287187 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m04:36:37.290202 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m04:36:37.291201 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m04:36:37.293173 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m04:36:37.305173 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m04:36:37.307173 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m04:36:37.312173 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m04:36:37.317173 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m04:36:37.319173 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m04:36:37.324173 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m04:36:37.329173 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m04:36:37.330173 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m04:36:37.352174 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m04:36:37.368174 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m04:36:37.378174 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m04:36:37.383174 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m04:36:37.387172 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m04:36:37.391174 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m04:36:37.397175 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m04:36:37.400174 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m04:36:37.404175 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m04:36:37.409175 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m04:36:37.412175 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m04:36:37.420175 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m04:36:37.422176 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m04:36:37.431175 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m04:36:37.433176 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m04:36:37.435176 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m04:36:37.437174 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m04:36:37.485204 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m04:36:37.486205 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m04:36:37.491204 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m04:36:37.525174 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m04:36:37.538174 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m04:36:37.548175 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m04:36:37.558175 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m04:36:37.572175 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m04:36:37.590176 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m04:36:37.597176 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m04:36:37.598176 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m04:36:37.599176 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m04:36:37.634207 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m04:36:37.648177 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m04:36:37.660179 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m04:36:37.672209 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m04:36:37.684178 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m04:36:37.705210 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m04:36:37.715212 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m04:36:37.720210 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m04:36:37.728210 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m04:36:37.761212 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m04:36:37.773210 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m04:36:37.784211 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m04:36:37.795208 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m04:36:37.810181 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m04:36:37.811180 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m04:36:37.818180 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m04:36:37.819181 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m04:36:37.820181 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m04:36:37.821181 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m04:36:37.823181 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m04:36:37.825211 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m04:36:37.828212 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m04:36:37.829214 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m04:36:37.831212 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m04:36:37.833212 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m04:36:37.833212 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m04:36:37.836214 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m04:36:37.842212 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m04:36:37.844212 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m04:36:37.852214 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m04:36:37.853183 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m04:36:37.855216 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m04:36:37.856212 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m04:36:37.857183 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m04:36:37.859209 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m04:36:37.860212 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m04:36:37.863212 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m04:36:37.864213 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m04:36:37.871214 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m04:36:37.872213 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m04:36:37.873216 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m04:36:37.874218 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m04:36:37.877214 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m04:36:37.878212 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m04:36:37.883212 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m04:36:37.888213 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m04:36:37.889213 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m04:36:37.890213 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m04:36:37.893183 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m04:36:37.894184 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m04:36:37.895213 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m04:36:37.898184 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m04:36:37.900216 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m04:36:37.902206 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m04:36:37.903214 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m04:36:37.910214 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m04:36:37.912214 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m04:36:37.913213 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m04:36:37.915213 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m04:36:37.917214 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m04:36:37.919183 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m04:36:37.921217 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m04:36:37.923214 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m04:36:37.924186 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m04:36:37.927214 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m04:36:37.928214 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m04:36:37.929214 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m04:36:37.930215 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m04:36:37.931214 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m04:36:37.952215 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m04:36:37.955218 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m04:36:37.961215 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m04:36:37.965184 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m04:36:37.970215 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m04:36:37.972214 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m04:36:37.975215 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m04:36:37.977214 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m04:36:37.980186 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m04:36:37.986215 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m04:36:37.987207 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m04:36:37.989215 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m04:36:37.990215 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m04:36:37.995215 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m04:36:37.996215 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m04:36:37.998215 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m04:36:38.001218 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m04:36:38.003215 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m04:36:38.006216 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m04:36:38.009215 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m04:36:38.019215 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m04:36:38.025205 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m04:36:38.027216 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m04:36:38.029215 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m04:36:38.715964 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:36:38.728889 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:36:38.734015 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:36:38.739454 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m04:36:38.743843 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m04:36:38.764194 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m04:36:38.766778 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m04:36:38.771956 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m04:36:38.775955 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m04:36:38.780954 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m04:36:38.958543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF1BF7F0>]}
[0m04:36:38.995512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF09B2B0>]}
[0m04:36:38.995512 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 633 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:36:38.996533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF099930>]}
[0m04:36:38.997542 [info ] [MainThread]: 
[0m04:36:38.998512 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:36:38.999511 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb"
[0m04:36:39.010541 [debug] [ThreadPool]: Using snowflake connection "list_airbnb"
[0m04:36:39.011511 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb"} */
show terse schemas in database airbnb
    limit 10000
[0m04:36:39.011511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:40.914714 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.9 seconds
[0m04:36:40.916715 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:36:41.467577 [debug] [ThreadPool]: Acquiring new snowflake connection "list_airbnb_dev"
[0m04:36:41.474577 [debug] [ThreadPool]: Using snowflake connection "list_airbnb_dev"
[0m04:36:41.474577 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
show terse objects in airbnb.dev
[0m04:36:41.474577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:43.068303 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.59 seconds
[0m04:36:43.069304 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:36:43.631567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF1B9750>]}
[0m04:36:43.633565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:36:43.635560 [info ] [MainThread]: 
[0m04:36:43.655503 [debug] [Thread-1 (]: Began running node model.dbtdemo.src_hosts
[0m04:36:43.656150 [debug] [Thread-2 (]: Began running node model.dbtdemo.src_listings
[0m04:36:43.657209 [debug] [Thread-3 (]: Began running node model.dbtdemo.src_reviews
[0m04:36:43.659393 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.src_hosts"
[0m04:36:43.661287 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.src_listings"
[0m04:36:43.663320 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.src_reviews"
[0m04:36:43.664809 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.src_hosts
[0m04:36:43.666165 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.src_listings
[0m04:36:43.667455 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.src_reviews
[0m04:36:43.668663 [debug] [Thread-1 (]: Compiling model.dbtdemo.src_hosts
[0m04:36:43.669546 [debug] [Thread-2 (]: Compiling model.dbtdemo.src_listings
[0m04:36:43.670801 [debug] [Thread-3 (]: Compiling model.dbtdemo.src_reviews
[0m04:36:43.681609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.src_hosts"
[0m04:36:43.689584 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.src_listings"
[0m04:36:43.698617 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.src_reviews"
[0m04:36:43.702571 [debug] [Thread-1 (]: finished collecting timing info
[0m04:36:43.702571 [debug] [Thread-2 (]: finished collecting timing info
[0m04:36:43.702571 [debug] [Thread-3 (]: finished collecting timing info
[0m04:36:43.703574 [debug] [Thread-1 (]: Finished running node model.dbtdemo.src_hosts
[0m04:36:43.704575 [debug] [Thread-2 (]: Finished running node model.dbtdemo.src_listings
[0m04:36:43.704575 [debug] [Thread-3 (]: Finished running node model.dbtdemo.src_reviews
[0m04:36:43.705677 [debug] [Thread-2 (]: Began running node model.dbtdemo.dim_hosts_cleamsed
[0m04:36:43.706686 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_hosts_cleansed
[0m04:36:43.706686 [debug] [Thread-1 (]: Began running node model.dbtdemo.dim_listings_cleansed
[0m04:36:43.707691 [debug] [Thread-3 (]: Began running node model.dbtdemo.fct_reviews
[0m04:36:43.707691 [info ] [Thread-2 (]: 1 of 6 START table model dev.dim_hosts_cleamsed ................................ [RUN]
[0m04:36:43.708691 [info ] [Thread-4 (]: 2 of 6 START table model dev.dim_hosts_cleansed ................................ [RUN]
[0m04:36:43.708691 [info ] [Thread-1 (]: 3 of 6 START table model dev.dim_listings_cleansed ............................. [RUN]
[0m04:36:43.709711 [info ] [Thread-3 (]: 4 of 6 START incremental model dev.fct_reviews ................................. [RUN]
[0m04:36:43.710687 [debug] [Thread-2 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:36:43.711690 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:36:43.712686 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:36:43.712686 [debug] [Thread-2 (]: Began compiling node model.dbtdemo.dim_hosts_cleamsed
[0m04:36:43.712686 [debug] [Thread-3 (]: Acquiring new snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:43.713687 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_hosts_cleansed
[0m04:36:43.713687 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.dim_listings_cleansed
[0m04:36:43.714688 [debug] [Thread-2 (]: Compiling model.dbtdemo.dim_hosts_cleamsed
[0m04:36:43.714688 [debug] [Thread-3 (]: Began compiling node model.dbtdemo.fct_reviews
[0m04:36:43.714688 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_hosts_cleansed
[0m04:36:43.715691 [debug] [Thread-1 (]: Compiling model.dbtdemo.dim_listings_cleansed
[0m04:36:43.730665 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:36:43.730665 [debug] [Thread-3 (]: Compiling model.dbtdemo.fct_reviews
[0m04:36:43.736667 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:36:43.744667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:36:43.758024 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbtdemo.fct_reviews"
[0m04:36:43.760024 [debug] [Thread-2 (]: finished collecting timing info
[0m04:36:43.761026 [debug] [Thread-2 (]: Began executing node model.dbtdemo.dim_hosts_cleamsed
[0m04:36:43.761026 [debug] [Thread-4 (]: finished collecting timing info
[0m04:36:43.778570 [debug] [Thread-1 (]: finished collecting timing info
[0m04:36:43.786265 [debug] [Thread-2 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleamsed"
[0m04:36:43.786265 [debug] [Thread-3 (]: finished collecting timing info
[0m04:36:43.786824 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_hosts_cleansed
[0m04:36:43.787332 [debug] [Thread-1 (]: Began executing node model.dbtdemo.dim_listings_cleansed
[0m04:36:43.787332 [debug] [Thread-3 (]: Began executing node model.dbtdemo.fct_reviews
[0m04:36:43.790340 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_hosts_cleansed"
[0m04:36:43.791340 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:36:43.794340 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_cleansed"
[0m04:36:43.818662 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:43.818662 [debug] [Thread-2 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
create or replace transient table airbnb.dev.dim_hosts_cleamsed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:36:43.819662 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
create or replace temporary table airbnb.dev.fct_reviews__dbt_tmp  as
      (
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
),src_reviews AS (
SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from airbnb.dev.fct_reviews)

      );
[0m04:36:43.819662 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:36:43.819662 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:36:43.821662 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:36:43.822662 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:36:43.825203 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
create or replace transient table airbnb.dev.dim_hosts_cleansed  as
      (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
 SELECT
 *
 FROM
 airbnb.raw.raw_hosts
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
),src_hosts AS (
    SELECT
    *
    FROM
    __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
      );
[0m04:36:43.825203 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
create or replace transient table airbnb.dev.dim_listings_cleansed  as
      (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT
    *
    FROM
    airbnb.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
),src_listings AS (
    SELECT
    *
    FROM
    __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
      );
[0m04:36:43.826209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:36:43.826209 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:36:46.375104 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.55 seconds
[0m04:36:46.379107 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleansed"
[0m04:36:46.379107 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleansed TO ROLE REPORTER
[0m04:36:46.459159 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.64 seconds
[0m04:36:46.464159 [debug] [Thread-2 (]: Using snowflake connection "model.dbtdemo.dim_hosts_cleamsed"
[0m04:36:46.464159 [debug] [Thread-2 (]: On model.dbtdemo.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_hosts_cleamsed"} */
GRANT SELECT ON airbnb.dev.dim_hosts_cleamsed TO ROLE REPORTER
[0m04:36:46.474109 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.65 seconds
[0m04:36:46.497107 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:46.498115 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:36:46.604047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.78 seconds
[0m04:36:46.607046 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.dim_listings_cleansed"
[0m04:36:46.608047 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_cleansed"} */
GRANT SELECT ON airbnb.dev.dim_listings_cleansed TO ROLE REPORTER
[0m04:36:46.699921 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:36:46.732917 [debug] [Thread-4 (]: finished collecting timing info
[0m04:36:46.733919 [debug] [Thread-4 (]: On model.dbtdemo.dim_hosts_cleansed: Close
[0m04:36:46.792993 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:36:46.794992 [debug] [Thread-2 (]: finished collecting timing info
[0m04:36:46.794992 [debug] [Thread-2 (]: On model.dbtdemo.dim_hosts_cleamsed: Close
[0m04:36:46.809826 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.31 seconds
[0m04:36:46.813826 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:46.813826 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews
[0m04:36:46.928455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:36:46.929455 [debug] [Thread-1 (]: finished collecting timing info
[0m04:36:46.930424 [debug] [Thread-1 (]: On model.dbtdemo.dim_listings_cleansed: Close
[0m04:36:47.112010 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.3 seconds
[0m04:36:47.125009 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:47.125009 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table airbnb.dev.fct_reviews__dbt_tmp
[0m04:36:47.304953 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF6338E0>]}
[0m04:36:47.306962 [info ] [Thread-4 (]: 2 of 6 OK created table model dev.dim_hosts_cleansed ........................... [[32mSUCCESS 1[0m in 3.59s]
[0m04:36:47.310952 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_hosts_cleansed
[0m04:36:47.364484 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF63F400>]}
[0m04:36:47.365485 [info ] [Thread-2 (]: 1 of 6 OK created table model dev.dim_hosts_cleamsed ........................... [[32mSUCCESS 1[0m in 3.65s]
[0m04:36:47.367483 [debug] [Thread-2 (]: Finished running node model.dbtdemo.dim_hosts_cleamsed
[0m04:36:47.445552 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.32 seconds
[0m04:36:47.457559 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:47.458557 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m04:36:47.503951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF9538B0>]}
[0m04:36:47.504953 [info ] [Thread-1 (]: 3 of 6 OK created table model dev.dim_listings_cleansed ........................ [[32mSUCCESS 1[0m in 3.79s]
[0m04:36:47.505918 [debug] [Thread-1 (]: Finished running node model.dbtdemo.dim_listings_cleansed
[0m04:36:47.506920 [debug] [Thread-4 (]: Began running node model.dbtdemo.dim_listings_w_hosts
[0m04:36:47.506920 [info ] [Thread-4 (]: 5 of 6 START table model dev.dim_listings_w_hosts .............................. [RUN]
[0m04:36:47.507920 [debug] [Thread-4 (]: Acquiring new snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:36:47.508917 [debug] [Thread-4 (]: Began compiling node model.dbtdemo.dim_listings_w_hosts
[0m04:36:47.508917 [debug] [Thread-4 (]: Compiling model.dbtdemo.dim_listings_w_hosts
[0m04:36:47.512920 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:36:47.515917 [debug] [Thread-4 (]: finished collecting timing info
[0m04:36:47.515917 [debug] [Thread-4 (]: Began executing node model.dbtdemo.dim_listings_w_hosts
[0m04:36:47.519919 [debug] [Thread-4 (]: Writing runtime SQL for node "model.dbtdemo.dim_listings_w_hosts"
[0m04:36:47.523919 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:36:47.523919 [debug] [Thread-4 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
create or replace transient table airbnb.dev.dim_listings_w_hosts  as
      (WITH 
l AS (
    SELECT
    *
    FROM
    airbnb.dev.dim_listings_cleansed
),
h AS (
    SELECT *
    FROM airbnb.dev.dim_hosts_cleansed
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
      );
[0m04:36:47.523919 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:36:47.757763 [debug] [Thread-3 (]: SQL status: SUCCESS 6 in 0.3 seconds
[0m04:36:47.766759 [debug] [Thread-3 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:36:47.777759 [debug] [Thread-3 (]: Writing runtime SQL for node "model.dbtdemo.fct_reviews"
[0m04:36:47.779791 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:47.779791 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
BEGIN
[0m04:36:48.103930 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.32 seconds
[0m04:36:48.104880 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:48.104880 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
insert into airbnb.dev.fct_reviews ("REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "REVIEW_ID", "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from airbnb.dev.fct_reviews__dbt_tmp
        );
[0m04:36:48.517456 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.41 seconds
[0m04:36:48.518466 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:48.519425 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
COMMIT
[0m04:36:49.159418 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.64 seconds
[0m04:36:49.165466 [debug] [Thread-3 (]: Using snowflake connection "model.dbtdemo.fct_reviews"
[0m04:36:49.166467 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.fct_reviews"} */
GRANT SELECT ON airbnb.dev.fct_reviews TO ROLE REPORTER
[0m04:36:49.466320 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.3 seconds
[0m04:36:49.473319 [debug] [Thread-3 (]: finished collecting timing info
[0m04:36:49.474319 [debug] [Thread-3 (]: On model.dbtdemo.fct_reviews: Close
[0m04:36:49.910656 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.39 seconds
[0m04:36:49.912657 [debug] [Thread-4 (]: Using snowflake connection "model.dbtdemo.dim_listings_w_hosts"
[0m04:36:49.912657 [debug] [Thread-4 (]: On model.dbtdemo.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.dim_listings_w_hosts"} */
GRANT SELECT ON airbnb.dev.dim_listings_w_hosts TO ROLE REPORTER
[0m04:36:50.070593 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF7B4430>]}
[0m04:36:50.070593 [info ] [Thread-3 (]: 4 of 6 OK created incremental model dev.fct_reviews ............................ [[32mSUCCESS 0[0m in 6.36s]
[0m04:36:50.071593 [debug] [Thread-3 (]: Finished running node model.dbtdemo.fct_reviews
[0m04:36:50.071593 [debug] [Thread-1 (]: Began running node model.dbtdemo.mart_fullmoon_reviews
[0m04:36:50.072593 [info ] [Thread-1 (]: 6 of 6 START table model dev.mart_fullmoon_reviews ............................. [RUN]
[0m04:36:50.072593 [debug] [Thread-1 (]: Acquiring new snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:36:50.073594 [debug] [Thread-1 (]: Began compiling node model.dbtdemo.mart_fullmoon_reviews
[0m04:36:50.073594 [debug] [Thread-1 (]: Compiling model.dbtdemo.mart_fullmoon_reviews
[0m04:36:50.077596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:36:50.079597 [debug] [Thread-1 (]: finished collecting timing info
[0m04:36:50.079597 [debug] [Thread-1 (]: Began executing node model.dbtdemo.mart_fullmoon_reviews
[0m04:36:50.084593 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtdemo.mart_fullmoon_reviews"
[0m04:36:50.086593 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:36:50.087597 [debug] [Thread-1 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
create or replace transient table airbnb.dev.mart_fullmoon_reviews  as
      (

WITH fct_reviews AS (
    SELECT * FROM airbnb.dev.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM airbnb.dev.seed_full_moon_dates
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
      );
[0m04:36:50.087597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:50.228289 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.31 seconds
[0m04:36:50.292268 [debug] [Thread-4 (]: finished collecting timing info
[0m04:36:50.292268 [debug] [Thread-4 (]: On model.dbtdemo.dim_listings_w_hosts: Close
[0m04:36:50.845655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF8F1240>]}
[0m04:36:50.846657 [info ] [Thread-4 (]: 5 of 6 OK created table model dev.dim_listings_w_hosts ......................... [[32mSUCCESS 1[0m in 3.34s]
[0m04:36:50.847622 [debug] [Thread-4 (]: Finished running node model.dbtdemo.dim_listings_w_hosts
[0m04:36:55.595064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.51 seconds
[0m04:36:55.598064 [debug] [Thread-1 (]: Using snowflake connection "model.dbtdemo.mart_fullmoon_reviews"
[0m04:36:55.598064 [debug] [Thread-1 (]: On model.dbtdemo.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbtdemo", "target_name": "dev", "node_id": "model.dbtdemo.mart_fullmoon_reviews"} */
GRANT SELECT ON airbnb.dev.mart_fullmoon_reviews TO ROLE REPORTER
[0m04:36:55.928326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.33 seconds
[0m04:36:55.935324 [debug] [Thread-1 (]: finished collecting timing info
[0m04:36:55.936325 [debug] [Thread-1 (]: On model.dbtdemo.mart_fullmoon_reviews: Close
[0m04:36:56.839966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a0de104-4491-4e4c-94b7-f903db16cdab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF7B2C50>]}
[0m04:36:56.841946 [info ] [Thread-1 (]: 6 of 6 OK created table model dev.mart_fullmoon_reviews ........................ [[32mSUCCESS 1[0m in 6.77s]
[0m04:36:56.844954 [debug] [Thread-1 (]: Finished running node model.dbtdemo.mart_fullmoon_reviews
[0m04:36:56.847911 [debug] [MainThread]: Acquiring new snowflake connection "master"
[0m04:36:56.848903 [info ] [MainThread]: 
[0m04:36:56.850904 [info ] [MainThread]: Finished running 5 table models, 1 incremental model in 0 hours 0 minutes and 17.85 seconds (17.85s).
[0m04:36:56.852902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:56.852902 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:36:56.853904 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m04:36:56.853904 [debug] [MainThread]: Connection 'model.dbtdemo.mart_fullmoon_reviews' was properly closed.
[0m04:36:56.854907 [debug] [MainThread]: Connection 'model.dbtdemo.dim_hosts_cleamsed' was properly closed.
[0m04:36:56.855906 [debug] [MainThread]: Connection 'model.dbtdemo.fct_reviews' was properly closed.
[0m04:36:56.855906 [debug] [MainThread]: Connection 'model.dbtdemo.dim_listings_w_hosts' was properly closed.
[0m04:36:56.916898 [info ] [MainThread]: 
[0m04:36:56.916898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:56.917897 [info ] [MainThread]: 
[0m04:36:56.918898 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m04:36:56.918898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF918EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF8F0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AF7B3220>]}


============================== 2022-08-22 04:40:14.545856 | 51e4ce9b-631d-48b6-be64-f87e687cd6d5 ==============================
[0m04:40:14.545856 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:40:14.546857 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:40:14.546857 [debug] [MainThread]: Tracking: tracking
[0m04:40:14.560605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001926368EE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001926368F790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001926368C760>]}
[0m04:40:14.564572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192636851E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019263687850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019263686C20>]}


============================== 2022-08-22 04:44:27.652260 | 3a2d0d8f-a2cf-4596-83b7-90803388db40 ==============================
[0m04:44:27.652260 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:44:27.653230 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:44:27.653230 [debug] [MainThread]: Tracking: tracking
[0m04:44:27.667229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4A7F520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4A7CA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4A7E080>]}
[0m04:44:27.723228 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:44:27.724230 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m04:44:27.724230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4A75FC0>]}
[0m04:44:27.836231 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m04:44:27.837232 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m04:44:27.837232 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:44:27.859231 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:44:27.861232 [debug] [MainThread]: Parsing macros\relations.sql
[0m04:44:27.862232 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m04:44:27.864232 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:44:27.864232 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:44:27.865232 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:44:27.870231 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:44:27.871232 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:44:27.873232 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:44:27.874232 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:44:27.885232 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:44:27.894232 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:44:27.896232 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:44:27.898231 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:44:27.904232 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:44:27.908231 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:44:27.920247 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:44:27.922232 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:44:27.929231 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:44:27.933232 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:44:27.934232 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:44:27.935233 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:44:27.935233 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:44:27.936232 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:44:27.938232 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:44:27.939232 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:44:27.941232 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:44:27.943232 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:44:27.946231 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:44:27.950231 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:44:27.958231 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:44:27.959232 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:44:27.972232 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:44:27.985232 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:44:27.987232 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:44:27.992231 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:44:27.995232 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:44:27.997232 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:44:27.998232 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:44:28.003232 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:44:28.017232 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:44:28.023231 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:44:28.034261 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:44:28.043260 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:44:28.044261 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:44:28.058260 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:44:28.060260 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:44:28.064263 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:44:28.065261 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:44:28.066262 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:44:28.067260 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:44:28.068260 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:44:28.069261 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:44:28.074261 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:44:28.075261 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:44:28.076261 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:44:28.077261 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:44:28.078231 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:44:28.080236 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:44:28.081233 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:44:28.082260 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:44:28.083260 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:44:28.084261 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:44:28.086260 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:44:28.087231 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:44:28.088265 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:44:28.089261 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:44:28.090260 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:44:28.091231 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:44:28.093260 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:44:28.096260 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m04:44:28.100260 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m04:44:28.101264 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m04:44:28.109260 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m04:44:28.112261 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m04:44:28.114263 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m04:44:28.117260 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m04:44:28.118260 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m04:44:28.120233 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m04:44:28.131231 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m04:44:28.134261 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m04:44:28.138261 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m04:44:28.143261 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m04:44:28.145260 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m04:44:28.150261 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m04:44:28.156231 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m04:44:28.157260 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m04:44:28.179264 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m04:44:28.193261 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m04:44:28.202261 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m04:44:28.208258 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m04:44:28.212261 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m04:44:28.217261 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m04:44:28.223261 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m04:44:28.226262 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m04:44:28.229262 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m04:44:28.235268 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m04:44:28.238261 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m04:44:28.245262 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m04:44:28.247261 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m04:44:28.256259 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m04:44:28.258263 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m04:44:28.259261 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m04:44:28.261261 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m04:44:28.281261 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m04:44:28.282262 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m04:44:28.287233 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m04:44:28.321262 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m04:44:28.333261 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m04:44:28.343263 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m04:44:28.353235 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m04:44:28.367261 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m04:44:28.385261 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m04:44:28.393264 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m04:44:28.394262 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m04:44:28.395262 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m04:44:28.429262 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m04:44:28.443262 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m04:44:28.454231 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m04:44:28.466262 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m04:44:28.478266 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m04:44:28.499262 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m04:44:28.508261 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m04:44:28.513262 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m04:44:28.520261 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m04:44:28.553263 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m04:44:28.566262 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m04:44:28.578231 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m04:44:28.589275 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m04:44:28.603263 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m04:44:28.604233 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m04:44:28.612263 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m04:44:28.613264 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m04:44:28.614263 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m04:44:28.615262 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m04:44:28.617262 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m04:44:28.618263 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m04:44:28.621263 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m04:44:28.622262 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m04:44:28.624263 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m04:44:28.626266 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m04:44:28.627262 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m04:44:28.630262 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m04:44:28.635262 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m04:44:28.637265 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m04:44:28.645926 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m04:44:28.646958 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m04:44:28.648965 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m04:44:28.649959 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m04:44:28.650958 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m04:44:28.652958 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m04:44:28.653960 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m04:44:28.656959 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m04:44:28.657960 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m04:44:28.665643 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m04:44:28.666744 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m04:44:28.667842 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m04:44:28.668982 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m04:44:28.671143 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m04:44:28.672248 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m04:44:28.678255 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m04:44:28.682544 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m04:44:28.684087 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m04:44:28.685645 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m04:44:28.687720 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m04:44:28.688762 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m04:44:28.690866 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m04:44:28.693568 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m04:44:28.695579 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m04:44:28.697578 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m04:44:28.698578 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m04:44:28.706578 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m04:44:28.708579 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m04:44:28.710709 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m04:44:28.713138 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m04:44:28.715140 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m04:44:28.717139 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m04:44:28.719136 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m04:44:28.721738 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m04:44:28.723299 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m04:44:28.725916 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m04:44:28.727482 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m04:44:28.728518 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m04:44:28.729558 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m04:44:28.730605 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m04:44:28.752571 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m04:44:28.756571 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m04:44:28.762572 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m04:44:28.767574 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m04:44:28.772571 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m04:44:28.775570 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m04:44:28.778569 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m04:44:28.781568 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m04:44:28.784382 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m04:44:28.790383 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m04:44:28.792381 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m04:44:28.793382 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m04:44:28.795382 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m04:44:28.800382 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m04:44:28.801382 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m04:44:28.803380 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m04:44:28.807380 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m04:44:28.808382 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m04:44:28.812380 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m04:44:28.815382 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m04:44:28.826382 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m04:44:28.837382 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m04:44:28.840383 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m04:44:28.843384 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m04:44:29.524415 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:44:29.533386 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:44:29.535387 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:44:29.537386 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m04:44:29.539387 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m04:44:29.558387 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m04:44:29.559387 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m04:44:29.561387 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m04:44:29.563387 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m04:44:29.565387 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m04:44:29.721385 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m04:44:29.727417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4C27730>]}
[0m04:44:29.762386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4A7E080>]}
[0m04:44:29.763385 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:44:29.764058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4D533D0>]}
[0m04:44:29.765098 [info ] [MainThread]: 
[0m04:44:29.766065 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:44:29.767096 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m04:44:29.775096 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m04:44:29.776094 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m04:44:29.776094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:29.830772 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.05 seconds
[0m04:44:29.831771 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:44:29.832772 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m04:44:29.838771 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:44:29.838771 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m04:44:29.838771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:29.853543 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:44:29.853543 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:44:29.853543 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:44:29.856542 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:44:29.857541 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m04:44:29.858542 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:44:29.858542 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m04:44:29.861112 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:44:29.861112 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m04:44:29.861112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:29.875120 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:44:29.875120 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:44:29.876120 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m04:44:29.879120 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:44:29.880121 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m04:44:29.881120 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m04:44:29.886119 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:29.887120 [debug] [MainThread]: On master: BEGIN
[0m04:44:29.887120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:44:29.899978 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:44:29.899978 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:29.899978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:44:29.908008 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:44:29.909978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4DE92D0>]}
[0m04:44:29.909978 [debug] [MainThread]: On master: ROLLBACK
[0m04:44:29.910547 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:29.910547 [debug] [MainThread]: On master: BEGIN
[0m04:44:29.912552 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:44:29.912552 [debug] [MainThread]: On master: COMMIT
[0m04:44:29.912552 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:29.912552 [debug] [MainThread]: On master: COMMIT
[0m04:44:29.913871 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:44:29.913871 [debug] [MainThread]: On master: Close
[0m04:44:29.913871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:29.914877 [info ] [MainThread]: 
[0m04:44:29.917875 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m04:44:29.917875 [info ] [Thread-1 (]: 1 of 9 START view model dbo.src_hosts .......................................... [RUN]
[0m04:44:29.918875 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m04:44:29.918875 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m04:44:29.918875 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m04:44:29.921877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m04:44:29.923877 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:29.923877 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m04:44:29.954734 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m04:44:29.956765 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:44:29.957733 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m04:44:29.957733 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:44:29.971733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:44:29.971733 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:44:29.972734 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m04:44:29.974734 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:44:29.980733 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:44:29.980733 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m04:44:29.982550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:44:29.996549 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:44:29.996549 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:44:29.996549 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:44:29.999770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:44:30.005217 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:44:30.006186 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m04:44:30.008186 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:44:30.009185 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.010183 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m04:44:30.010183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4DE9240>]}
[0m04:44:30.010183 [info ] [Thread-1 (]: 1 of 9 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.09s]
[0m04:44:30.011184 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m04:44:30.011184 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m04:44:30.012184 [info ] [Thread-1 (]: 2 of 9 START view model dbo.src_listings ....................................... [RUN]
[0m04:44:30.013185 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m04:44:30.013185 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m04:44:30.013185 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m04:44:30.016184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m04:44:30.018183 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.018183 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m04:44:30.021183 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m04:44:30.023184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:44:30.023184 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m04:44:30.024184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:30.038184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:44:30.039184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:44:30.039184 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m04:44:30.041183 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:44:30.043184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:44:30.044184 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m04:44:30.045184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:44:30.046184 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:44:30.046184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:44:30.046184 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:44:30.048183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:44:30.050184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:44:30.050184 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m04:44:30.051183 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:44:30.052185 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.052185 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m04:44:30.053183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4F03280>]}
[0m04:44:30.053183 [info ] [Thread-1 (]: 2 of 9 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m04:44:30.054184 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m04:44:30.054184 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m04:44:30.055185 [info ] [Thread-1 (]: 3 of 9 START view model dbo.src_reviews ........................................ [RUN]
[0m04:44:30.056185 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m04:44:30.056185 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m04:44:30.056185 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m04:44:30.060185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m04:44:30.061184 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.062185 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m04:44:30.065185 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m04:44:30.068183 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:44:30.068183 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m04:44:30.068183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:30.092184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:44:30.092184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:44:30.092184 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m04:44:30.094187 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:44:30.097188 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:44:30.098185 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m04:44:30.099183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:44:30.100184 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:44:30.100184 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:44:30.100184 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:44:30.102199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:44:30.104192 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:44:30.104192 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m04:44:30.105198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:44:30.106195 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.106195 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m04:44:30.107194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4F2FFA0>]}
[0m04:44:30.107194 [info ] [Thread-1 (]: 3 of 9 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m04:44:30.108194 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m04:44:30.108194 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:44:30.108194 [info ] [Thread-1 (]: 4 of 9 START view model dbo.dim_hosts_cleamsed ................................. [RUN]
[0m04:44:30.109194 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:44:30.109194 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleamsed
[0m04:44:30.109194 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleamsed
[0m04:44:30.112192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:44:30.114195 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.114195 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleamsed
[0m04:44:30.119193 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:44:30.121194 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:44:30.121194 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: BEGIN
[0m04:44:30.121194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:30.153194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:44:30.153194 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:44:30.153194 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleamsed"} */

  create view "airbnb"."dbo"."dim_hosts_cleamsed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:44:30.156224 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 12:     NVL(host_name,'Anonymous') AS host_name,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:44:30.156224 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: ROLLBACK
[0m04:44:30.157196 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.158197 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: Close
[0m04:44:30.158197 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)
  function nvl(text, unknown) does not exist
  LINE 12:     NVL(host_name,'Anonymous') AS host_name,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:44:30.158197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4FBB880>]}
[0m04:44:30.159194 [error] [Thread-1 (]: 4 of 9 ERROR creating view model dbo.dim_hosts_cleamsed ........................ [[31mERROR[0m in 0.05s]
[0m04:44:30.159194 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:44:30.160195 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m04:44:30.160195 [info ] [Thread-1 (]: 5 of 9 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m04:44:30.161195 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:44:30.161195 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m04:44:30.161195 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m04:44:30.164194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:44:30.165195 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.166196 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m04:44:30.169193 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:44:30.171195 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:44:30.171195 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m04:44:30.171195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:30.184196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:44:30.185196 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:44:30.185196 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:44:30.186196 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 12:     NVL(host_name,'Anonymous') AS host_name,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:44:30.186196 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: ROLLBACK
[0m04:44:30.187195 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.187195 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m04:44:30.188198 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(text, unknown) does not exist
  LINE 12:     NVL(host_name,'Anonymous') AS host_name,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:44:30.188198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4F3EAA0>]}
[0m04:44:30.188198 [error] [Thread-1 (]: 5 of 9 ERROR creating view model dbo.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.03s]
[0m04:44:30.189198 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m04:44:30.189198 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m04:44:30.190196 [info ] [Thread-1 (]: 6 of 9 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m04:44:30.190196 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:44:30.190196 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m04:44:30.191193 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m04:44:30.193193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:44:30.195194 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.195194 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m04:44:30.199193 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:44:30.201193 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:44:30.201193 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m04:44:30.201193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:30.215750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:44:30.215750 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:44:30.215750 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m04:44:30.216748 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function replace(text, unknown) does not exist
LINE 19:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:44:30.216748 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m04:44:30.217749 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.217749 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m04:44:30.218748 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function replace(text, unknown) does not exist
  LINE 19:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:44:30.218748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4FD82E0>]}
[0m04:44:30.218748 [error] [Thread-1 (]: 6 of 9 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.03s]
[0m04:44:30.219748 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m04:44:30.219748 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m04:44:30.220751 [info ] [Thread-1 (]: 7 of 9 START incremental model dbo.fct_reviews ................................. [RUN]
[0m04:44:30.220751 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m04:44:30.221748 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m04:44:30.221748 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m04:44:30.227748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m04:44:30.228752 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:30.229751 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m04:44:30.289752 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m04:44:30.292198 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:44:30.293192 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m04:44:30.293192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:30.323332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:44:30.324365 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:44:30.325364 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

  create  table "airbnb"."dbo"."fct_reviews"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


  );
  
[0m04:44:31.562371 [debug] [Thread-1 (]: SQL status: SELECT 365946 in 1.24 seconds
[0m04:44:31.566401 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:44:31.567400 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:44:31.567400 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:44:31.577962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:44:31.578951 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:31.578951 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m04:44:31.579951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4FD8760>]}
[0m04:44:31.579951 [info ] [Thread-1 (]: 7 of 9 OK created incremental model dbo.fct_reviews ............................ [[32mSELECT 365946[0m in 1.36s]
[0m04:44:31.580952 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m04:44:31.580952 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m04:44:31.581951 [info ] [Thread-1 (]: 8 of 9 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m04:44:31.581951 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m04:44:31.582951 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:44:31.582951 [info ] [Thread-1 (]: 9 of 9 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m04:44:31.582951 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:44:31.583952 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m04:44:31.583952 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m04:44:31.586950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:44:31.588951 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:31.588951 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m04:44:31.599952 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:44:31.602951 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:44:31.602951 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m04:44:31.602951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:31.637229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:44:31.637229 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:44:31.638237 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m04:44:31.639237 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m04:44:31.639237 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m04:44:31.640235 [debug] [Thread-1 (]: finished collecting timing info
[0m04:44:31.640235 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m04:44:31.640235 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:44:31.641236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a2d0d8f-a2cf-4596-83b7-90803388db40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4BEE3E0>]}
[0m04:44:31.641236 [error] [Thread-1 (]: 9 of 9 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.06s]
[0m04:44:31.642237 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:44:31.643235 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:44:31.643235 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:31.643235 [debug] [MainThread]: On master: BEGIN
[0m04:44:31.643235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:44:31.657870 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:44:31.658869 [debug] [MainThread]: On master: COMMIT
[0m04:44:31.658869 [debug] [MainThread]: Using postgres connection "master"
[0m04:44:31.658869 [debug] [MainThread]: On master: COMMIT
[0m04:44:31.659870 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:44:31.659870 [debug] [MainThread]: On master: Close
[0m04:44:31.660870 [info ] [MainThread]: 
[0m04:44:31.660870 [info ] [MainThread]: Finished running 7 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m04:44:31.660870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:31.661872 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:44:31.661872 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m04:44:31.661872 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m04:44:31.700869 [info ] [MainThread]: 
[0m04:44:31.700869 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m04:44:31.702870 [info ] [MainThread]: 
[0m04:44:31.702870 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)[0m
[0m04:44:31.703869 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:44:31.703869 [error] [MainThread]:   LINE 12:     NVL(host_name,'Anonymous') AS host_name,
[0m04:44:31.704870 [error] [MainThread]:                ^
[0m04:44:31.704870 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:44:31.704870 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:44:31.705872 [info ] [MainThread]: 
[0m04:44:31.705872 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)[0m
[0m04:44:31.706869 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:44:31.706869 [error] [MainThread]:   LINE 12:     NVL(host_name,'Anonymous') AS host_name,
[0m04:44:31.706869 [error] [MainThread]:                ^
[0m04:44:31.707869 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:44:31.707869 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:44:31.707869 [info ] [MainThread]: 
[0m04:44:31.708869 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m04:44:31.708869 [error] [MainThread]:   function replace(text, unknown) does not exist
[0m04:44:31.708869 [error] [MainThread]:   LINE 19:     ROUND( REPLACE(price_str,'$') ,2) AS price,
[0m04:44:31.709869 [error] [MainThread]:                       ^
[0m04:44:31.709869 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:44:31.709869 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:44:31.710870 [info ] [MainThread]: 
[0m04:44:31.710870 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m04:44:31.711869 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m04:44:31.711869 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m04:44:31.711869 [error] [MainThread]:                              ^
[0m04:44:31.712870 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:44:31.712870 [info ] [MainThread]: 
[0m04:44:31.712870 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m04:44:31.713869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4D0BD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4D0BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3F4D09120>]}


============================== 2022-08-22 04:49:11.269305 | ba887217-ca41-4dbe-9a06-802863e50dfa ==============================
[0m04:49:11.269305 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:49:11.270307 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:49:11.270307 [debug] [MainThread]: Tracking: tracking
[0m04:49:11.282876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5CB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5FD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5F310>]}
[0m04:49:11.284877 [debug] [MainThread]: Set downloads directory='C:\Users\nkduy3\AppData\Local\Temp\dbt-downloads-ldiyhetf'
[0m04:49:11.285912 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:49:11.637837 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:49:11.637837 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m04:49:12.039077 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m04:49:12.042077 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:49:12.225846 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:49:12.311870 [info ] [MainThread]: Installing Datavault-UK/dbtvault
[0m04:49:13.064360 [info ] [MainThread]:   Installed from version 0.8.3
[0m04:49:13.064360 [info ] [MainThread]:   Up to date!
[0m04:49:13.065360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba887217-ca41-4dbe-9a06-802863e50dfa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5CBB0>]}
[0m04:49:13.065360 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:49:15.033904 [info ] [MainThread]:   Installed from version 0.8.6
[0m04:49:15.034905 [info ] [MainThread]:   Up to date!
[0m04:49:15.034905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ba887217-ca41-4dbe-9a06-802863e50dfa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2FFEE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2FFECB0>]}
[0m04:49:15.035908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5CD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC2F5C790>]}


============================== 2022-08-22 04:49:21.386062 | e3b66396-bfc9-4448-8962-7ae56d0998c1 ==============================
[0m04:49:21.386062 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:49:21.386062 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:49:21.386062 [debug] [MainThread]: Tracking: tracking
[0m04:49:21.399060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE645C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE645E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE645CD30>]}
[0m04:49:21.768790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:21.769793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:21.769793 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m04:49:21.776759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE672C0D0>]}
[0m04:49:21.813759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE66F04F0>]}
[0m04:49:21.813759 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:49:21.814759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE66F0670>]}
[0m04:49:21.815760 [info ] [MainThread]: 
[0m04:49:21.816758 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:49:21.817758 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m04:49:21.826793 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m04:49:21.826793 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m04:49:21.826793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:21.851331 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m04:49:21.852331 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:49:21.854331 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m04:49:21.859330 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:49:21.859330 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m04:49:21.860331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:21.872330 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:49:21.872330 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:49:21.873335 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m04:49:21.875332 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m04:49:21.876331 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m04:49:21.877523 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m04:49:21.877523 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m04:49:21.879528 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:49:21.880532 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m04:49:21.880532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:21.892158 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:49:21.892158 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:49:21.893160 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:49:21.895157 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:49:21.896158 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m04:49:21.897158 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:49:21.901157 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:21.901157 [debug] [MainThread]: On master: BEGIN
[0m04:49:21.902157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:21.914158 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:49:21.914158 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:21.914158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:21.924159 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m04:49:21.925188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE66EB6A0>]}
[0m04:49:21.926159 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:21.926159 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:21.927157 [debug] [MainThread]: On master: BEGIN
[0m04:49:21.928157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:49:21.928157 [debug] [MainThread]: On master: COMMIT
[0m04:49:21.928157 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:21.928157 [debug] [MainThread]: On master: COMMIT
[0m04:49:21.929158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:49:21.929158 [debug] [MainThread]: On master: Close
[0m04:49:21.930157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:49:21.930157 [info ] [MainThread]: 
[0m04:49:21.933158 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m04:49:21.934158 [info ] [Thread-1 (]: 1 of 9 START view model dbo.src_hosts .......................................... [RUN]
[0m04:49:21.934158 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:21.934158 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m04:49:21.935159 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m04:49:21.938158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m04:49:21.940157 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:21.940157 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m04:49:21.970158 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m04:49:21.972158 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:21.973159 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m04:49:21.973159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:49:22.009820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m04:49:22.010821 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:22.010821 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m04:49:22.012820 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:49:22.018820 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:22.018820 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m04:49:22.019821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:22.021821 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:22.022821 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m04:49:22.023820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:22.038827 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:49:22.038827 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:22.038827 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:49:22.042110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:49:22.046143 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:49:22.047144 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m04:49:22.050118 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:49:22.051142 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.051142 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m04:49:22.052116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE6854070>]}
[0m04:49:22.052116 [info ] [Thread-1 (]: 1 of 9 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m04:49:22.053116 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m04:49:22.053116 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m04:49:22.054116 [info ] [Thread-1 (]: 2 of 9 START view model dbo.src_listings ....................................... [RUN]
[0m04:49:22.054116 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.055115 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m04:49:22.055115 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m04:49:22.058115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m04:49:22.060116 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.060116 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m04:49:22.064116 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m04:49:22.065116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.065116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m04:49:22.066117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.079120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:22.079120 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.080117 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m04:49:22.082115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:49:22.084116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.084116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m04:49:22.085116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:22.088116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.088116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m04:49:22.089116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:22.090116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:49:22.090116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.091116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:49:22.092116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:49:22.094116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:49:22.094116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m04:49:22.097118 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:49:22.098119 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.098119 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m04:49:22.099116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE68BF610>]}
[0m04:49:22.099116 [info ] [Thread-1 (]: 2 of 9 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m04:49:22.100116 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m04:49:22.100116 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m04:49:22.101117 [info ] [Thread-1 (]: 3 of 9 START view model dbo.src_reviews ........................................ [RUN]
[0m04:49:22.101117 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.101117 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m04:49:22.102117 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m04:49:22.105116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m04:49:22.107116 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.107116 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m04:49:22.110116 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m04:49:22.112116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.112116 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m04:49:22.112116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.125117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:22.125117 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.125117 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m04:49:22.127704 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:49:22.129710 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.129710 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m04:49:22.130710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:22.133710 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.133710 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m04:49:22.134859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:22.135867 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:49:22.135867 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.135867 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:49:22.137868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:49:22.140866 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:49:22.140866 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m04:49:22.142890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:49:22.143896 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.143896 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m04:49:22.143896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE6861D80>]}
[0m04:49:22.144896 [info ] [Thread-1 (]: 3 of 9 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m04:49:22.145896 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m04:49:22.145896 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:49:22.145896 [info ] [Thread-1 (]: 4 of 9 START view model dbo.dim_hosts_cleamsed ................................. [RUN]
[0m04:49:22.146896 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:49:22.146896 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleamsed
[0m04:49:22.146896 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleamsed
[0m04:49:22.149896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:49:22.151265 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.151265 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleamsed
[0m04:49:22.155275 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:49:22.157302 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:49:22.158273 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: BEGIN
[0m04:49:22.158273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.171272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:22.171272 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:49:22.172273 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleamsed"} */

  create view "airbnb"."dbo"."dim_hosts_cleamsed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:49:22.173272 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 12:     NVL(host_name,'Anonymous') AS host_name,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:49:22.173272 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: ROLLBACK
[0m04:49:22.174273 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.174273 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: Close
[0m04:49:22.174273 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)
  function nvl(text, unknown) does not exist
  LINE 12:     NVL(host_name,'Anonymous') AS host_name,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:49:22.174273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE68CE4A0>]}
[0m04:49:22.175275 [error] [Thread-1 (]: 4 of 9 ERROR creating view model dbo.dim_hosts_cleamsed ........................ [[31mERROR[0m in 0.03s]
[0m04:49:22.176272 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:49:22.176272 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m04:49:22.176272 [info ] [Thread-1 (]: 5 of 9 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m04:49:22.177271 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:49:22.177271 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m04:49:22.177271 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m04:49:22.180274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:49:22.181271 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.182271 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m04:49:22.185272 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:49:22.187271 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:49:22.187271 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m04:49:22.187271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.200274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:22.201273 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:49:22.201273 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:49:22.202273 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 12:     NVL(host_name,'Anonymous') AS host_name,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:49:22.202273 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: ROLLBACK
[0m04:49:22.203273 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.203273 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m04:49:22.203273 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(text, unknown) does not exist
  LINE 12:     NVL(host_name,'Anonymous') AS host_name,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:49:22.204274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE6903220>]}
[0m04:49:22.204274 [error] [Thread-1 (]: 5 of 9 ERROR creating view model dbo.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.03s]
[0m04:49:22.205273 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m04:49:22.205273 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m04:49:22.205273 [info ] [Thread-1 (]: 6 of 9 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m04:49:22.206272 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:49:22.206272 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m04:49:22.206272 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m04:49:22.209274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:49:22.211272 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.211272 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m04:49:22.214270 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:49:22.216272 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:49:22.216272 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m04:49:22.216272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.229576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:49:22.229576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:49:22.229576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m04:49:22.231575 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function replace(text, unknown) does not exist
LINE 19:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:49:22.231575 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m04:49:22.232576 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.232576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m04:49:22.232576 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function replace(text, unknown) does not exist
  LINE 19:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:49:22.233577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE676F0A0>]}
[0m04:49:22.233577 [error] [Thread-1 (]: 6 of 9 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.03s]
[0m04:49:22.234578 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m04:49:22.234578 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m04:49:22.235585 [info ] [Thread-1 (]: 7 of 9 START incremental model dbo.fct_reviews ................................. [RUN]
[0m04:49:22.235585 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.235585 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m04:49:22.235585 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m04:49:22.257617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m04:49:22.259587 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.259587 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m04:49:22.289620 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.289620 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp114922278616"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m04:49:22.289620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.442591 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.15 seconds
[0m04:49:22.449561 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.449561 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m04:49:22.450563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:49:22.451592 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.451592 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp114922278616'
        
      order by ordinal_position

  
[0m04:49:22.457592 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m04:49:22.461591 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.462592 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:49:22.465591 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:49:22.478592 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.478592 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp114922278616'
        
      order by ordinal_position

  
[0m04:49:22.481592 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:49:22.484561 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.484561 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:49:22.487592 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:49:22.495563 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:49:22.502595 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m04:49:22.504561 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.504561 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp114922278616"
    )
  
[0m04:49:22.505562 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m04:49:22.506561 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:49:22.507560 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:49:22.507560 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:49:22.509575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:49:22.510562 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.510562 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m04:49:22.510562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE676F520>]}
[0m04:49:22.511561 [info ] [Thread-1 (]: 7 of 9 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.27s]
[0m04:49:22.511561 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m04:49:22.512562 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m04:49:22.512562 [info ] [Thread-1 (]: 8 of 9 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m04:49:22.513562 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m04:49:22.513562 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:49:22.513562 [info ] [Thread-1 (]: 9 of 9 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m04:49:22.514562 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:49:22.514562 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m04:49:22.514562 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m04:49:22.518562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:49:22.519562 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.519562 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m04:49:22.531592 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:49:22.534593 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:49:22.534593 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m04:49:22.534593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:22.557562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:49:22.557562 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:49:22.557562 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m04:49:22.558561 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m04:49:22.559561 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m04:49:22.559561 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:22.560561 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m04:49:22.560561 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:49:22.560561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b66396-bfc9-4448-8962-7ae56d0998c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE6839270>]}
[0m04:49:22.561561 [error] [Thread-1 (]: 9 of 9 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.05s]
[0m04:49:22.561561 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:49:22.562563 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:49:22.563562 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:22.563562 [debug] [MainThread]: On master: BEGIN
[0m04:49:22.563562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:49:22.575563 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:49:22.575563 [debug] [MainThread]: On master: COMMIT
[0m04:49:22.575563 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:22.575563 [debug] [MainThread]: On master: COMMIT
[0m04:49:22.577022 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:49:22.577022 [debug] [MainThread]: On master: Close
[0m04:49:22.577022 [info ] [MainThread]: 
[0m04:49:22.578033 [info ] [MainThread]: Finished running 7 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m04:49:22.578033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:22.579033 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:49:22.579033 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m04:49:22.579033 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m04:49:22.619052 [info ] [MainThread]: 
[0m04:49:22.619052 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m04:49:22.620051 [info ] [MainThread]: 
[0m04:49:22.621051 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)[0m
[0m04:49:22.621051 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:49:22.622051 [error] [MainThread]:   LINE 12:     NVL(host_name,'Anonymous') AS host_name,
[0m04:49:22.622051 [error] [MainThread]:                ^
[0m04:49:22.622051 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:49:22.623051 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:49:22.623051 [info ] [MainThread]: 
[0m04:49:22.624052 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)[0m
[0m04:49:22.624052 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:49:22.625054 [error] [MainThread]:   LINE 12:     NVL(host_name,'Anonymous') AS host_name,
[0m04:49:22.625054 [error] [MainThread]:                ^
[0m04:49:22.625054 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:49:22.626051 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:49:22.626051 [info ] [MainThread]: 
[0m04:49:22.627051 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m04:49:22.627051 [error] [MainThread]:   function replace(text, unknown) does not exist
[0m04:49:22.627051 [error] [MainThread]:   LINE 19:     ROUND( REPLACE(price_str,'$') ,2) AS price,
[0m04:49:22.628051 [error] [MainThread]:                       ^
[0m04:49:22.628051 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:49:22.628051 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:49:22.629051 [info ] [MainThread]: 
[0m04:49:22.629051 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m04:49:22.630050 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m04:49:22.630050 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m04:49:22.630050 [error] [MainThread]:                              ^
[0m04:49:22.631050 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:49:22.631050 [info ] [MainThread]: 
[0m04:49:22.631050 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m04:49:22.632051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE66E96C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE67F65F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CE67F5450>]}


============================== 2022-08-22 04:53:17.191286 | d39363b8-9309-46a0-afa1-0d8195c28196 ==============================
[0m04:53:17.191286 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:53:17.192287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:53:17.192287 [debug] [MainThread]: Tracking: tracking
[0m04:53:17.204256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012766F7EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012766F7ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012766F7DD80>]}
[0m04:53:17.353287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m04:53:17.353287 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_hosts_cleansed.sql
[0m04:53:17.354258 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_listings_cleansed.sql
[0m04:53:17.354258 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_hosts_cleamsed.sql
[0m04:53:17.366258 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m04:53:17.376288 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m04:53:17.378289 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:53:17.436259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m04:53:17.443258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127673080D0>]}
[0m04:53:17.478262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127671C5750>]}
[0m04:53:17.479291 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:53:17.479291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127671C5720>]}
[0m04:53:17.481289 [info ] [MainThread]: 
[0m04:53:17.481289 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:53:17.483257 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m04:53:17.491289 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m04:53:17.492291 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m04:53:17.492291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:53:17.534323 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.04 seconds
[0m04:53:17.538346 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:53:17.543298 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m04:53:17.560346 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:53:17.561346 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m04:53:17.562347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:53:17.606616 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m04:53:17.606616 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:53:17.606616 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:53:17.609617 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:53:17.610618 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m04:53:17.611618 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:53:17.611618 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m04:53:17.613619 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:53:17.613619 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m04:53:17.613619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:53:17.627619 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:53:17.627619 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:53:17.627619 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m04:53:17.629616 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m04:53:17.630617 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m04:53:17.631617 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m04:53:17.637618 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:17.637618 [debug] [MainThread]: On master: BEGIN
[0m04:53:17.637618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:53:17.650619 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:53:17.650619 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:17.651618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:53:17.661618 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m04:53:17.662618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767302560>]}
[0m04:53:17.662618 [debug] [MainThread]: On master: ROLLBACK
[0m04:53:17.663617 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:17.664617 [debug] [MainThread]: On master: BEGIN
[0m04:53:17.665736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:53:17.665736 [debug] [MainThread]: On master: COMMIT
[0m04:53:17.665736 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:17.666742 [debug] [MainThread]: On master: COMMIT
[0m04:53:17.667408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:53:17.667408 [debug] [MainThread]: On master: Close
[0m04:53:17.667408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:53:17.668414 [info ] [MainThread]: 
[0m04:53:17.671414 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m04:53:17.672415 [info ] [Thread-1 (]: 1 of 9 START view model dbo.src_hosts .......................................... [RUN]
[0m04:53:17.672415 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.672415 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m04:53:17.673414 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m04:53:17.675415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m04:53:17.677415 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.677415 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m04:53:17.708444 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m04:53:17.710444 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.711414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m04:53:17.711414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:53:17.738414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:53:17.738414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.738414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m04:53:17.740414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:53:17.746412 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.746412 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m04:53:17.747412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:17.750412 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.751412 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m04:53:17.752415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:17.767446 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:53:17.768414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.768414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:53:17.771412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:53:17.776411 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:53:17.776411 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m04:53:17.782484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m04:53:17.783528 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.784528 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m04:53:17.784528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767334610>]}
[0m04:53:17.784528 [info ] [Thread-1 (]: 1 of 9 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m04:53:17.786498 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m04:53:17.786498 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m04:53:17.786498 [info ] [Thread-1 (]: 2 of 9 START view model dbo.src_listings ....................................... [RUN]
[0m04:53:17.787497 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.787497 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m04:53:17.788499 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m04:53:17.790499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m04:53:17.792498 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.792498 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m04:53:17.796497 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m04:53:17.797528 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.797528 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m04:53:17.798499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:17.852085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m04:53:17.853131 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.853131 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m04:53:17.858101 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:53:17.862130 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.863131 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m04:53:17.865098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:17.871093 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.871093 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m04:53:17.873259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:17.875263 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:53:17.875263 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.875263 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:53:17.877968 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:53:17.880006 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:53:17.881005 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m04:53:17.882975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:53:17.883975 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.884976 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m04:53:17.884976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127673C4160>]}
[0m04:53:17.884976 [info ] [Thread-1 (]: 2 of 9 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.10s]
[0m04:53:17.885976 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m04:53:17.886977 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m04:53:17.886977 [info ] [Thread-1 (]: 3 of 9 START view model dbo.src_reviews ........................................ [RUN]
[0m04:53:17.887975 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.887975 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m04:53:17.887975 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m04:53:17.890978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m04:53:17.891978 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.892975 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m04:53:17.895974 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m04:53:17.897975 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.897975 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m04:53:17.897975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:17.910921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:53:17.911921 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.911921 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m04:53:17.913921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:53:17.915922 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.916922 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m04:53:17.917922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:17.919920 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.919920 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m04:53:17.920921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:17.921921 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:53:17.922920 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.922920 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:53:17.924931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:53:17.927921 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:53:17.927921 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m04:53:17.930922 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:53:17.931922 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.931922 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m04:53:17.931922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767433700>]}
[0m04:53:17.932921 [info ] [Thread-1 (]: 3 of 9 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m04:53:17.932921 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m04:53:17.933923 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:53:17.933923 [info ] [Thread-1 (]: 4 of 9 START view model dbo.dim_hosts_cleamsed ................................. [RUN]
[0m04:53:17.934922 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:53:17.934922 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleamsed
[0m04:53:17.934922 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleamsed
[0m04:53:17.937921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:53:17.938921 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.938921 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleamsed
[0m04:53:17.942921 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:53:17.944954 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:53:17.944954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: BEGIN
[0m04:53:17.944954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:17.984772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m04:53:17.984772 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:53:17.985771 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleamsed"} */

  create view "airbnb"."dbo"."dim_hosts_cleamsed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FRO "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:53:17.989767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FRO"
LINE 5:     SELECT * FRO "airbnb"."dbo"."src_hosts"
                     ^

[0m04:53:17.990773 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: ROLLBACK
[0m04:53:17.993801 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:17.994771 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: Close
[0m04:53:17.995770 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)
  syntax error at or near "FRO"
  LINE 5:     SELECT * FRO "airbnb"."dbo"."src_hosts"
                       ^
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:53:17.996773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767423CA0>]}
[0m04:53:17.997773 [error] [Thread-1 (]: 4 of 9 ERROR creating view model dbo.dim_hosts_cleamsed ........................ [[31mERROR[0m in 0.06s]
[0m04:53:18.000760 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:53:18.001771 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m04:53:18.002767 [info ] [Thread-1 (]: 5 of 9 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m04:53:18.004759 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:53:18.005794 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m04:53:18.006763 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m04:53:18.014766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:53:18.020763 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.020763 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m04:53:18.032761 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:53:18.038802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:53:18.039795 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m04:53:18.040770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:18.094127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m04:53:18.094127 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:53:18.094127 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:53:18.097129 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 9:     NVL(host_name,'Anonymous') AS host_name,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:53:18.097129 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: ROLLBACK
[0m04:53:18.099127 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.099127 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m04:53:18.100124 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(text, unknown) does not exist
  LINE 9:     NVL(host_name,'Anonymous') AS host_name,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:53:18.101126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001276745DBA0>]}
[0m04:53:18.101126 [error] [Thread-1 (]: 5 of 9 ERROR creating view model dbo.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.10s]
[0m04:53:18.103124 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m04:53:18.103124 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m04:53:18.104126 [info ] [Thread-1 (]: 6 of 9 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m04:53:18.105123 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:53:18.106127 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m04:53:18.106127 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m04:53:18.112157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:53:18.115159 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.116123 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m04:53:18.119159 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:53:18.121152 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:53:18.121152 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m04:53:18.121152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:18.135121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:53:18.135121 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:53:18.136123 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m04:53:18.137122 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function replace(text, unknown) does not exist
LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:53:18.137122 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m04:53:18.138122 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.138122 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m04:53:18.139121 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function replace(text, unknown) does not exist
  LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:53:18.139121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127674732E0>]}
[0m04:53:18.139121 [error] [Thread-1 (]: 6 of 9 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.03s]
[0m04:53:18.140122 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m04:53:18.140122 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m04:53:18.141122 [info ] [Thread-1 (]: 7 of 9 START incremental model dbo.fct_reviews ................................. [RUN]
[0m04:53:18.141122 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.142122 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m04:53:18.142122 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m04:53:18.163122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m04:53:18.165121 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.165121 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m04:53:18.195154 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.196152 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp115318184122"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m04:53:18.196152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:18.329198 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.13 seconds
[0m04:53:18.336201 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.337198 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m04:53:18.338168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:53:18.338168 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.338168 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp115318184122'
        
      order by ordinal_position

  
[0m04:53:18.344169 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:53:18.349170 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.349170 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:53:18.352168 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:53:18.364202 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.364202 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp115318184122'
        
      order by ordinal_position

  
[0m04:53:18.367201 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:53:18.370166 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.371166 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:53:18.373734 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:53:18.380734 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:53:18.388734 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m04:53:18.390704 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.390704 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp115318184122"
    )
  
[0m04:53:18.392360 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m04:53:18.393367 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:53:18.393367 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:53:18.393367 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:53:18.396368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:53:18.396368 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.396368 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m04:53:18.397366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127674B1DE0>]}
[0m04:53:18.397366 [info ] [Thread-1 (]: 7 of 9 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.26s]
[0m04:53:18.398366 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m04:53:18.398366 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m04:53:18.399368 [info ] [Thread-1 (]: 8 of 9 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m04:53:18.399368 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m04:53:18.400370 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:53:18.400370 [info ] [Thread-1 (]: 9 of 9 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m04:53:18.400370 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:53:18.401369 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m04:53:18.401369 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m04:53:18.404396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:53:18.406399 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.406399 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m04:53:18.447396 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:53:18.449404 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:53:18.449404 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m04:53:18.450401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:18.474426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:53:18.474426 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:53:18.474426 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m04:53:18.475420 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m04:53:18.476400 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m04:53:18.476400 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:18.477399 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m04:53:18.477399 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:53:18.477399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39363b8-9309-46a0-afa1-0d8195c28196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001276740B520>]}
[0m04:53:18.478399 [error] [Thread-1 (]: 9 of 9 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m04:53:18.479399 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:53:18.479399 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:53:18.480399 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:18.480399 [debug] [MainThread]: On master: BEGIN
[0m04:53:18.480399 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:53:18.492398 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:53:18.492398 [debug] [MainThread]: On master: COMMIT
[0m04:53:18.492398 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:18.493399 [debug] [MainThread]: On master: COMMIT
[0m04:53:18.493399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:53:18.494399 [debug] [MainThread]: On master: Close
[0m04:53:18.494399 [info ] [MainThread]: 
[0m04:53:18.495403 [info ] [MainThread]: Finished running 7 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m04:53:18.495403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:53:18.495403 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:53:18.495403 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m04:53:18.496399 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m04:53:18.533399 [info ] [MainThread]: 
[0m04:53:18.533399 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m04:53:18.534399 [info ] [MainThread]: 
[0m04:53:18.534399 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)[0m
[0m04:53:18.535398 [error] [MainThread]:   syntax error at or near "FRO"
[0m04:53:18.536399 [error] [MainThread]:   LINE 5:     SELECT * FRO "airbnb"."dbo"."src_hosts"
[0m04:53:18.536399 [error] [MainThread]:                        ^
[0m04:53:18.537400 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:53:18.537400 [info ] [MainThread]: 
[0m04:53:18.537400 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)[0m
[0m04:53:18.538398 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:53:18.538398 [error] [MainThread]:   LINE 9:     NVL(host_name,'Anonymous') AS host_name,
[0m04:53:18.539400 [error] [MainThread]:               ^
[0m04:53:18.539400 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:53:18.539400 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:53:18.540400 [info ] [MainThread]: 
[0m04:53:18.540400 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m04:53:18.540400 [error] [MainThread]:   function replace(text, unknown) does not exist
[0m04:53:18.541398 [error] [MainThread]:   LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
[0m04:53:18.541398 [error] [MainThread]:                       ^
[0m04:53:18.542399 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:53:18.542399 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:53:18.542399 [info ] [MainThread]: 
[0m04:53:18.543400 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m04:53:18.543400 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m04:53:18.543400 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m04:53:18.544398 [error] [MainThread]:                              ^
[0m04:53:18.544398 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:53:18.544398 [info ] [MainThread]: 
[0m04:53:18.545398 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m04:53:18.545398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767472D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767472CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012767472D10>]}


============================== 2022-08-22 04:54:43.793871 | 702d50ed-a2b9-46f8-8385-fdc71a1a8356 ==============================
[0m04:54:43.793871 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:54:43.794408 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:54:43.794408 [debug] [MainThread]: Tracking: tracking
[0m04:54:43.807446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90CEDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90CEC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90CED420>]}
[0m04:54:43.955416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:54:43.955416 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:54:43.956416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src

[0m04:54:43.962413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90FBC0D0>]}
[0m04:54:43.999415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90F80520>]}
[0m04:54:43.999415 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:54:44.000415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90F806A0>]}
[0m04:54:44.001415 [info ] [MainThread]: 
[0m04:54:44.002415 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:54:44.003415 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m04:54:44.012416 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m04:54:44.012416 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m04:54:44.012416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:54:44.028418 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.02 seconds
[0m04:54:44.029417 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:54:44.031415 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m04:54:44.036415 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:54:44.037415 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m04:54:44.037415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:54:44.049416 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.050415 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:54:44.050415 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:54:44.052419 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:54:44.053415 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m04:54:44.054416 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:54:44.055415 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m04:54:44.057415 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:54:44.057415 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m04:54:44.057415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:54:44.069580 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.070586 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:54:44.070586 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m04:54:44.072587 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m04:54:44.074587 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m04:54:44.075588 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m04:54:44.079586 [debug] [MainThread]: Using postgres connection "master"
[0m04:54:44.079586 [debug] [MainThread]: On master: BEGIN
[0m04:54:44.080587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:54:44.092589 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.093589 [debug] [MainThread]: Using postgres connection "master"
[0m04:54:44.093589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:54:44.103588 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m04:54:44.104588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90F79570>]}
[0m04:54:44.104588 [debug] [MainThread]: On master: ROLLBACK
[0m04:54:44.105695 [debug] [MainThread]: Using postgres connection "master"
[0m04:54:44.105695 [debug] [MainThread]: On master: BEGIN
[0m04:54:44.106701 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:54:44.107701 [debug] [MainThread]: On master: COMMIT
[0m04:54:44.107701 [debug] [MainThread]: Using postgres connection "master"
[0m04:54:44.107701 [debug] [MainThread]: On master: COMMIT
[0m04:54:44.108701 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:54:44.108701 [debug] [MainThread]: On master: Close
[0m04:54:44.108701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:54:44.109701 [info ] [MainThread]: 
[0m04:54:44.112700 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m04:54:44.112700 [info ] [Thread-1 (]: 1 of 9 START view model dbo.src_hosts .......................................... [RUN]
[0m04:54:44.113701 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.113701 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m04:54:44.113701 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m04:54:44.117702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m04:54:44.118702 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.119701 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m04:54:44.150700 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m04:54:44.153701 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.153701 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m04:54:44.153701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:54:44.166701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.166701 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.167701 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m04:54:44.168701 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:54:44.174700 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.174700 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m04:54:44.175701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:54:44.178701 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.178701 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m04:54:44.179701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:54:44.194700 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:54:44.194700 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.195700 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:54:44.197713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:54:44.202700 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:54:44.202700 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m04:54:44.205863 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:54:44.206866 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.206866 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m04:54:44.206866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F910E8A30>]}
[0m04:54:44.207865 [info ] [Thread-1 (]: 1 of 9 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.09s]
[0m04:54:44.208865 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m04:54:44.208865 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m04:54:44.209862 [info ] [Thread-1 (]: 2 of 9 START view model dbo.src_listings ....................................... [RUN]
[0m04:54:44.209862 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.209862 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m04:54:44.210863 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m04:54:44.213863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m04:54:44.215865 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.215865 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m04:54:44.219863 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m04:54:44.220862 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.221864 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m04:54:44.221864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.235493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.235493 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.235493 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m04:54:44.237491 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:54:44.240494 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.240494 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m04:54:44.241490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:54:44.244492 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.245495 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m04:54:44.246494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:54:44.247492 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:54:44.247492 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.248492 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:54:44.250490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:54:44.252491 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:54:44.252491 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m04:54:44.255312 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:54:44.256312 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.256312 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m04:54:44.256312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F911536A0>]}
[0m04:54:44.257313 [info ] [Thread-1 (]: 2 of 9 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m04:54:44.257313 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m04:54:44.258313 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m04:54:44.258313 [info ] [Thread-1 (]: 3 of 9 START view model dbo.src_reviews ........................................ [RUN]
[0m04:54:44.259311 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.259311 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m04:54:44.259311 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m04:54:44.263309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m04:54:44.265315 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.265315 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m04:54:44.269310 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m04:54:44.270311 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.271311 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m04:54:44.271311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.283760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.283760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.283760 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m04:54:44.285759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:54:44.288762 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.289762 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m04:54:44.290759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:54:44.292759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.292759 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m04:54:44.293757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:54:44.295758 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:54:44.295758 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.295758 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:54:44.298183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:54:44.300181 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:54:44.300181 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m04:54:44.302203 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:54:44.303181 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.303181 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m04:54:44.304181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F910E8700>]}
[0m04:54:44.304181 [info ] [Thread-1 (]: 3 of 9 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m04:54:44.305183 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m04:54:44.305183 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:54:44.306181 [info ] [Thread-1 (]: 4 of 9 START view model dbo.dim_hosts_cleamsed ................................. [RUN]
[0m04:54:44.306181 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:54:44.306181 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleamsed
[0m04:54:44.307182 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleamsed
[0m04:54:44.309182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:54:44.311180 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.311180 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleamsed
[0m04:54:44.316181 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:54:44.318183 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:54:44.318183 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: BEGIN
[0m04:54:44.318183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.331185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.331185 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:54:44.331185 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleamsed"} */

  create view "airbnb"."dbo"."dim_hosts_cleamsed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FRO "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:54:44.332183 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FRO"
LINE 5:     SELECT * FRO "airbnb"."dbo"."src_hosts"
                     ^

[0m04:54:44.332183 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: ROLLBACK
[0m04:54:44.333181 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.333181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: Close
[0m04:54:44.334181 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)
  syntax error at or near "FRO"
  LINE 5:     SELECT * FRO "airbnb"."dbo"."src_hosts"
                       ^
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:54:44.334181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F9115D1E0>]}
[0m04:54:44.334181 [error] [Thread-1 (]: 4 of 9 ERROR creating view model dbo.dim_hosts_cleamsed ........................ [[31mERROR[0m in 0.03s]
[0m04:54:44.335182 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:54:44.335182 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m04:54:44.336183 [info ] [Thread-1 (]: 5 of 9 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m04:54:44.336183 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:54:44.337183 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m04:54:44.337183 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m04:54:44.340181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:54:44.341182 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.342182 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m04:54:44.345212 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:54:44.347181 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:54:44.347181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m04:54:44.347181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.360182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.360182 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:54:44.360182 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:54:44.361182 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 9:     NVL(host_name,'Anonymous') AS host_name,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:54:44.362181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: ROLLBACK
[0m04:54:44.362181 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.362181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m04:54:44.363181 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(text, unknown) does not exist
  LINE 9:     NVL(host_name,'Anonymous') AS host_name,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:54:44.363181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F91195F90>]}
[0m04:54:44.363181 [error] [Thread-1 (]: 5 of 9 ERROR creating view model dbo.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.03s]
[0m04:54:44.364181 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m04:54:44.365182 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m04:54:44.365182 [info ] [Thread-1 (]: 6 of 9 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m04:54:44.366183 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:54:44.366183 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m04:54:44.366183 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m04:54:44.369183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:54:44.371182 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.371182 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m04:54:44.375182 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:54:44.377181 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:54:44.377181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m04:54:44.377181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.390182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.390182 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:54:44.390182 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m04:54:44.392181 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function replace(text, unknown) does not exist
LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:54:44.392181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m04:54:44.393181 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.393181 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m04:54:44.393181 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function replace(text, unknown) does not exist
  LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:54:44.394182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90FFF130>]}
[0m04:54:44.394182 [error] [Thread-1 (]: 6 of 9 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.03s]
[0m04:54:44.395183 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m04:54:44.395183 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m04:54:44.395183 [info ] [Thread-1 (]: 7 of 9 START incremental model dbo.fct_reviews ................................. [RUN]
[0m04:54:44.396182 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.396182 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m04:54:44.396182 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m04:54:44.419181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m04:54:44.421181 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.421181 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m04:54:44.451212 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.451212 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp115444440182"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m04:54:44.452208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.569223 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.12 seconds
[0m04:54:44.576223 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.576223 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m04:54:44.577194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:54:44.578191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.578191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp115444440182'
        
      order by ordinal_position

  
[0m04:54:44.584192 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m04:54:44.588193 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.589192 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:54:44.592223 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:54:44.605193 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.605193 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp115444440182'
        
      order by ordinal_position

  
[0m04:54:44.608227 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:54:44.611192 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.612192 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:54:44.614195 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:54:44.622193 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:54:44.629192 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m04:54:44.631488 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.631488 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp115444440182"
    )
  
[0m04:54:44.632494 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m04:54:44.634496 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:54:44.634496 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:54:44.634496 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:54:44.638499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:54:44.638499 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.638499 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m04:54:44.639499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90FFF5B0>]}
[0m04:54:44.639499 [info ] [Thread-1 (]: 7 of 9 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.24s]
[0m04:54:44.640496 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m04:54:44.641494 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m04:54:44.641494 [info ] [Thread-1 (]: 8 of 9 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m04:54:44.641494 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m04:54:44.642494 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:54:44.642494 [info ] [Thread-1 (]: 9 of 9 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m04:54:44.643493 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:54:44.643493 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m04:54:44.643493 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m04:54:44.646494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:54:44.648493 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.648493 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m04:54:44.660492 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:54:44.662493 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:54:44.662493 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m04:54:44.663493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:54:44.697555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m04:54:44.698545 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:54:44.698545 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m04:54:44.699573 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m04:54:44.699573 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m04:54:44.700549 [debug] [Thread-1 (]: finished collecting timing info
[0m04:54:44.700549 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m04:54:44.700549 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:54:44.701545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '702d50ed-a2b9-46f8-8385-fdc71a1a8356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F910C9270>]}
[0m04:54:44.701545 [error] [Thread-1 (]: 9 of 9 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.06s]
[0m04:54:44.702548 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:54:44.703550 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:54:44.703550 [debug] [MainThread]: Using postgres connection "master"
[0m04:54:44.703550 [debug] [MainThread]: On master: BEGIN
[0m04:54:44.703550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:54:44.715545 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:54:44.716545 [debug] [MainThread]: On master: COMMIT
[0m04:54:44.716545 [debug] [MainThread]: Using postgres connection "master"
[0m04:54:44.716545 [debug] [MainThread]: On master: COMMIT
[0m04:54:44.717546 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:54:44.717546 [debug] [MainThread]: On master: Close
[0m04:54:44.718545 [info ] [MainThread]: 
[0m04:54:44.718545 [info ] [MainThread]: Finished running 7 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m04:54:44.719549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:54:44.719549 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:54:44.719549 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m04:54:44.719549 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m04:54:44.758202 [info ] [MainThread]: 
[0m04:54:44.759177 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m04:54:44.760184 [info ] [MainThread]: 
[0m04:54:44.760184 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)[0m
[0m04:54:44.761182 [error] [MainThread]:   syntax error at or near "FRO"
[0m04:54:44.761182 [error] [MainThread]:   LINE 5:     SELECT * FRO "airbnb"."dbo"."src_hosts"
[0m04:54:44.762183 [error] [MainThread]:                        ^
[0m04:54:44.762183 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:54:44.762183 [info ] [MainThread]: 
[0m04:54:44.763183 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)[0m
[0m04:54:44.763183 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:54:44.764183 [error] [MainThread]:   LINE 9:     NVL(host_name,'Anonymous') AS host_name,
[0m04:54:44.764183 [error] [MainThread]:               ^
[0m04:54:44.764183 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:54:44.765183 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:54:44.765183 [info ] [MainThread]: 
[0m04:54:44.766184 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m04:54:44.766184 [error] [MainThread]:   function replace(text, unknown) does not exist
[0m04:54:44.767183 [error] [MainThread]:   LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
[0m04:54:44.767183 [error] [MainThread]:                       ^
[0m04:54:44.767183 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:54:44.768182 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:54:44.768182 [info ] [MainThread]: 
[0m04:54:44.769183 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m04:54:44.769183 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m04:54:44.769183 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m04:54:44.770183 [error] [MainThread]:                              ^
[0m04:54:44.770183 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:54:44.770183 [info ] [MainThread]: 
[0m04:54:44.771183 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m04:54:44.771183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F90F79750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F91086680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F910855D0>]}


============================== 2022-08-22 04:56:42.253692 | 1e9069b1-52fd-4630-800a-5b142e81c838 ==============================
[0m04:56:42.253692 [info ] [MainThread]: Running with dbt=1.2.0
[0m04:56:42.254662 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:56:42.254662 [debug] [MainThread]: Tracking: tracking
[0m04:56:42.267662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA26DDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA26DC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA26DD420>]}
[0m04:56:42.412692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:56:42.412692 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_hosts_cleamsed.sql
[0m04:56:42.424694 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleamsed.sql
[0m04:56:42.446784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres.dim
- models.dbt_postgres

[0m04:56:42.452708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA29AA020>]}
[0m04:56:42.489708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2965780>]}
[0m04:56:42.489708 [info ] [MainThread]: Found 9 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m04:56:42.490710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2925780>]}
[0m04:56:42.491708 [info ] [MainThread]: 
[0m04:56:42.492708 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:56:42.493708 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m04:56:42.502738 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m04:56:42.502738 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m04:56:42.502738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:42.520708 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.02 seconds
[0m04:56:42.521708 [debug] [ThreadPool]: On list_airbnb: Close
[0m04:56:42.523708 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m04:56:42.528709 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:56:42.529710 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m04:56:42.529710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:56:42.541709 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:56:42.541709 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m04:56:42.542710 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m04:56:42.544707 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:56:42.545710 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m04:56:42.546709 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m04:56:42.546709 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m04:56:42.548710 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:56:42.548710 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m04:56:42.549710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:56:42.561266 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:56:42.561266 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m04:56:42.562268 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m04:56:42.564295 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m04:56:42.566307 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m04:56:42.567273 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m04:56:42.579270 [debug] [MainThread]: Using postgres connection "master"
[0m04:56:42.579270 [debug] [MainThread]: On master: BEGIN
[0m04:56:42.580270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:56:42.622237 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m04:56:42.622237 [debug] [MainThread]: Using postgres connection "master"
[0m04:56:42.623219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:56:42.637221 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m04:56:42.638253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA29FE380>]}
[0m04:56:42.639250 [debug] [MainThread]: On master: ROLLBACK
[0m04:56:42.640182 [debug] [MainThread]: Using postgres connection "master"
[0m04:56:42.641190 [debug] [MainThread]: On master: BEGIN
[0m04:56:42.643191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:56:42.643191 [debug] [MainThread]: On master: COMMIT
[0m04:56:42.643191 [debug] [MainThread]: Using postgres connection "master"
[0m04:56:42.644190 [debug] [MainThread]: On master: COMMIT
[0m04:56:42.645191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:56:42.645191 [debug] [MainThread]: On master: Close
[0m04:56:42.646191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:56:42.646191 [info ] [MainThread]: 
[0m04:56:42.651191 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m04:56:42.651191 [info ] [Thread-1 (]: 1 of 9 START view model dbo.src_hosts .......................................... [RUN]
[0m04:56:42.652189 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.652189 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m04:56:42.652189 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m04:56:42.656188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m04:56:42.658189 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.658189 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m04:56:42.697229 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m04:56:42.699229 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.699229 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m04:56:42.699229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:56:42.735189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m04:56:42.736188 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.736188 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m04:56:42.738189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:56:42.743189 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.744188 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m04:56:42.745189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:56:42.748188 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.748188 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m04:56:42.750189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:56:42.765219 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:56:42.765219 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.765219 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m04:56:42.768461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:56:42.772490 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m04:56:42.772490 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m04:56:42.775468 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:56:42.776459 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.777460 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m04:56:42.777460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2A47F40>]}
[0m04:56:42.777460 [info ] [Thread-1 (]: 1 of 9 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.13s]
[0m04:56:42.778459 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m04:56:42.778459 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m04:56:42.779460 [info ] [Thread-1 (]: 2 of 9 START view model dbo.src_listings ....................................... [RUN]
[0m04:56:42.780459 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.780459 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m04:56:42.780459 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m04:56:42.783458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m04:56:42.784459 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.784459 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m04:56:42.788459 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m04:56:42.790458 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.790458 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m04:56:42.790458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:42.805206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:56:42.805206 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.805206 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m04:56:42.807205 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:56:42.810203 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.810203 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m04:56:42.811204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:56:42.814203 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.814203 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m04:56:42.815205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:56:42.817208 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:56:42.817208 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.817208 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m04:56:42.819208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:56:42.822202 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m04:56:42.822202 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m04:56:42.824203 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:56:42.825204 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.826203 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m04:56:42.826203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2A7E350>]}
[0m04:56:42.826203 [info ] [Thread-1 (]: 2 of 9 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m04:56:42.827208 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m04:56:42.828207 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m04:56:42.828207 [info ] [Thread-1 (]: 3 of 9 START view model dbo.src_reviews ........................................ [RUN]
[0m04:56:42.829204 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.829204 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m04:56:42.829204 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m04:56:42.832204 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m04:56:42.833204 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.833204 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m04:56:42.837207 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m04:56:42.838238 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.839208 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m04:56:42.839208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:42.852886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:56:42.852886 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.852886 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m04:56:42.854878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:56:42.857879 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.857879 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m04:56:42.858880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:56:42.860882 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.861879 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m04:56:42.862881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:56:42.863880 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:56:42.863880 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.863880 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m04:56:42.866102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:56:42.869107 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m04:56:42.869107 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m04:56:42.871107 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:56:42.872107 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.872107 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m04:56:42.873106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2B1BF40>]}
[0m04:56:42.873106 [info ] [Thread-1 (]: 3 of 9 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m04:56:42.874108 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m04:56:42.874108 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:56:42.875107 [info ] [Thread-1 (]: 4 of 9 START view model dbo.dim_hosts_cleamsed ................................. [RUN]
[0m04:56:42.875107 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:56:42.876107 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleamsed
[0m04:56:42.876107 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleamsed
[0m04:56:42.878108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:56:42.880114 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.881112 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleamsed
[0m04:56:42.884106 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:56:42.886215 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:56:42.886215 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: BEGIN
[0m04:56:42.886215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:42.920118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:56:42.921117 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleamsed"
[0m04:56:42.921117 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleamsed"} */

  create view "airbnb"."dbo"."dim_hosts_cleamsed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:56:42.922116 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 9:     NVL(host_name,'Anonymous') AS host_name,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:56:42.922116 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: ROLLBACK
[0m04:56:42.923116 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.923116 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleamsed: Close
[0m04:56:42.923116 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)
  function nvl(text, unknown) does not exist
  LINE 9:     NVL(host_name,'Anonymous') AS host_name,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:56:42.924117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2B0C2B0>]}
[0m04:56:42.924117 [error] [Thread-1 (]: 4 of 9 ERROR creating view model dbo.dim_hosts_cleamsed ........................ [[31mERROR[0m in 0.05s]
[0m04:56:42.925117 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleamsed
[0m04:56:42.925117 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m04:56:42.926117 [info ] [Thread-1 (]: 5 of 9 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m04:56:42.926117 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:56:42.926117 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m04:56:42.927118 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m04:56:42.929117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:56:42.931118 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.931118 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m04:56:42.934116 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m04:56:42.936117 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:56:42.936117 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m04:56:42.936117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:42.948932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:56:42.948932 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m04:56:42.948932 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    NVL(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m04:56:42.949938 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function nvl(text, unknown) does not exist
LINE 9:     NVL(host_name,'Anonymous') AS host_name,
            ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:56:42.950938 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: ROLLBACK
[0m04:56:42.950938 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.951937 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m04:56:42.951937 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)
  function nvl(text, unknown) does not exist
  LINE 9:     NVL(host_name,'Anonymous') AS host_name,
              ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:56:42.951937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2B3F7C0>]}
[0m04:56:42.952940 [error] [Thread-1 (]: 5 of 9 ERROR creating view model dbo.dim_hosts_cleansed ........................ [[31mERROR[0m in 0.03s]
[0m04:56:42.952940 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m04:56:42.953937 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m04:56:42.953937 [info ] [Thread-1 (]: 6 of 9 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m04:56:42.953937 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:56:42.954937 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m04:56:42.954937 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m04:56:42.957938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:56:42.959937 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.959937 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m04:56:42.963937 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m04:56:42.965938 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:56:42.965938 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m04:56:42.965938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:42.978788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m04:56:42.979786 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m04:56:42.979786 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m04:56:42.980789 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function replace(text, unknown) does not exist
LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m04:56:42.980789 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m04:56:42.981786 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:42.981786 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m04:56:42.982788 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function replace(text, unknown) does not exist
  LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:56:42.982788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2B13640>]}
[0m04:56:42.982788 [error] [Thread-1 (]: 6 of 9 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.03s]
[0m04:56:42.983789 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m04:56:42.983789 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m04:56:42.984786 [info ] [Thread-1 (]: 7 of 9 START incremental model dbo.fct_reviews ................................. [RUN]
[0m04:56:42.984786 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:42.985786 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m04:56:42.985786 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m04:56:43.006786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m04:56:43.008819 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:43.008819 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m04:56:43.039816 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.039816 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp115643027787"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m04:56:43.039816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:43.168794 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.13 seconds
[0m04:56:43.175786 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.176786 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m04:56:43.177787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:56:43.177787 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.177787 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp115643027787'
        
      order by ordinal_position

  
[0m04:56:43.184819 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m04:56:43.189816 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.189816 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:56:43.193787 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:56:43.205784 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.205784 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp115643027787'
        
      order by ordinal_position

  
[0m04:56:43.208786 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:56:43.212785 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.212785 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m04:56:43.215787 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m04:56:43.222785 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m04:56:43.230818 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m04:56:43.232704 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.232704 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp115643027787"
    )
  
[0m04:56:43.233763 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m04:56:43.235799 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:56:43.235799 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m04:56:43.235799 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m04:56:43.237768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:56:43.238768 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:43.238768 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m04:56:43.239772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2B9E710>]}
[0m04:56:43.239772 [info ] [Thread-1 (]: 7 of 9 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.25s]
[0m04:56:43.240768 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m04:56:43.240768 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m04:56:43.241768 [info ] [Thread-1 (]: 8 of 9 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m04:56:43.242768 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m04:56:43.242768 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:56:43.242768 [info ] [Thread-1 (]: 9 of 9 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m04:56:43.243768 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:56:43.243768 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m04:56:43.243768 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m04:56:43.246768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:56:43.248769 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:43.248769 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m04:56:43.260767 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:56:43.263768 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:56:43.263768 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m04:56:43.263768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:56:43.298008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:56:43.298008 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m04:56:43.298008 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m04:56:43.299009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m04:56:43.299009 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m04:56:43.300008 [debug] [Thread-1 (]: finished collecting timing info
[0m04:56:43.300008 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m04:56:43.301009 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:56:43.301009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9069b1-52fd-4630-800a-5b142e81c838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2C411E0>]}
[0m04:56:43.301009 [error] [Thread-1 (]: 9 of 9 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.06s]
[0m04:56:43.302009 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m04:56:43.303008 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:56:43.303008 [debug] [MainThread]: Using postgres connection "master"
[0m04:56:43.304009 [debug] [MainThread]: On master: BEGIN
[0m04:56:43.304009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:56:43.315009 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:56:43.316009 [debug] [MainThread]: On master: COMMIT
[0m04:56:43.316009 [debug] [MainThread]: Using postgres connection "master"
[0m04:56:43.317016 [debug] [MainThread]: On master: COMMIT
[0m04:56:43.319015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:56:43.319015 [debug] [MainThread]: On master: Close
[0m04:56:43.321017 [info ] [MainThread]: 
[0m04:56:43.322016 [info ] [MainThread]: Finished running 7 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m04:56:43.323014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:56:43.324022 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m04:56:43.325015 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m04:56:43.325015 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m04:56:43.375739 [info ] [MainThread]: 
[0m04:56:43.376693 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m04:56:43.377697 [info ] [MainThread]: 
[0m04:56:43.377697 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleamsed (models\dim\dim_hosts_cleamsed.sql)[0m
[0m04:56:43.378703 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:56:43.378703 [error] [MainThread]:   LINE 9:     NVL(host_name,'Anonymous') AS host_name,
[0m04:56:43.378703 [error] [MainThread]:               ^
[0m04:56:43.379703 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:56:43.379703 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleamsed.sql
[0m04:56:43.379703 [info ] [MainThread]: 
[0m04:56:43.380703 [error] [MainThread]: [33mDatabase Error in model dim_hosts_cleansed (models\dim\dim_hosts_cleansed.sql)[0m
[0m04:56:43.380703 [error] [MainThread]:   function nvl(text, unknown) does not exist
[0m04:56:43.381703 [error] [MainThread]:   LINE 9:     NVL(host_name,'Anonymous') AS host_name,
[0m04:56:43.381703 [error] [MainThread]:               ^
[0m04:56:43.382706 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:56:43.382706 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_hosts_cleansed.sql
[0m04:56:43.382706 [info ] [MainThread]: 
[0m04:56:43.383706 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m04:56:43.383706 [error] [MainThread]:   function replace(text, unknown) does not exist
[0m04:56:43.384704 [error] [MainThread]:   LINE 16:     ROUND( REPLACE(price_str,'$') ,2) AS price,
[0m04:56:43.384704 [error] [MainThread]:                       ^
[0m04:56:43.384704 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m04:56:43.385704 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m04:56:43.385704 [info ] [MainThread]: 
[0m04:56:43.385704 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m04:56:43.386703 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m04:56:43.386703 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m04:56:43.387703 [error] [MainThread]:                              ^
[0m04:56:43.387703 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m04:56:43.387703 [info ] [MainThread]: 
[0m04:56:43.388703 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=1 TOTAL=9
[0m04:56:43.388703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2967D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA29FEB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA2C42770>]}


============================== 2022-08-22 05:01:17.313953 | 51996cf9-3bcd-4df1-a924-20c029cc3236 ==============================
[0m05:01:17.313953 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:01:17.314953 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:01:17.315950 [debug] [MainThread]: Tracking: tracking
[0m05:01:17.364236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19ECCDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19ECCC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19ECCD420>]}
[0m05:01:17.872268 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m05:01:17.873270 [debug] [MainThread]: Partial parsing: deleted file: dbtpostgres://models\dim\dim_hosts_cleamsed.sql
[0m05:01:17.873270 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_hosts_cleansed.sql
[0m05:01:17.873270 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_listings_cleansed.sql
[0m05:01:17.885270 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m05:01:17.897237 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m05:01:17.957238 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m05:01:17.963268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19EF71630>]}
[0m05:01:18.000237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19EF15990>]}
[0m05:01:18.000237 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:01:18.001237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19EF15960>]}
[0m05:01:18.002237 [info ] [MainThread]: 
[0m05:01:18.003238 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:01:18.004237 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:01:18.013240 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:01:18.013240 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:01:18.014240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:01:18.076238 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.06 seconds
[0m05:01:18.077238 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:01:18.079236 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:01:18.085239 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:01:18.085239 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:01:18.085239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:01:18.098238 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.099239 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:01:18.099239 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:01:18.101237 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:01:18.102237 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:01:18.103237 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:01:18.104237 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:01:18.106237 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:01:18.106237 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:01:18.106237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:18.119236 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.119236 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:01:18.119236 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:01:18.122238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m05:01:18.123238 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:01:18.124239 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:01:18.129238 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:18.129238 [debug] [MainThread]: On master: BEGIN
[0m05:01:18.130239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:01:18.142238 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.142238 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:18.143237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:01:18.153238 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m05:01:18.154237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F0183A0>]}
[0m05:01:18.154237 [debug] [MainThread]: On master: ROLLBACK
[0m05:01:18.155239 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:18.155239 [debug] [MainThread]: On master: BEGIN
[0m05:01:18.156795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:01:18.156795 [debug] [MainThread]: On master: COMMIT
[0m05:01:18.156795 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:18.157801 [debug] [MainThread]: On master: COMMIT
[0m05:01:18.157801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:01:18.157801 [debug] [MainThread]: On master: Close
[0m05:01:18.158803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:01:18.158803 [info ] [MainThread]: 
[0m05:01:18.165802 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:01:18.165802 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:01:18.166802 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.166802 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:01:18.166802 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:01:18.169801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:01:18.170802 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.171802 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:01:18.204802 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:01:18.205802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.206804 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:01:18.206804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:01:18.218802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.219803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.219803 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:01:18.221802 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:01:18.226802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.227803 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:01:18.228802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.230803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.231802 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:01:18.232803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.248802 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:01:18.249803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.249803 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:01:18.254804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:01:18.259802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:01:18.259802 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:01:18.262802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:01:18.263802 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.263802 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:01:18.263802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19EF54B80>]}
[0m05:01:18.264803 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m05:01:18.265806 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:01:18.265806 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:01:18.265806 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:01:18.266803 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.266803 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:01:18.266803 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:01:18.269801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:01:18.271803 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.271803 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:01:18.275802 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:01:18.276803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.276803 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:01:18.277804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:18.290802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.290802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.291802 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:01:18.293802 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:01:18.295802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.296802 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:01:18.297802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.299803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.300802 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:01:18.301802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.302803 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:01:18.302803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.302803 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:01:18.305803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:01:18.308803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:01:18.309801 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:01:18.311802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:01:18.312802 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.312802 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:01:18.313803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F0126B0>]}
[0m05:01:18.313803 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m05:01:18.314807 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:01:18.314807 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:01:18.315803 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:01:18.315803 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.316801 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:01:18.316801 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:01:18.318803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:01:18.320803 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.320803 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:01:18.324804 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:01:18.326802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.326802 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:01:18.326802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:18.361805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:01:18.361805 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.361805 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:01:18.364803 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:01:18.367803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.367803 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:01:18.368803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.371801 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.371801 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:01:18.372803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.373802 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:01:18.374801 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.374801 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:01:18.376803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:01:18.379801 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:01:18.379801 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:01:18.381803 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:01:18.382802 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.383803 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:01:18.383803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F112A10>]}
[0m05:01:18.383803 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:01:18.384803 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:01:18.385802 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:01:18.385802 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:01:18.386802 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.386802 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:01:18.386802 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:01:18.389802 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.391803 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.391803 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:01:18.394802 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.396802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.396802 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:01:18.397803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:18.410804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.410804 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.410804 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:01:18.412803 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:01:18.415804 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.416801 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:01:18.417803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:18.418803 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:01:18.418803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.418803 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:01:18.420803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:01:18.422803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:01:18.423802 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:01:18.423802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:01:18.424803 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.425802 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:01:18.425802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F0C0730>]}
[0m05:01:18.425802 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:01:18.426802 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:01:18.426802 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:01:18.427803 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:01:18.427803 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:01:18.428803 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:01:18.428803 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:01:18.431803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:01:18.433803 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.433803 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:01:18.438803 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:01:18.439802 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:01:18.440803 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:01:18.440803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:18.471803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:01:18.471803 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:01:18.471803 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND( REPLACE(price_str,'$', '') ,2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:01:18.473802 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(text, integer) does not exist
LINE 16:     ROUND( REPLACE(price_str,'$', '') ,2) AS price,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:01:18.473802 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m05:01:18.474803 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.474803 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:01:18.474803 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function round(text, integer) does not exist
  LINE 16:     ROUND( REPLACE(price_str,'$', '') ,2) AS price,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m05:01:18.475804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F12AC80>]}
[0m05:01:18.475804 [error] [Thread-1 (]: 5 of 8 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.05s]
[0m05:01:18.476804 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:01:18.476804 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:01:18.477804 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:01:18.477804 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.478803 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:01:18.478803 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:01:18.499803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:01:18.501802 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.501802 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:01:18.532805 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.532805 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp120118520801"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:01:18.532805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:18.675716 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.14 seconds
[0m05:01:18.682448 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.682448 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:01:18.683443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:01:18.684444 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.684444 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120118520801'
        
      order by ordinal_position

  
[0m05:01:18.691060 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:01:18.697405 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.697927 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:01:18.701025 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:01:18.714026 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.715026 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120118520801'
        
      order by ordinal_position

  
[0m05:01:18.719027 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:01:18.721777 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.721777 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:01:18.724778 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:01:18.733924 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:01:18.741146 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:01:18.743147 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.744149 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp120118520801"
    )
  
[0m05:01:18.745150 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:01:18.746147 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:01:18.747145 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:01:18.747145 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:01:18.750600 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:01:18.750600 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.751600 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:01:18.751600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F139210>]}
[0m05:01:18.751600 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.27s]
[0m05:01:18.752601 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:01:18.753601 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:01:18.753601 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m05:01:18.754600 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:01:18.754600 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:01:18.754600 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:01:18.755600 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:01:18.755600 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:01:18.755600 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:01:18.759600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:01:18.761600 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.761600 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:01:18.774601 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:01:18.776600 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:01:18.776600 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:01:18.777483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:18.790545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.790545 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:01:18.790545 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:01:18.791545 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m05:01:18.791545 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:01:18.792546 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:18.792546 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:01:18.793546 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:01:18.793546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51996cf9-3bcd-4df1-a924-20c029cc3236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F12A560>]}
[0m05:01:18.793546 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.04s]
[0m05:01:18.794546 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:01:18.795546 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:01:18.795546 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:18.796546 [debug] [MainThread]: On master: BEGIN
[0m05:01:18.796546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:01:18.809547 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:01:18.809547 [debug] [MainThread]: On master: COMMIT
[0m05:01:18.809547 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:18.810547 [debug] [MainThread]: On master: COMMIT
[0m05:01:18.810547 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:01:18.810547 [debug] [MainThread]: On master: Close
[0m05:01:18.811546 [info ] [MainThread]: 
[0m05:01:18.811546 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m05:01:18.812546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:01:18.812546 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:01:18.812546 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m05:01:18.812546 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:01:18.880580 [info ] [MainThread]: 
[0m05:01:18.880580 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:01:18.881547 [info ] [MainThread]: 
[0m05:01:18.882547 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m05:01:18.882547 [error] [MainThread]:   function round(text, integer) does not exist
[0m05:01:18.883547 [error] [MainThread]:   LINE 16:     ROUND( REPLACE(price_str,'$', '') ,2) AS price,
[0m05:01:18.883547 [error] [MainThread]:                ^
[0m05:01:18.884547 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:01:18.884547 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m05:01:18.884547 [info ] [MainThread]: 
[0m05:01:18.885546 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:01:18.885546 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m05:01:18.885546 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m05:01:18.886546 [error] [MainThread]:                              ^
[0m05:01:18.886546 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:01:18.887547 [info ] [MainThread]: 
[0m05:01:18.887547 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=1 TOTAL=8
[0m05:01:18.887547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F107FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19EF7B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D19F163760>]}


============================== 2022-08-22 05:03:20.656851 | d070bc4d-8a86-421a-b962-0cad7baee4b4 ==============================
[0m05:03:20.656851 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:03:20.657851 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:03:20.657851 [debug] [MainThread]: Tracking: tracking
[0m05:03:20.671851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F2BC760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F2BE080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F2BCD30>]}
[0m05:03:20.825850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:03:20.826850 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_listings_cleansed.sql
[0m05:03:20.837850 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m05:03:20.907850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m05:03:20.914770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F64C0D0>]}
[0m05:03:20.951739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F54BEE0>]}
[0m05:03:20.951739 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:03:20.952740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F5016C0>]}
[0m05:03:20.954773 [info ] [MainThread]: 
[0m05:03:20.954773 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:03:20.956771 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:03:20.964741 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:03:20.965740 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:03:20.965740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:20.996646 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.03 seconds
[0m05:03:20.997648 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:03:20.998647 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:03:21.004646 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:03:21.004646 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:03:21.004646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:21.018940 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.018940 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:03:21.018940 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:03:21.021939 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:03:21.022940 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:03:21.023940 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:03:21.024941 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:03:21.026941 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:03:21.026941 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:03:21.026941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:21.039940 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.040940 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:03:21.040940 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:03:21.042940 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:03:21.043939 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:03:21.044940 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:03:21.050940 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:21.050940 [debug] [MainThread]: On master: BEGIN
[0m05:03:21.051940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:03:21.063940 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.063940 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:21.064940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:03:21.074940 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
[0m05:03:21.075940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F60BA00>]}
[0m05:03:21.075940 [debug] [MainThread]: On master: ROLLBACK
[0m05:03:21.076940 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:21.077940 [debug] [MainThread]: On master: BEGIN
[0m05:03:21.078941 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:03:21.079941 [debug] [MainThread]: On master: COMMIT
[0m05:03:21.079941 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:21.079941 [debug] [MainThread]: On master: COMMIT
[0m05:03:21.080941 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.080941 [debug] [MainThread]: On master: Close
[0m05:03:21.081941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:03:21.081941 [info ] [MainThread]: 
[0m05:03:21.085941 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:03:21.085941 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:03:21.086941 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.086941 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:03:21.087941 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:03:21.089940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:03:21.091940 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.091940 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:03:21.122940 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:03:21.124940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.124940 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:03:21.124940 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:03:21.149940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:03:21.150942 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.150942 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:03:21.152939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:03:21.157939 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.158941 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:03:21.159940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.161939 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.162938 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:03:21.163940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.179940 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:03:21.179940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.179940 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:03:21.182940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.187940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:03:21.187940 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:03:21.190939 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:03:21.191939 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.191939 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:03:21.192940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F54AE00>]}
[0m05:03:21.192940 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m05:03:21.193941 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:03:21.193941 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:03:21.194940 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:03:21.194940 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.195941 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:03:21.195941 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:03:21.198940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:03:21.199939 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.199939 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:03:21.203939 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:03:21.204939 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.205941 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:03:21.205941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:21.243940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:03:21.243940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.243940 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:03:21.245939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:03:21.248940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.248940 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:03:21.249939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.252942 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.252942 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:03:21.253940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.254942 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:03:21.254942 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.254942 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:03:21.257940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.260940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:03:21.260940 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:03:21.262939 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:03:21.263941 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.264941 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:03:21.264941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F6ABE20>]}
[0m05:03:21.264941 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:03:21.265940 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:03:21.266940 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:03:21.266940 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:03:21.267941 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.267941 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:03:21.267941 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:03:21.270939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:03:21.271941 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.271941 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:03:21.275942 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:03:21.276941 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.277940 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:03:21.277940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:21.290940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.291940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.291940 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:03:21.293941 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:03:21.295941 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.296942 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:03:21.297940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.299942 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.300942 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:03:21.301940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.302941 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:03:21.302941 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.303939 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:03:21.305940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.308941 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:03:21.308941 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:03:21.310941 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:03:21.312941 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.312941 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:03:21.312941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F71D990>]}
[0m05:03:21.313941 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:03:21.313941 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:03:21.314943 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:03:21.314943 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:03:21.315942 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.315942 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:03:21.315942 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:03:21.318942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.319943 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.319943 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:03:21.323941 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.325940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.325940 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:03:21.325940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:21.337940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.338942 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.338942 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:03:21.340941 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:03:21.342943 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.343943 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:03:21.344940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:21.345940 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:03:21.345940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.345940 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:03:21.347940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.349943 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:03:21.350943 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:03:21.350943 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:03:21.351942 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.351942 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:03:21.352943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F6D40A0>]}
[0m05:03:21.352943 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:03:21.353944 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:03:21.353944 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:03:21.354943 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:03:21.354943 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:03:21.355942 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:03:21.355942 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:03:21.358941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:03:21.359940 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.360943 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:03:21.364943 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:03:21.366942 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:03:21.366942 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:03:21.366942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:21.379941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.380940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:03:21.380940 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(REPLACE(price_str,'$', ''), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:03:21.381941 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(text, integer) does not exist
LINE 16:     ROUND(REPLACE(price_str,'$', ''), 2) AS price,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:03:21.382940 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: ROLLBACK
[0m05:03:21.382940 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.383943 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:03:21.383943 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)
  function round(text, integer) does not exist
  LINE 16:     ROUND(REPLACE(price_str,'$', ''), 2) AS price,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m05:03:21.383943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F73B790>]}
[0m05:03:21.384946 [error] [Thread-1 (]: 5 of 8 ERROR creating view model dbo.dim_listings_cleansed ..................... [[31mERROR[0m in 0.03s]
[0m05:03:21.385941 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:03:21.385941 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:03:21.385941 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:03:21.386943 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.386943 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:03:21.387944 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:03:21.408943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:03:21.410942 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.410942 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:03:21.441940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.441940 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp120321430940"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:03:21.442941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:21.587940 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.14 seconds
[0m05:03:21.594940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.594940 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:03:21.596447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:03:21.596447 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.596447 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120321430940'
        
      order by ordinal_position

  
[0m05:03:21.602455 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:03:21.608456 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.609457 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:03:21.612454 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:03:21.625453 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.625453 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120321430940'
        
      order by ordinal_position

  
[0m05:03:21.629454 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:03:21.632454 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.632454 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:03:21.635454 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:03:21.644454 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:03:21.653454 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:03:21.654454 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.655454 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp120321430940"
    )
  
[0m05:03:21.656455 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:03:21.657455 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:03:21.658455 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:03:21.658455 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:03:21.660454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.661457 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.661457 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:03:21.661457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F743D30>]}
[0m05:03:21.662458 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.27s]
[0m05:03:21.663455 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:03:21.663455 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:03:21.663455 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m05:03:21.664456 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:03:21.664456 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:03:21.665458 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:03:21.665458 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:03:21.665458 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:03:21.666456 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:03:21.669454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:03:21.671454 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.671454 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:03:21.684455 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:03:21.686454 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:03:21.687455 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:03:21.687455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:21.714454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:03:21.714454 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:03:21.715455 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:03:21.716455 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m05:03:21.716455 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:03:21.717454 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:21.717454 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:03:21.717454 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:03:21.717454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd070bc4d-8a86-421a-b962-0cad7baee4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F63AC50>]}
[0m05:03:21.718455 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.05s]
[0m05:03:21.719455 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:03:21.720455 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:03:21.720455 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:21.720455 [debug] [MainThread]: On master: BEGIN
[0m05:03:21.721455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:03:21.733455 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:03:21.733455 [debug] [MainThread]: On master: COMMIT
[0m05:03:21.733455 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:21.733455 [debug] [MainThread]: On master: COMMIT
[0m05:03:21.734454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:03:21.734454 [debug] [MainThread]: On master: Close
[0m05:03:21.735456 [info ] [MainThread]: 
[0m05:03:21.735456 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m05:03:21.736456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:21.736456 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:03:21.736456 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:03:21.736456 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:03:21.802454 [info ] [MainThread]: 
[0m05:03:21.802454 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m05:03:21.803455 [info ] [MainThread]: 
[0m05:03:21.804454 [error] [MainThread]: [33mDatabase Error in model dim_listings_cleansed (models\dim\dim_listings_cleansed.sql)[0m
[0m05:03:21.804454 [error] [MainThread]:   function round(text, integer) does not exist
[0m05:03:21.805454 [error] [MainThread]:   LINE 16:     ROUND(REPLACE(price_str,'$', ''), 2) AS price,
[0m05:03:21.805454 [error] [MainThread]:                ^
[0m05:03:21.806454 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:03:21.806454 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\dim\dim_listings_cleansed.sql
[0m05:03:21.807454 [info ] [MainThread]: 
[0m05:03:21.807454 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:03:21.808455 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m05:03:21.808455 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m05:03:21.809454 [error] [MainThread]:                              ^
[0m05:03:21.809454 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:03:21.809454 [info ] [MainThread]: 
[0m05:03:21.810455 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=1 TOTAL=8
[0m05:03:21.810455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F585870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F796E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B4F797160>]}


============================== 2022-08-22 05:05:30.831879 | 548057c3-7119-4b04-9fcb-7e4df7b01130 ==============================
[0m05:05:30.831879 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:05:30.832908 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:05:30.832908 [debug] [MainThread]: Tracking: tracking
[0m05:05:30.846877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F2BDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F2BC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F2BD420>]}
[0m05:05:30.995878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:05:30.995878 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\dim\dim_listings_cleansed.sql
[0m05:05:31.007877 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m05:05:31.074908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m05:05:31.081880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6480D0>]}
[0m05:05:31.127880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F547F10>]}
[0m05:05:31.128879 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:05:31.128879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F5016F0>]}
[0m05:05:31.130878 [info ] [MainThread]: 
[0m05:05:31.130878 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:05:31.132878 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:05:31.140878 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:05:31.141879 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:05:31.141879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:31.166878 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.02 seconds
[0m05:05:31.167878 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:05:31.168877 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:05:31.174879 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:05:31.174879 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:05:31.174879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:05:31.187880 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.187880 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:05:31.187880 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:05:31.190878 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:05:31.191879 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:05:31.192877 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:05:31.192877 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:05:31.194880 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:05:31.194880 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:05:31.195880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:05:31.208172 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.208172 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:05:31.208172 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:05:31.210172 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:05:31.211172 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:05:31.212172 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:05:31.217171 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:31.217171 [debug] [MainThread]: On master: BEGIN
[0m05:05:31.218173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:05:31.231171 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.231171 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:31.231171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:05:31.241172 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
[0m05:05:31.242171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F60FD60>]}
[0m05:05:31.243171 [debug] [MainThread]: On master: ROLLBACK
[0m05:05:31.244171 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:31.244171 [debug] [MainThread]: On master: BEGIN
[0m05:05:31.246172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:05:31.246172 [debug] [MainThread]: On master: COMMIT
[0m05:05:31.246172 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:31.246172 [debug] [MainThread]: On master: COMMIT
[0m05:05:31.247171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.247171 [debug] [MainThread]: On master: Close
[0m05:05:31.247171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:05:31.248172 [info ] [MainThread]: 
[0m05:05:31.251173 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:05:31.252172 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:05:31.252172 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.252172 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:05:31.253171 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:05:31.255171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:05:31.257172 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.257172 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:05:31.288173 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:05:31.290205 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.290205 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:05:31.290205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:05:31.303934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.304933 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.304933 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:05:31.305933 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:05:31.311963 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.311963 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:05:31.313935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.315932 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.315932 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:05:31.317934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.333933 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:05:31.333933 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.333933 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:05:31.337970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.342963 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:05:31.342963 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:05:31.346937 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:05:31.347964 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.347964 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:05:31.347964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F546E90>]}
[0m05:05:31.348935 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m05:05:31.349933 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:05:31.349933 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:05:31.349933 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:05:31.350933 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.350933 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:05:31.350933 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:05:31.353932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:05:31.355932 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.355932 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:05:31.359932 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:05:31.360964 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.360964 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:05:31.361963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.374570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.375569 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.375569 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:05:31.377569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:05:31.379569 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.380569 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:05:31.381131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.384139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.384139 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:05:31.384897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.386901 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:05:31.386901 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.386901 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:05:31.389145 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.392149 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:05:31.392149 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:05:31.394149 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:05:31.395149 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.396149 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:05:31.396149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6AC1F0>]}
[0m05:05:31.396149 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m05:05:31.397150 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:05:31.397150 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:05:31.398149 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:05:31.399150 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.399150 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:05:31.399150 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:05:31.402150 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:05:31.403149 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.403149 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:05:31.407149 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:05:31.409151 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.409151 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:05:31.409151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.421871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.422852 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.422852 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:05:31.424854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:05:31.427853 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.427853 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:05:31.428854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.431852 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.431852 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:05:31.432604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.434610 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:05:31.434610 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.434610 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:05:31.436885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.439894 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:05:31.439894 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:05:31.441898 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:05:31.442904 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.443903 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:05:31.443903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F71D9C0>]}
[0m05:05:31.443903 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:05:31.444906 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:05:31.445903 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:05:31.445903 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:05:31.446903 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.446903 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:05:31.446903 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:05:31.449845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.450846 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.450846 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:05:31.454844 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.457148 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.457148 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:05:31.458155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.471157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.471157 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.471157 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:05:31.473154 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:05:31.476153 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.476153 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:05:31.477154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.478154 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:05:31.479153 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.479153 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:05:31.480592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.482599 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:05:31.483597 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:05:31.483597 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:05:31.484597 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.485598 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:05:31.485598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6D9E70>]}
[0m05:05:31.486600 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:05:31.486600 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:05:31.487603 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:05:31.487603 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:05:31.488601 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.488601 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:05:31.488601 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:05:31.491597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.493598 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.493598 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:05:31.497598 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.499597 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.499597 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:05:31.500598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.513598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.513598 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.513598 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:05:31.516597 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:05:31.519599 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.519599 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:05:31.521599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.522598 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:05:31.522598 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.522598 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:05:31.524598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.526597 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:05:31.526597 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:05:31.527599 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:05:31.528597 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.528597 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:05:31.529598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F60DE40>]}
[0m05:05:31.529598 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:05:31.530598 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:05:31.530598 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:05:31.531597 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:05:31.531597 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.531597 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:05:31.532597 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:05:31.554597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:05:31.556597 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.556597 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:05:31.588597 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.588597 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp120531577597"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:05:31.588597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.704683 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.12 seconds
[0m05:05:31.711686 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.711686 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:05:31.712653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:05:31.713664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.713664 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120531577597'
        
      order by ordinal_position

  
[0m05:05:31.718685 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:05:31.723687 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.723687 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:05:31.727651 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:05:31.739684 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.739684 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120531577597'
        
      order by ordinal_position

  
[0m05:05:31.742770 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:05:31.745776 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.745776 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:05:31.748913 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:05:31.756943 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:05:31.763943 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:05:31.764945 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.765914 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp120531577597"
    )
  
[0m05:05:31.767163 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:05:31.768173 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:05:31.768173 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:05:31.769172 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:05:31.771168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.772172 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.772172 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:05:31.772172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F73D240>]}
[0m05:05:31.773172 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.24s]
[0m05:05:31.774000 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:05:31.774000 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:05:31.775006 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:05:31.775006 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.775006 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:05:31.776005 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:05:31.805011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.807037 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.808007 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:05:31.811006 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.813007 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.813007 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:05:31.813007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.845006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:05:31.845006 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.845006 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:05:31.848006 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:05:31.850005 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.851006 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:05:31.852039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:05:31.853036 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:05:31.853036 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.854039 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:05:31.856050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.858037 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:05:31.858037 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:05:31.859007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:05:31.859007 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.860036 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:05:31.860036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F756D10>]}
[0m05:05:31.860036 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.09s]
[0m05:05:31.861006 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:05:31.861006 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:05:31.862007 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:05:31.862007 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:05:31.862007 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:05:31.863005 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:05:31.866004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:05:31.867005 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.868010 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:05:31.880036 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:05:31.882537 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:05:31.882537 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:05:31.882537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:05:31.907458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:05:31.907458 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:05:31.907458 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:05:31.908458 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                           ^

[0m05:05:31.909458 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:05:31.909458 [debug] [Thread-1 (]: finished collecting timing info
[0m05:05:31.910458 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:05:31.910458 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:05:31.910458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '548057c3-7119-4b04-9fcb-7e4df7b01130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6E23E0>]}
[0m05:05:31.911461 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.05s]
[0m05:05:31.912458 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:05:31.913459 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:05:31.913459 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:31.913459 [debug] [MainThread]: On master: BEGIN
[0m05:05:31.913459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:05:31.926458 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:05:31.926458 [debug] [MainThread]: On master: COMMIT
[0m05:05:31.926458 [debug] [MainThread]: Using postgres connection "master"
[0m05:05:31.926458 [debug] [MainThread]: On master: COMMIT
[0m05:05:31.927458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:05:31.927458 [debug] [MainThread]: On master: Close
[0m05:05:31.928459 [info ] [MainThread]: 
[0m05:05:31.928459 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m05:05:31.929460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:05:31.929460 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:05:31.929460 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:05:31.929460 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:05:31.967458 [info ] [MainThread]: 
[0m05:05:31.967458 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:05:31.968460 [info ] [MainThread]: 
[0m05:05:31.969460 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:05:31.969460 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m05:05:31.970458 [error] [MainThread]:   LINE 13:     SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
[0m05:05:31.970458 [error] [MainThread]:                              ^
[0m05:05:31.971458 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:05:31.971458 [info ] [MainThread]: 
[0m05:05:31.972458 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:05:31.972458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6E1DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6E3A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002179F6E03D0>]}


============================== 2022-08-22 05:08:19.172451 | 42cc4cf2-1777-4834-9d1d-f1014c861d95 ==============================
[0m05:08:19.172451 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:08:19.172451 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m05:08:19.173454 [debug] [MainThread]: Tracking: tracking
[0m05:08:19.186452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A79213EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A79213ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A79213DD80>]}
[0m05:08:19.337451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:19.337451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:19.338452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m05:08:19.345451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42cc4cf2-1777-4834-9d1d-f1014c861d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A79240C0D0>]}
[0m05:08:19.381452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42cc4cf2-1777-4834-9d1d-f1014c861d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7923D4160>]}
[0m05:08:19.382451 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:08:19.382451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42cc4cf2-1777-4834-9d1d-f1014c861d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7923D42E0>]}
[0m05:08:19.383451 [info ] [MainThread]: 
[0m05:08:19.384451 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:08:19.385450 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:08:19.395451 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:08:19.395451 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:08:19.395451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:19.412450 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.02 seconds
[0m05:08:19.413452 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:08:19.415454 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:08:19.422451 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:08:19.422451 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:08:19.422451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:19.438454 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:08:19.438454 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:08:19.438454 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:08:19.443452 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:08:19.444453 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:08:19.445455 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:08:19.445455 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:08:19.448452 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:08:19.448452 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:08:19.448452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:19.461456 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:08:19.465451 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:08:19.465451 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:08:19.467452 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m05:08:19.469451 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:08:19.469451 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:08:19.474450 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:19.474450 [debug] [MainThread]: On master: BEGIN
[0m05:08:19.474450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:08:19.487452 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:08:19.487452 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:19.487452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:08:19.502450 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:08:19.503450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42cc4cf2-1777-4834-9d1d-f1014c861d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7923CB5B0>]}
[0m05:08:19.504452 [debug] [MainThread]: On master: ROLLBACK
[0m05:08:19.504452 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:19.505453 [debug] [MainThread]: On master: BEGIN
[0m05:08:19.506456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:08:19.506456 [debug] [MainThread]: On master: COMMIT
[0m05:08:19.506456 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:19.506456 [debug] [MainThread]: On master: COMMIT
[0m05:08:19.507452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:19.507452 [debug] [MainThread]: On master: Close
[0m05:08:19.508451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:08:19.508451 [info ] [MainThread]: 
[0m05:08:19.512451 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m05:08:19.512451 [info ] [Thread-1 (]: 1 of 1 START seed file dbo.seed_full_moon_dates ................................ [RUN]
[0m05:08:19.513451 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:08:19.513451 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m05:08:19.513451 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:19.513451 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m05:08:19.556452 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:08:19.557452 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: BEGIN
[0m05:08:19.557452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:08:19.577450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:08:19.578451 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:08:19.578451 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "seed.dbtpostgres.seed_full_moon_dates"} */

    create table "airbnb"."dbo"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m05:08:19.580453 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m05:08:19.635452 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:08:19.636452 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: 
          insert into "airbnb"."dbo"."seed_full_moon_dates" ("full_moon_date") values
          (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),...
[0m05:08:19.640453 [debug] [Thread-1 (]: SQL status: INSERT 0 272 in 0.0 seconds
[0m05:08:19.646451 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m05:08:19.668451 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: COMMIT
[0m05:08:19.668451 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:08:19.668451 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: COMMIT
[0m05:08:19.671452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:08:19.671452 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:19.671452 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: Close
[0m05:08:19.672452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42cc4cf2-1777-4834-9d1d-f1014c861d95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A79256E2F0>]}
[0m05:08:19.672452 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbo.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 0.16s]
[0m05:08:19.673452 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m05:08:19.674451 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:08:19.674451 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:19.674451 [debug] [MainThread]: On master: BEGIN
[0m05:08:19.675451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:08:19.688452 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:08:19.688452 [debug] [MainThread]: On master: COMMIT
[0m05:08:19.688452 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:19.688452 [debug] [MainThread]: On master: COMMIT
[0m05:08:19.689452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:19.689452 [debug] [MainThread]: On master: Close
[0m05:08:19.690451 [info ] [MainThread]: 
[0m05:08:19.690451 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m05:08:19.691452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:08:19.691452 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:08:19.691452 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m05:08:19.691452 [debug] [MainThread]: Connection 'seed.dbtpostgres.seed_full_moon_dates' was properly closed.
[0m05:08:19.729451 [info ] [MainThread]: 
[0m05:08:19.729451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:08:19.730452 [info ] [MainThread]: 
[0m05:08:19.730452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:08:19.731452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7925782E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A792578160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A792579120>]}


============================== 2022-08-22 05:08:35.292813 | 4abb44b4-d48a-47e4-9505-af83ae21f6a8 ==============================
[0m05:08:35.292813 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:08:35.293813 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:08:35.293813 [debug] [MainThread]: Tracking: tracking
[0m05:08:35.308814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BA9EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BA9ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BA9DD80>]}
[0m05:08:35.457816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:08:35.457816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:08:35.457816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres.dim
- models.dbt_postgres

[0m05:08:35.464814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BD6C0D0>]}
[0m05:08:35.500814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BD34160>]}
[0m05:08:35.500814 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:08:35.501814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BD342E0>]}
[0m05:08:35.502815 [info ] [MainThread]: 
[0m05:08:35.504177 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:08:35.505237 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:08:35.514244 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:08:35.514244 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:08:35.514244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:35.542504 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.03 seconds
[0m05:08:35.543503 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:08:35.544503 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:08:35.550501 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:08:35.550501 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:08:35.550501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:35.565358 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:08:35.565358 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:08:35.565358 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:08:35.568359 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:08:35.569359 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:08:35.569359 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:08:35.570358 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:08:35.572359 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:08:35.572359 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:08:35.572359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:35.585045 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:08:35.585045 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:08:35.585045 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:08:35.588051 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:08:35.589059 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:08:35.589059 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:08:35.594055 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:35.594055 [debug] [MainThread]: On master: BEGIN
[0m05:08:35.594055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:08:35.617210 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m05:08:35.617210 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:35.617210 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:08:35.630117 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:08:35.631123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BD24FD0>]}
[0m05:08:35.631123 [debug] [MainThread]: On master: ROLLBACK
[0m05:08:35.632123 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:35.632123 [debug] [MainThread]: On master: BEGIN
[0m05:08:35.634017 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:08:35.634017 [debug] [MainThread]: On master: COMMIT
[0m05:08:35.634017 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:35.635023 [debug] [MainThread]: On master: COMMIT
[0m05:08:35.635023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:35.636022 [debug] [MainThread]: On master: Close
[0m05:08:35.636022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:08:35.637022 [info ] [MainThread]: 
[0m05:08:35.640223 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:08:35.640223 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:08:35.641229 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.641229 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:08:35.641229 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:08:35.645227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:08:35.646228 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.646228 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:08:35.678262 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:08:35.680259 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.681236 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:08:35.681236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:08:35.710167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:08:35.710167 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.710167 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:08:35.712170 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:08:35.718168 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.718168 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:08:35.719168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.722198 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.722198 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:08:35.723168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.738167 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:08:35.739168 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.739168 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:08:35.742169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:08:35.747168 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:08:35.748168 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:08:35.751808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:35.752811 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.752811 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:08:35.753808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BE9E3E0>]}
[0m05:08:35.753808 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m05:08:35.754808 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:08:35.754808 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:08:35.755806 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:08:35.756805 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.756805 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:08:35.756805 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:08:35.759805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:08:35.760806 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.761805 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:08:35.765805 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:08:35.766805 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.767805 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:08:35.767805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:35.803397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:08:35.803397 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.803397 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:08:35.805429 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:08:35.808398 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.808398 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:08:35.809399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.811398 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.812398 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:08:35.812792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.813828 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:08:35.814828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.814828 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:08:35.816796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:08:35.818798 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:08:35.818798 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:08:35.821506 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:35.822504 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.822504 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:08:35.823505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BE9E590>]}
[0m05:08:35.823505 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:08:35.824505 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:08:35.824505 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:08:35.824505 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:08:35.825503 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.825503 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:08:35.825503 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:08:35.829503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:08:35.831504 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.831504 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:08:35.834503 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:08:35.836503 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.836503 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:08:35.836503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:35.849541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:08:35.849541 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.850547 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:08:35.851547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:08:35.854548 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.854548 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:08:35.855547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.858545 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.858545 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:08:35.859546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.860546 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:08:35.860546 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.861546 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:08:35.863547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:08:35.864547 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:08:35.865545 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:08:35.867116 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:35.868121 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.868121 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:08:35.869120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BEC8CD0>]}
[0m05:08:35.869120 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:08:35.870122 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:08:35.870122 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:08:35.871121 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:08:35.872120 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.872120 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:08:35.872120 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:08:35.875121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.879128 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.880127 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:08:35.889128 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.893474 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.894526 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:08:35.895539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:35.954113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m05:08:35.955117 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.956116 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:08:35.962476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m05:08:35.970440 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.971472 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:08:35.974473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:35.978439 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:08:35.979442 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.980442 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:08:35.986510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:08:35.992509 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:08:35.993554 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:08:35.997500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:35.998504 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:35.999500 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:08:36.000497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BF04880>]}
[0m05:08:36.000497 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m05:08:36.002501 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:08:36.003500 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:08:36.003500 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:08:36.004859 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.004859 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:08:36.005902 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:08:36.010904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.013910 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.014955 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:08:36.021928 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.024993 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.026023 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:08:36.026023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:36.071086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m05:08:36.072117 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.073117 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:08:36.083129 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m05:08:36.099162 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.100159 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:08:36.104160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:36.110159 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:08:36.111161 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.112207 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:08:36.118539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:08:36.122571 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:08:36.122571 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:08:36.124535 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:36.126568 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.127533 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:08:36.127533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BED4460>]}
[0m05:08:36.128534 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m05:08:36.130534 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:08:36.130534 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:08:36.131540 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:08:36.132535 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.133532 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:08:36.133532 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:08:36.162562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:08:36.163563 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.164533 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:08:36.195562 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.196562 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp120836184564"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:08:36.196562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:36.331544 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.13 seconds
[0m05:08:36.338544 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.339575 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:08:36.340544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:08:36.340544 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.340544 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120836184564'
        
      order by ordinal_position

  
[0m05:08:36.346544 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:08:36.350573 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.351575 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:08:36.354576 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:08:36.366575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.366575 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp120836184564'
        
      order by ordinal_position

  
[0m05:08:36.369573 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:08:36.372574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.372574 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:08:36.375575 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:08:36.383574 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:08:36.390580 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:08:36.392521 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.392521 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp120836184564"
    )
  
[0m05:08:36.393575 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:08:36.395613 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:08:36.395613 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:08:36.395613 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:08:36.397580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:08:36.398580 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.398580 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:08:36.399582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BDDAF50>]}
[0m05:08:36.399582 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.27s]
[0m05:08:36.400580 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:08:36.400580 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:08:36.401581 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:08:36.401581 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.402581 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:08:36.402581 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:08:36.405581 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.406581 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.407581 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:08:36.411580 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.413644 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.413644 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:08:36.413644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:36.426651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:08:36.427650 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.427650 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:08:36.430651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:08:36.433648 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.433648 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:08:36.434664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:36.435701 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:08:36.435701 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.435701 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:08:36.438404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:08:36.440401 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:08:36.440401 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:08:36.441402 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:08:36.442403 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.442403 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:08:36.442403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BDFC0A0>]}
[0m05:08:36.443402 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:08:36.443402 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:08:36.444403 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:08:36.444403 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:08:36.445403 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:08:36.445403 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:08:36.445403 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:08:36.449404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:08:36.450402 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.451403 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:08:36.462431 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:08:36.465404 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:08:36.465404 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:08:36.465404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:36.506330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:08:36.506330 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:08:36.507326 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:08:36.509322 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function to_date(text) does not exist
LINE 27:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moo...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:08:36.509322 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:08:36.511322 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:36.511322 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:08:36.512325 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function to_date(text) does not exist
  LINE 27:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moo...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:08:36.512325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4abb44b4-d48a-47e4-9505-af83ae21f6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BFB9240>]}
[0m05:08:36.513326 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.07s]
[0m05:08:36.514321 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:08:36.515323 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:08:36.515323 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:36.516322 [debug] [MainThread]: On master: BEGIN
[0m05:08:36.516322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:08:36.535123 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m05:08:36.535123 [debug] [MainThread]: On master: COMMIT
[0m05:08:36.535123 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:36.536117 [debug] [MainThread]: On master: COMMIT
[0m05:08:36.536117 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:36.537118 [debug] [MainThread]: On master: Close
[0m05:08:36.537118 [info ] [MainThread]: 
[0m05:08:36.538119 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m05:08:36.538119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:08:36.538119 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:08:36.538119 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:08:36.539118 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:08:36.578118 [info ] [MainThread]: 
[0m05:08:36.578118 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:08:36.579118 [info ] [MainThread]: 
[0m05:08:36.580117 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:08:36.580117 [error] [MainThread]:   function to_date(text) does not exist
[0m05:08:36.581117 [error] [MainThread]:   LINE 27:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moo...
[0m05:08:36.581117 [error] [MainThread]:                    ^
[0m05:08:36.582117 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:08:36.582117 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:08:36.582117 [info ] [MainThread]: 
[0m05:08:36.583118 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:08:36.583118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BD27D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BE4D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A45BE4DB70>]}


============================== 2022-08-22 05:10:30.146136 | e73e1385-1b67-4ac9-b115-a0e4348995a2 ==============================
[0m05:10:30.146136 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:10:30.147138 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:10:30.147138 [debug] [MainThread]: Tracking: tracking
[0m05:10:30.161136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1423AEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1423AECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1423ADD80>]}
[0m05:10:30.312137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:10:30.312137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:10:30.313137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src

[0m05:10:30.320137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14267C0D0>]}
[0m05:10:30.359137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C142644160>]}
[0m05:10:30.359137 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:10:30.360137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1426442E0>]}
[0m05:10:30.361136 [info ] [MainThread]: 
[0m05:10:30.362137 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:10:30.364138 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:10:30.373137 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:10:30.374137 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:10:30.374137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:30.412138 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.04 seconds
[0m05:10:30.413137 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:10:30.415138 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:10:30.420137 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:10:30.421137 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:10:30.421137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:30.455138 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:10:30.455138 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:10:30.456137 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:10:30.458137 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:10:30.459138 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:10:30.460139 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:10:30.460139 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:10:30.463137 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:10:30.463137 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:10:30.463137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:10:30.476137 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:10:30.476137 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:10:30.476137 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:10:30.479137 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:10:30.480137 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:10:30.481136 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:10:30.486137 [debug] [MainThread]: Using postgres connection "master"
[0m05:10:30.486137 [debug] [MainThread]: On master: BEGIN
[0m05:10:30.486137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:10:30.498136 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:10:30.499137 [debug] [MainThread]: Using postgres connection "master"
[0m05:10:30.499137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:10:30.512137 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:10:30.513137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C142634FD0>]}
[0m05:10:30.513137 [debug] [MainThread]: On master: ROLLBACK
[0m05:10:30.514137 [debug] [MainThread]: Using postgres connection "master"
[0m05:10:30.514137 [debug] [MainThread]: On master: BEGIN
[0m05:10:30.516138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:10:30.516138 [debug] [MainThread]: On master: COMMIT
[0m05:10:30.516138 [debug] [MainThread]: Using postgres connection "master"
[0m05:10:30.516138 [debug] [MainThread]: On master: COMMIT
[0m05:10:30.517136 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:10:30.517136 [debug] [MainThread]: On master: Close
[0m05:10:30.518347 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:10:30.518347 [info ] [MainThread]: 
[0m05:10:30.522137 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:10:30.522137 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:10:30.523138 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.523138 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:10:30.523138 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:10:30.527137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:10:30.528137 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.529138 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:10:30.561137 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:10:30.563137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.563137 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:10:30.563137 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:10:30.596138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:10:30.596138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.596138 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:10:30.598138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:10:30.604139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.605139 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:10:30.606138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.608139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.609139 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:10:30.610137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.625137 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:10:30.626137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.626137 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:10:30.632138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:10:30.638136 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:10:30.638136 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:10:30.642136 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:10:30.643140 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.643140 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:10:30.643140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1427AE590>]}
[0m05:10:30.644140 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m05:10:30.645138 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:10:30.645138 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:10:30.646138 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:10:30.646138 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.646138 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:10:30.647137 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:10:30.649138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:10:30.651136 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.651136 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:10:30.655137 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:10:30.656137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.657138 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:10:30.657138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:30.688139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:10:30.688139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.689139 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:10:30.691138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:10:30.693137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.694137 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:10:30.695138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.697140 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.698140 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:10:30.699137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.700137 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:10:30.700137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.700137 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:10:30.703137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:10:30.705137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:10:30.705137 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:10:30.707137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:10:30.709138 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.709138 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:10:30.709138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1427AEE90>]}
[0m05:10:30.710138 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.06s]
[0m05:10:30.710138 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:10:30.711140 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:10:30.711140 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:10:30.712138 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.712138 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:10:30.712138 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:10:30.715137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:10:30.717137 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.717137 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:10:30.721139 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:10:30.722139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.723137 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:10:30.723137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:30.752138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:10:30.752138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.752138 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:10:30.754137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:10:30.757138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.757138 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:10:30.758139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.761137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.761137 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:10:30.762137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.764138 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:10:30.764138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.764138 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:10:30.769137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:10:30.771137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:10:30.771137 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:10:30.774138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:10:30.775137 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.775137 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:10:30.775137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1427D8CD0>]}
[0m05:10:30.776137 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:10:30.777138 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:10:30.777138 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:10:30.777138 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:10:30.778137 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.778137 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:10:30.778137 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:10:30.782138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.784137 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.784137 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:10:30.789136 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.790138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.791137 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:10:30.791137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:30.804138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:10:30.804138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.804138 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:10:30.806137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:10:30.809137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.809137 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:10:30.810138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.811138 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:10:30.811138 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.812137 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:10:30.814137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:10:30.816137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:10:30.816137 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:10:30.817138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:10:30.818140 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.818140 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:10:30.818140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C142814880>]}
[0m05:10:30.819140 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:10:30.820138 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:10:30.820138 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:10:30.820138 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:10:30.821140 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.821140 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:10:30.821140 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:10:30.824137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.825136 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.826139 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:10:30.829139 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.831137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.831137 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:10:30.831137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:30.844139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:10:30.845140 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.845140 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:10:30.847137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:10:30.851137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.852138 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:10:30.853141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:30.854139 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:10:30.855139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.855139 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:10:30.860139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:10:30.862139 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:10:30.862139 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:10:30.863137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:10:30.864139 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.865138 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:10:30.865138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1427E4460>]}
[0m05:10:30.865138 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:10:30.867138 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:10:30.867138 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:10:30.868141 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:10:30.868141 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:30.869138 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:10:30.869138 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:10:30.890137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:10:30.891137 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:30.892139 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:10:30.924137 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:30.924137 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp121030911137"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:10:30.924137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:31.093676 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.17 seconds
[0m05:10:31.101677 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.101677 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:10:31.102677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:10:31.103675 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.103675 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp121030911137'
        
      order by ordinal_position

  
[0m05:10:31.110675 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:10:31.115675 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.115675 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:10:31.120675 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:10:31.133675 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.133675 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp121030911137'
        
      order by ordinal_position

  
[0m05:10:31.136676 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:10:31.139678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.139678 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:10:31.142675 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:10:31.150675 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:10:31.157674 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:10:31.159675 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.159675 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp121030911137"
    )
  
[0m05:10:31.160677 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:10:31.162678 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:10:31.162678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:10:31.162678 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:10:31.165675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:10:31.165675 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:31.165675 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:10:31.166679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1426EAF50>]}
[0m05:10:31.166679 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.30s]
[0m05:10:31.167677 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:10:31.167677 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:10:31.168676 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:10:31.168676 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.169676 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:10:31.169676 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:10:31.172675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.174677 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:31.174677 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:10:31.178675 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.180674 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.181677 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:10:31.181677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:31.194674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:10:31.194674 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.194674 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:10:31.197678 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:10:31.200674 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.200674 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:10:31.201676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:10:31.202678 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:10:31.202678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.202678 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:10:31.204676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:10:31.206677 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:10:31.207677 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:10:31.208677 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:10:31.209678 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:31.209678 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:10:31.209678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14270C0A0>]}
[0m05:10:31.209678 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:10:31.211675 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:10:31.211675 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:10:31.211675 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:10:31.212678 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:10:31.212678 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:10:31.212678 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:10:31.215674 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:10:31.217712 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:31.217712 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:10:31.228707 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:10:31.231676 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:10:31.231676 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:10:31.231676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:10:31.244677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:10:31.244677 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:10:31.245679 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:10:31.246677 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function to_date(text) does not exist
LINE 27:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moo...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:10:31.246677 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:10:31.247677 [debug] [Thread-1 (]: finished collecting timing info
[0m05:10:31.247677 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:10:31.247677 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function to_date(text) does not exist
  LINE 27:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moo...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:10:31.248679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73e1385-1b67-4ac9-b115-a0e4348995a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1428CD240>]}
[0m05:10:31.248679 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.04s]
[0m05:10:31.249677 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:10:31.250677 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:10:31.250677 [debug] [MainThread]: Using postgres connection "master"
[0m05:10:31.250677 [debug] [MainThread]: On master: BEGIN
[0m05:10:31.250677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:10:31.263675 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:10:31.263675 [debug] [MainThread]: On master: COMMIT
[0m05:10:31.263675 [debug] [MainThread]: Using postgres connection "master"
[0m05:10:31.263675 [debug] [MainThread]: On master: COMMIT
[0m05:10:31.264676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:10:31.264676 [debug] [MainThread]: On master: Close
[0m05:10:31.265675 [info ] [MainThread]: 
[0m05:10:31.265675 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m05:10:31.265675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:31.266677 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:10:31.266677 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:10:31.266677 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:10:31.304675 [info ] [MainThread]: 
[0m05:10:31.305676 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:10:31.306675 [info ] [MainThread]: 
[0m05:10:31.306675 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:10:31.307677 [error] [MainThread]:   function to_date(text) does not exist
[0m05:10:31.308676 [error] [MainThread]:   LINE 27:     ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moo...
[0m05:10:31.308676 [error] [MainThread]:                    ^
[0m05:10:31.308676 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:10:31.309675 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:10:31.309675 [info ] [MainThread]: 
[0m05:10:31.309675 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:10:31.310674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C142637D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14275D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C14275DB70>]}


============================== 2022-08-22 05:12:05.543856 | 879d4b9a-22f3-4525-be55-79dcee3c15a9 ==============================
[0m05:12:05.543856 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:12:05.543856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:12:05.544855 [debug] [MainThread]: Tracking: tracking
[0m05:12:05.558857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E67C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E67E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E67CD30>]}
[0m05:12:05.714855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:12:05.715855 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:12:05.731855 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:12:05.755856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m05:12:05.761857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E949870>]}
[0m05:12:05.797855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E907EE0>]}
[0m05:12:05.798857 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:12:05.798857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E8C5990>]}
[0m05:12:05.800856 [info ] [MainThread]: 
[0m05:12:05.800856 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:12:05.802855 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:12:05.810855 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:12:05.810855 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:12:05.811856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:05.848856 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.04 seconds
[0m05:12:05.849856 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:12:05.851858 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:12:05.857856 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:12:05.858857 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:12:05.858857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:05.873856 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:12:05.873856 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:12:05.873856 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:12:05.876856 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:12:05.877855 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:12:05.878859 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:12:05.879856 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:12:05.881857 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:12:05.882855 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:12:05.882855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:05.894856 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:12:05.895855 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:12:05.895855 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:12:05.897856 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:12:05.898856 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:12:05.899856 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:12:05.904856 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:05.905856 [debug] [MainThread]: On master: BEGIN
[0m05:12:05.905856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:12:05.917856 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:12:05.918856 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:05.918856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:12:05.931856 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:12:05.932856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E9A75E0>]}
[0m05:12:05.932856 [debug] [MainThread]: On master: ROLLBACK
[0m05:12:05.933855 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:05.934855 [debug] [MainThread]: On master: BEGIN
[0m05:12:05.935858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:12:05.935858 [debug] [MainThread]: On master: COMMIT
[0m05:12:05.935858 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:05.935858 [debug] [MainThread]: On master: COMMIT
[0m05:12:05.936856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:12:05.936856 [debug] [MainThread]: On master: Close
[0m05:12:05.937855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:12:05.937855 [info ] [MainThread]: 
[0m05:12:05.941856 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:12:05.941856 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:12:05.942856 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:05.942856 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:12:05.942856 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:12:05.945856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:12:05.946856 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:05.947858 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:12:05.978856 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:12:05.980855 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:05.980855 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:12:05.980855 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:12:06.004858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:12:06.005856 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:06.005856 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:12:06.007857 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:12:06.013858 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:06.013858 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:12:06.014855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.017857 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:06.018858 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:12:06.019856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.034858 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:12:06.035858 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:06.035858 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:12:06.037886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.042859 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:12:06.042859 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:12:06.046857 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:12:06.047860 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.047860 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:12:06.047860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E9F3640>]}
[0m05:12:06.048860 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m05:12:06.049856 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:12:06.049856 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:12:06.049856 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:12:06.050859 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.050859 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:12:06.050859 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:12:06.053887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:12:06.055887 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.055887 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:12:06.059856 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:12:06.060856 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.060856 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:12:06.061886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.085855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:12:06.085855 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.085855 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:12:06.087857 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:12:06.091858 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.091858 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:12:06.092857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.096857 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.096857 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:12:06.097856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.099856 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:12:06.099856 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.099856 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:12:06.101868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.103858 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:12:06.103858 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:12:06.106856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:12:06.107858 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.107858 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:12:06.107858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EA545B0>]}
[0m05:12:06.108858 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.06s]
[0m05:12:06.108858 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:12:06.109859 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:12:06.109859 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:12:06.110856 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.110856 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:12:06.110856 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:12:06.113856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:12:06.114855 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.114855 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:12:06.118855 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:12:06.120371 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.120371 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:12:06.120371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.146664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:12:06.146664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.146664 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:12:06.148664 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:12:06.151664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.151664 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:12:06.152663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.155663 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.155663 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:12:06.156663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.157663 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:12:06.157663 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.157663 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:12:06.159663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.162663 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:12:06.162663 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:12:06.165664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:12:06.166663 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.166663 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:12:06.166663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EA62CB0>]}
[0m05:12:06.167664 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:12:06.168665 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:12:06.168665 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:12:06.168665 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:12:06.169665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.169665 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:12:06.170664 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:12:06.172663 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.174663 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.174663 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:12:06.177664 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.179664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.179664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:12:06.180663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.193664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:12:06.193664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.193664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:12:06.195667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:12:06.198669 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.198669 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:12:06.199665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.201664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:12:06.201664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.201664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:12:06.203674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.205662 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:12:06.205662 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:12:06.206664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:12:06.207663 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.207663 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:12:06.207663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EAD0A60>]}
[0m05:12:06.208663 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:12:06.208663 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:12:06.209665 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:12:06.209665 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:12:06.210663 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.210663 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:12:06.210663 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:12:06.214666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.216664 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.216664 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:12:06.219664 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.221663 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.221663 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:12:06.221663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.235665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:12:06.235665 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.235665 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:12:06.238664 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:12:06.241664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.241664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:12:06.242664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.243663 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:12:06.244664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.244664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:12:06.246664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.248664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:12:06.248664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:12:06.249663 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:12:06.250664 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.250664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:12:06.251664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22E9A6CE0>]}
[0m05:12:06.251664 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:12:06.252668 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:12:06.252668 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:12:06.253666 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:12:06.254664 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.254664 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:12:06.254664 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:12:06.275702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:12:06.277671 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.277671 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:12:06.310704 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.310704 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp121206298714"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:12:06.310704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.463582 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.15 seconds
[0m05:12:06.470628 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.470628 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:12:06.472575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:12:06.472575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.472575 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp121206298714'
        
      order by ordinal_position

  
[0m05:12:06.481576 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:12:06.486575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.486575 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:12:06.489577 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:12:06.501575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.502625 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp121206298714'
        
      order by ordinal_position

  
[0m05:12:06.505579 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:12:06.508575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.508575 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:12:06.511577 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:12:06.520608 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:12:06.527577 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:12:06.529576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.529576 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp121206298714"
    )
  
[0m05:12:06.531576 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:12:06.532576 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:12:06.532576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:12:06.532576 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:12:06.534576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.535576 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.535576 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:12:06.535576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EB18190>]}
[0m05:12:06.536576 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.28s]
[0m05:12:06.537577 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:12:06.537577 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:12:06.537577 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:12:06.538576 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.538576 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:12:06.539576 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:12:06.542576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.543576 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.544575 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:12:06.548576 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.549576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.550578 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:12:06.550578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.563576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:12:06.563576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.564577 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:12:06.566576 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:12:06.569576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.569576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:12:06.570576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:06.571576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:12:06.572576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.572576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:12:06.574577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.576575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:12:06.576575 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:12:06.577579 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:12:06.578575 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.579576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:12:06.579576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EAB3280>]}
[0m05:12:06.579576 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:12:06.580575 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:12:06.580575 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:12:06.581576 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:12:06.581576 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:12:06.582576 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:12:06.582576 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:12:06.585575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:12:06.586576 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.587577 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:12:06.627607 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:12:06.630577 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:12:06.630577 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:12:06.630577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:06.644576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:12:06.644576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:12:06.644576 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:12:06.646576 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 27: ... ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm...
                                                              ^

[0m05:12:06.647575 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:12:06.648576 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:06.648576 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:12:06.648576 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  column "day" does not exist
  LINE 27: ... ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm...
                                                                ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:12:06.649576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '879d4b9a-22f3-4525-be55-79dcee3c15a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EA72C20>]}
[0m05:12:06.649576 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.07s]
[0m05:12:06.650578 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:12:06.651576 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:12:06.651576 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:06.651576 [debug] [MainThread]: On master: BEGIN
[0m05:12:06.651576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:12:06.664577 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:12:06.664577 [debug] [MainThread]: On master: COMMIT
[0m05:12:06.664577 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:06.665576 [debug] [MainThread]: On master: COMMIT
[0m05:12:06.665576 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:12:06.666576 [debug] [MainThread]: On master: Close
[0m05:12:06.666576 [info ] [MainThread]: 
[0m05:12:06.666576 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m05:12:06.667576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:12:06.667576 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:12:06.667576 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:12:06.668578 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:12:06.705577 [info ] [MainThread]: 
[0m05:12:06.706578 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:12:06.707577 [info ] [MainThread]: 
[0m05:12:06.707577 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:12:06.708577 [error] [MainThread]:   column "day" does not exist
[0m05:12:06.709577 [error] [MainThread]:   LINE 27: ... ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm...
[0m05:12:06.709577 [error] [MainThread]:                                                                 ^
[0m05:12:06.709577 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:12:06.710576 [info ] [MainThread]: 
[0m05:12:06.710576 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:12:06.711576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EA71F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EA73BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22EA728C0>]}


============================== 2022-08-22 05:14:50.314830 | 27db58a1-7d12-4b18-a623-8b14b503b348 ==============================
[0m05:14:50.314830 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:14:50.315829 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:14:50.315829 [debug] [MainThread]: Tracking: tracking
[0m05:14:50.333829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB34DD420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB34DC6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB34DEB00>]}
[0m05:14:50.500860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:14:50.501877 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:14:50.514830 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:14:50.537862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m05:14:50.543860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB37A98D0>]}
[0m05:14:50.581830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB3765450>]}
[0m05:14:50.582859 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:14:50.582859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB37259F0>]}
[0m05:14:50.584861 [info ] [MainThread]: 
[0m05:14:50.585831 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:14:50.586859 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:14:50.594829 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:14:50.595860 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:14:50.595860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:14:50.630829 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.03 seconds
[0m05:14:50.631829 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:14:50.633829 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:14:50.638828 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:14:50.638828 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:14:50.639858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:14:50.673344 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:14:50.673344 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:14:50.673344 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:14:50.676343 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:14:50.677343 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:14:50.677343 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:14:50.678344 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:14:50.680345 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:14:50.680345 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:14:50.681344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:50.693774 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:14:50.693774 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:14:50.693774 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:14:50.696775 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:14:50.697773 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:14:50.698774 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:14:50.703805 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:50.703805 [debug] [MainThread]: On master: BEGIN
[0m05:14:50.703805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:14:50.716774 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:14:50.716774 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:50.716774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:14:50.729807 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:14:50.730775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB37EEDD0>]}
[0m05:14:50.731775 [debug] [MainThread]: On master: ROLLBACK
[0m05:14:50.732776 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:50.732776 [debug] [MainThread]: On master: BEGIN
[0m05:14:50.734774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:14:50.734774 [debug] [MainThread]: On master: COMMIT
[0m05:14:50.734774 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:50.734774 [debug] [MainThread]: On master: COMMIT
[0m05:14:50.735775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:14:50.735775 [debug] [MainThread]: On master: Close
[0m05:14:50.735775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:14:50.736775 [info ] [MainThread]: 
[0m05:14:50.740777 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:14:50.741777 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:14:50.742775 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.742775 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:14:50.742775 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:14:50.745774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:14:50.746774 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.746774 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:14:50.778805 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:14:50.780778 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.780778 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:14:50.780778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:14:50.816774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:14:50.817774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.817774 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:14:50.819774 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:14:50.825774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.825774 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:14:50.826774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.830774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.830774 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:14:50.831774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.846774 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:14:50.847773 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.847773 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:14:50.851774 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:50.855774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:14:50.856773 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:14:50.859773 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:14:50.861777 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.861777 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:14:50.861777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38535E0>]}
[0m05:14:50.862777 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m05:14:50.862777 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:14:50.863774 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:14:50.863774 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:14:50.864775 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.864775 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:14:50.864775 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:14:50.867773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:14:50.868773 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.869776 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:14:50.872773 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:14:50.874774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.874774 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:14:50.874774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:50.887778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:14:50.887778 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.888776 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:14:50.890775 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:14:50.892776 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.893776 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:14:50.894774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.897774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.897774 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:14:50.898774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.900775 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:14:50.900775 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.900775 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:14:50.902774 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:50.904774 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:14:50.905774 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:14:50.908776 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:14:50.909778 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.909778 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:14:50.910778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38B4610>]}
[0m05:14:50.910778 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m05:14:50.911777 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:14:50.911777 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:14:50.912778 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:14:50.912778 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.912778 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:14:50.913774 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:14:50.915775 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:14:50.917774 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.917774 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:14:50.921777 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:14:50.922777 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.923774 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:14:50.923774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:50.955958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:14:50.956958 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.956958 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:14:50.958747 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:14:50.961718 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.962716 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:14:50.963715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.966715 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.966715 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:14:50.967715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.968715 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:14:50.969714 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.969714 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:14:50.971236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:50.974241 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:14:50.974241 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:14:50.977272 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:14:50.978242 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.978242 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:14:50.979241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38C5330>]}
[0m05:14:50.979241 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:14:50.980242 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:14:50.980242 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:14:50.981243 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:14:50.981243 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:50.981243 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:14:50.982242 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:14:50.984242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:50.986243 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.986243 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:14:50.990241 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:50.992242 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:50.992242 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:14:50.992242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:51.006241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:14:51.006241 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:51.006241 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:14:51.008242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:14:51.011242 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:51.012242 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:14:51.013241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:51.014241 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:14:51.014241 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:51.014241 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:14:51.016241 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:51.019242 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:14:51.019242 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:14:51.020243 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:14:51.021242 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.021242 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:14:51.021242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB3930AC0>]}
[0m05:14:51.022242 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:14:51.022242 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:14:51.023242 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:14:51.023242 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:14:51.024241 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.024241 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:14:51.024241 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:14:51.028242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.030241 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.030241 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:14:51.034242 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.036241 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.036241 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:14:51.036241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:51.049751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:14:51.049751 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.049751 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:14:51.052751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:14:51.054751 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.055751 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:14:51.056754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:51.057751 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:14:51.057751 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.058751 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:14:51.060750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:51.062751 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:14:51.062751 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:14:51.063752 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:14:51.064751 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.064751 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:14:51.065750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB37ED690>]}
[0m05:14:51.065750 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:14:51.066750 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:14:51.066750 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:14:51.067751 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:14:51.067751 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.068751 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:14:51.068751 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:14:51.090752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:14:51.093753 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.094754 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:14:51.138752 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.138752 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp121451124753"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:14:51.139752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:51.281752 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.14 seconds
[0m05:14:51.288760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.288760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:14:51.289761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:14:51.289761 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.290761 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp121451124753'
        
      order by ordinal_position

  
[0m05:14:51.295791 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:14:51.300759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.300759 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:14:51.303760 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:14:51.316790 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.316790 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp121451124753'
        
      order by ordinal_position

  
[0m05:14:51.319759 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:14:51.322759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.322759 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:14:51.325759 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:14:51.334788 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:14:51.341795 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:14:51.343795 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.344760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp121451124753"
    )
  
[0m05:14:51.345761 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:14:51.346761 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:14:51.346761 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:14:51.347760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:14:51.349763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:51.350760 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.350760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:14:51.350760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB3978190>]}
[0m05:14:51.351760 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.28s]
[0m05:14:51.351760 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:14:51.352760 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:14:51.352760 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:14:51.353760 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.353760 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:14:51.353760 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:14:51.356761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.358792 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.358792 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:14:51.362760 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.364759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.364759 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:14:51.364759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:51.377762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:14:51.377762 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.377762 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:14:51.380759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:14:51.382759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.383760 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:14:51.384760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:51.385761 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:14:51.385761 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.385761 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:14:51.387760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:51.389759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:14:51.390759 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:14:51.390759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:14:51.391760 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.392760 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:14:51.392760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB390EE90>]}
[0m05:14:51.392760 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:14:51.393763 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:14:51.393763 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:14:51.394762 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:14:51.394762 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:14:51.395760 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:14:51.395760 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:14:51.398761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:14:51.400760 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.400760 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:14:51.439790 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:14:51.442760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:14:51.442760 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:14:51.442760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:51.473803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:14:51.474805 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:14:51.474805 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD('DD', 1, fm.full_moon_date))
  );
[0m05:14:51.475803 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function dateadd(unknown, integer, date) does not exist
LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD('DD', 1...
                                                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:14:51.475803 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:14:51.476801 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:51.476801 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:14:51.477804 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function dateadd(unknown, integer, date) does not exist
  LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD('DD', 1...
                                                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:14:51.477804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27db58a1-7d12-4b18-a623-8b14b503b348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38D3640>]}
[0m05:14:51.477804 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m05:14:51.478803 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:14:51.479802 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:14:51.479802 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:51.480801 [debug] [MainThread]: On master: BEGIN
[0m05:14:51.480801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:14:51.492801 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:14:51.493801 [debug] [MainThread]: On master: COMMIT
[0m05:14:51.493801 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:51.493801 [debug] [MainThread]: On master: COMMIT
[0m05:14:51.494801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:14:51.494801 [debug] [MainThread]: On master: Close
[0m05:14:51.495804 [info ] [MainThread]: 
[0m05:14:51.495804 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m05:14:51.496804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:14:51.496804 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:14:51.496804 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m05:14:51.496804 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:14:51.535802 [info ] [MainThread]: 
[0m05:14:51.535802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:14:51.536802 [info ] [MainThread]: 
[0m05:14:51.537801 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:14:51.538802 [error] [MainThread]:   function dateadd(unknown, integer, date) does not exist
[0m05:14:51.538802 [error] [MainThread]:   LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD('DD', 1...
[0m05:14:51.539802 [error] [MainThread]:                                                         ^
[0m05:14:51.539802 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:14:51.539802 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:14:51.540802 [info ] [MainThread]: 
[0m05:14:51.540802 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:14:51.541802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38D16C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38D0D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AB38D3220>]}


============================== 2022-08-22 05:21:11.325186 | 504e52a6-25e0-4d49-97bc-a34a9bd6bd2c ==============================
[0m05:21:11.325186 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:21:11.325186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:21:11.326187 [debug] [MainThread]: Tracking: tracking
[0m05:21:11.342187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B0DDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B0DC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B0DD420>]}
[0m05:21:11.505186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:21:11.506186 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:21:11.518189 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:21:11.541186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres.dim
- models.dbt_postgres

[0m05:21:11.547187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B3A98A0>]}
[0m05:21:11.585185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B36BFD0>]}
[0m05:21:11.586185 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:21:11.586185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B3259C0>]}
[0m05:21:11.588186 [info ] [MainThread]: 
[0m05:21:11.588186 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:21:11.590186 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:21:11.598186 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:21:11.599186 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:21:11.599186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:11.637185 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.04 seconds
[0m05:21:11.638188 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:21:11.640188 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:21:11.646185 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:21:11.646185 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:21:11.646185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:11.680185 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:21:11.680185 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:21:11.680185 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:21:11.682189 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:21:11.684187 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:21:11.684187 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:21:11.685186 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:21:11.687186 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:21:11.687186 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:21:11.688188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:21:11.700186 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:21:11.700186 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:21:11.701186 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:21:11.703187 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:21:11.704187 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:21:11.705187 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:21:11.710187 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:11.710187 [debug] [MainThread]: On master: BEGIN
[0m05:21:11.711187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:21:11.723187 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:21:11.723187 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:11.723187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:21:11.736185 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:21:11.737186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B40F790>]}
[0m05:21:11.737186 [debug] [MainThread]: On master: ROLLBACK
[0m05:21:11.738187 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:11.739187 [debug] [MainThread]: On master: BEGIN
[0m05:21:11.740187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:21:11.740187 [debug] [MainThread]: On master: COMMIT
[0m05:21:11.740187 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:11.740187 [debug] [MainThread]: On master: COMMIT
[0m05:21:11.741186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:21:11.741186 [debug] [MainThread]: On master: Close
[0m05:21:11.742186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:21:11.742186 [info ] [MainThread]: 
[0m05:21:11.746187 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:21:11.746187 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:21:11.747186 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.747186 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:21:11.747186 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:21:11.750187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:21:11.751187 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.752186 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:21:11.784187 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:21:11.786186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.786186 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:21:11.786186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:21:11.822187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:21:11.822187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.822187 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:21:11.825186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:11.831187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.831187 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:21:11.832186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:11.835187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.836187 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:21:11.837187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:11.853188 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:21:11.853188 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.853188 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:21:11.856186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:11.861186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:11.861186 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:21:11.865186 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:11.866188 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.866188 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:21:11.867186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B453610>]}
[0m05:21:11.867186 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m05:21:11.868189 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:21:11.868189 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:21:11.869186 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:21:11.869186 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.870187 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:21:11.870187 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:21:11.872187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:21:11.874185 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.874185 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:21:11.878187 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:21:11.880187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.880187 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:21:11.880187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:11.917186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:21:11.918186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.918186 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:21:11.920189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:11.923186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.923186 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:21:11.924186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:11.928186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.928186 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:21:11.929188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:11.931187 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:21:11.931187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.931187 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:21:11.933185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:11.935186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:11.935186 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:21:11.938186 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:11.939186 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.940185 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:21:11.940185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B4B45E0>]}
[0m05:21:11.940185 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:21:11.941186 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:21:11.941186 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:21:11.942187 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:21:11.943186 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.943186 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:21:11.943186 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:21:11.946187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:21:11.948186 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.948186 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:21:11.951186 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:21:11.953187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.954189 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:21:11.954189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:11.968187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:11.968187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.968187 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:21:11.970189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:11.973186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.974186 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:21:11.975188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:11.977186 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.977186 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:21:11.978188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:11.980187 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:21:11.980187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.980187 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:21:11.982186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:11.985187 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:11.985187 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:21:11.987613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:11.989621 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.989621 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:21:11.989621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B4C5360>]}
[0m05:21:11.990622 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:21:11.990622 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:21:11.991623 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:11.991623 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:21:11.992622 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:11.992622 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:11.992622 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:21:11.995618 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:11.996617 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:11.997619 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:12.000621 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:12.002618 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:12.002618 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:21:12.002618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:12.015618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:12.016619 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:12.016619 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:21:12.018619 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:12.021619 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:12.021619 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:21:12.022618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:12.023619 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:21:12.023619 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:12.023619 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:21:12.025618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:12.028618 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:12.028618 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:21:12.029618 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:12.030649 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.030649 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:21:12.030649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B530A90>]}
[0m05:21:12.031619 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:21:12.032620 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:12.032620 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:21:12.032620 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:21:12.033650 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.033650 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:21:12.033650 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:21:12.037650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.039618 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.039618 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:21:12.042620 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.044618 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.044618 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:21:12.044618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:12.074327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:21:12.074327 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.074327 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:21:12.077329 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:12.080329 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.080329 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:21:12.081330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:12.083328 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:21:12.083328 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.083328 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:21:12.085679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:12.087677 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:12.087677 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:21:12.088679 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:12.089677 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.089677 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:21:12.090677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B40FDC0>]}
[0m05:21:12.090677 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:21:12.091677 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:21:12.091677 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:21:12.092678 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:21:12.093677 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.093677 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:21:12.093677 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:21:12.115192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:21:12.117191 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.117191 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:21:12.149190 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.149190 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp122112137190"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:21:12.149190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:12.308193 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.16 seconds
[0m05:21:12.315190 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.315190 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:21:12.316191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:21:12.317191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.317191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122112137190'
        
      order by ordinal_position

  
[0m05:21:12.322193 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:21:12.327189 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.328191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:21:12.331191 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:21:12.343191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.343191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122112137190'
        
      order by ordinal_position

  
[0m05:21:12.346190 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:21:12.350190 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.350190 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:21:12.353191 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:21:12.362191 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:21:12.369190 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:21:12.371191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.371191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp122112137190"
    )
  
[0m05:21:12.373190 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:21:12.374191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:21:12.374191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:12.374191 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:21:12.377190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:12.377190 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.377190 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:21:12.378191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B57C190>]}
[0m05:21:12.378191 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.29s]
[0m05:21:12.379191 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:21:12.379191 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:12.380191 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:21:12.380191 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.381190 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:12.381190 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:21:12.384191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.385190 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.386190 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:12.390190 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.392191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.392191 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:21:12.392191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:12.420192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:21:12.420192 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.420192 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:21:12.423190 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:12.426190 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.426190 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:21:12.428191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:12.429191 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:21:12.429191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.429191 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:21:12.431191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:12.434191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:12.434191 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:21:12.435190 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:12.436190 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.436190 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:21:12.436190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B512E60>]}
[0m05:21:12.437190 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:21:12.437190 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:12.438190 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:12.438190 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:21:12.439191 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:12.439191 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:12.439191 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:12.443191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:12.444190 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.445190 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:12.489196 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:12.491191 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:12.491191 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:21:12.491191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:12.504190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:12.504190 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:12.505190 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm.full_moon_date))
  );
[0m05:21:12.506191 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 27: ... ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm...
                                                              ^

[0m05:21:12.506191 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:21:12.507191 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:12.507191 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:21:12.508190 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  column "day" does not exist
  LINE 27: ... ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm...
                                                                ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:21:12.508190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504e52a6-25e0-4d49-97bc-a34a9bd6bd2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B4D26B0>]}
[0m05:21:12.508190 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.07s]
[0m05:21:12.509190 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:12.510190 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:21:12.510190 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:12.511191 [debug] [MainThread]: On master: BEGIN
[0m05:21:12.511191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:21:12.524191 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:21:12.524191 [debug] [MainThread]: On master: COMMIT
[0m05:21:12.524191 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:12.524191 [debug] [MainThread]: On master: COMMIT
[0m05:21:12.525191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:21:12.525191 [debug] [MainThread]: On master: Close
[0m05:21:12.526191 [info ] [MainThread]: 
[0m05:21:12.526191 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m05:21:12.527190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:21:12.527190 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:21:12.527190 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:21:12.527190 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:21:12.565190 [info ] [MainThread]: 
[0m05:21:12.565190 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:21:12.566190 [info ] [MainThread]: 
[0m05:21:12.566190 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:21:12.567189 [error] [MainThread]:   column "day" does not exist
[0m05:21:12.568192 [error] [MainThread]:   LINE 27: ... ON (TO_DATE(r.review_date, 'YYYYMMDD') = DATEADD(DAY, 1, fm...
[0m05:21:12.568192 [error] [MainThread]:                                                                 ^
[0m05:21:12.568192 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:21:12.569190 [info ] [MainThread]: 
[0m05:21:12.569190 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:21:12.570191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B4D3A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B4D1930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F5B4D3010>]}


============================== 2022-08-22 05:21:50.775363 | 82ca6243-6cce-4f20-8176-f4cbefb5ce5b ==============================
[0m05:21:50.775363 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:21:50.776328 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:21:50.776328 [debug] [MainThread]: Tracking: tracking
[0m05:21:50.790328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B42D420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B42C6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B42EB00>]}
[0m05:21:50.939359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:21:50.939359 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:21:50.951329 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:21:50.975330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m05:21:50.981329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B6F98D0>]}
[0m05:21:51.017328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B6B9450>]}
[0m05:21:51.017328 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:21:51.018329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B6759F0>]}
[0m05:21:51.019329 [info ] [MainThread]: 
[0m05:21:51.020328 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:21:51.021329 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:21:51.029329 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:21:51.030328 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:21:51.030328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:51.047330 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.02 seconds
[0m05:21:51.048329 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:21:51.050331 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:21:51.055327 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:21:51.055327 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:21:51.056329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:21:51.069330 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.069330 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:21:51.069330 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:21:51.072328 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:21:51.073329 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:21:51.074329 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:21:51.074329 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:21:51.077329 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:21:51.077329 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:21:51.077329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:21:51.092330 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:21:51.093329 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:21:51.093329 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:21:51.095329 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:21:51.096329 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:21:51.097329 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:21:51.104327 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:51.105328 [debug] [MainThread]: On master: BEGIN
[0m05:21:51.105328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:21:51.119329 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.119329 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:51.120329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:21:51.133328 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:21:51.134329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B75FEE0>]}
[0m05:21:51.134329 [debug] [MainThread]: On master: ROLLBACK
[0m05:21:51.135328 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:51.135328 [debug] [MainThread]: On master: BEGIN
[0m05:21:51.137327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:21:51.137327 [debug] [MainThread]: On master: COMMIT
[0m05:21:51.137327 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:51.137327 [debug] [MainThread]: On master: COMMIT
[0m05:21:51.138329 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.138329 [debug] [MainThread]: On master: Close
[0m05:21:51.139327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:21:51.139327 [info ] [MainThread]: 
[0m05:21:51.143330 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:21:51.143330 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:21:51.144330 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.144330 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:21:51.144330 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:21:51.147329 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:21:51.149329 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.149329 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:21:51.181328 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:21:51.183328 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.183328 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:21:51.183328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:21:51.196328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.197328 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.197328 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:21:51.199329 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:51.204329 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.205329 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:21:51.206360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.210330 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.210330 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:21:51.211331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.227364 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:21:51.228333 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.228333 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:21:51.231360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.235360 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:21:51.236329 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:21:51.239327 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:51.240331 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.240331 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:21:51.241331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B79F5E0>]}
[0m05:21:51.241331 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m05:21:51.242329 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:21:51.243330 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:21:51.243330 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:21:51.244329 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.244329 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:21:51.244329 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:21:51.247360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:21:51.249329 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.249329 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:21:51.253328 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:21:51.254329 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.254329 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:21:51.255329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.268331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.268331 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.268331 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:21:51.271329 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:51.274328 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.274328 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:21:51.276331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.279328 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.279328 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:21:51.281328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.282330 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:21:51.282330 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.282330 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:21:51.284822 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.286828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:21:51.286828 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:21:51.289830 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:51.290833 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.291831 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:21:51.291831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B804610>]}
[0m05:21:51.291831 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m05:21:51.292831 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:21:51.293829 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:21:51.293829 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:21:51.294829 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.294829 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:21:51.294829 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:21:51.297830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:21:51.298859 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.299828 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:21:51.302830 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:21:51.304829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.304829 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:21:51.305829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.318830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.318830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.318830 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:21:51.320829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:51.323829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.323829 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:21:51.324829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.326860 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.327831 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:21:51.328831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.329831 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:21:51.329831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.329831 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:21:51.333830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.336828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:21:51.337828 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:21:51.339829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:51.340831 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.341831 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:21:51.341831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B815330>]}
[0m05:21:51.341831 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:21:51.342830 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:21:51.343830 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:51.343830 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:21:51.344829 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.344829 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:51.344829 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:21:51.347830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.348832 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.348832 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:51.352830 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.354829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.354829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:21:51.354829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.367830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.368831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.368831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:21:51.370830 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:51.373829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.373829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:21:51.374830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.375829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:21:51.375829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.375829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:21:51.377828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.380830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:21:51.380830 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:21:51.381831 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:51.382829 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.383829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:21:51.383829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B880AC0>]}
[0m05:21:51.383829 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:21:51.384829 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:21:51.385828 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:21:51.385828 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:21:51.385828 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.386829 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:21:51.386829 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:21:51.389829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.391829 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.391829 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:21:51.395828 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.397828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.398828 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:21:51.398828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.411832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.411832 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.411832 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:21:51.414832 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:51.417830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.418861 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:21:51.419864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.420831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:21:51.420831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.420831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:21:51.422829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.425828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:21:51.425828 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:21:51.426830 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:51.427831 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.427831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:21:51.427831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B75DFC0>]}
[0m05:21:51.428828 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:21:51.429831 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:21:51.429831 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:21:51.429831 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:21:51.430829 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.430829 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:21:51.431830 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:21:51.452831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:21:51.454861 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.454861 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:21:51.486831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.486831 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp122151474830"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:21:51.487831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.623830 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.14 seconds
[0m05:21:51.629828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.630828 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:21:51.631829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:21:51.631829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.631829 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122151474830'
        
      order by ordinal_position

  
[0m05:21:51.637857 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:21:51.642831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.643831 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:21:51.646830 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:21:51.658832 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.659859 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122151474830'
        
      order by ordinal_position

  
[0m05:21:51.662830 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:21:51.665859 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.665859 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:21:51.668829 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:21:51.677832 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:21:51.684830 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:21:51.686830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.686830 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp122151474830"
    )
  
[0m05:21:51.688832 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:21:51.690828 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:21:51.690828 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:21:51.690828 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:21:51.692831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.693829 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.693829 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:21:51.693829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B8CC190>]}
[0m05:21:51.694829 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.26s]
[0m05:21:51.694829 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:21:51.695830 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:51.695830 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:21:51.696832 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.696832 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:51.697830 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:21:51.701861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.703831 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.703831 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:51.707828 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.709831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.709831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:21:51.709831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.722830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.723830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.723830 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:21:51.726831 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:21:51.728831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.729830 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:21:51.730830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:21:51.731831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:21:51.731831 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.731831 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:21:51.734828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.736829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:21:51.736829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:21:51.737829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:21:51.738829 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.738829 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:21:51.739828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B8638E0>]}
[0m05:21:51.739828 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:21:51.740829 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:21:51.740829 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:51.741830 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:21:51.741830 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:51.741830 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:51.742830 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:51.745829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:51.746859 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.747831 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:51.787829 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:51.789830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:51.790829 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:21:51.790829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:21:51.816829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:21:51.817829 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:21:51.817829 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1, fm.full_moon_date)
  );
[0m05:21:51.818829 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "is_full_moon" does not exist
LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1...
                                                      ^

[0m05:21:51.818829 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:21:51.819828 [debug] [Thread-1 (]: finished collecting timing info
[0m05:21:51.819828 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:21:51.819828 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  column "is_full_moon" does not exist
  LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1...
                                                        ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:21:51.820829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ca6243-6cce-4f20-8176-f4cbefb5ce5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B820AC0>]}
[0m05:21:51.820829 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m05:21:51.821830 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:21:51.822829 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:21:51.822829 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:51.822829 [debug] [MainThread]: On master: BEGIN
[0m05:21:51.823831 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:21:51.835830 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:21:51.835830 [debug] [MainThread]: On master: COMMIT
[0m05:21:51.835830 [debug] [MainThread]: Using postgres connection "master"
[0m05:21:51.835830 [debug] [MainThread]: On master: COMMIT
[0m05:21:51.836829 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:21:51.836829 [debug] [MainThread]: On master: Close
[0m05:21:51.837829 [info ] [MainThread]: 
[0m05:21:51.837829 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m05:21:51.838832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:21:51.838832 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:21:51.838832 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:21:51.838832 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:21:51.876830 [info ] [MainThread]: 
[0m05:21:51.877830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:21:51.878830 [info ] [MainThread]: 
[0m05:21:51.878830 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:21:51.879830 [error] [MainThread]:   column "is_full_moon" does not exist
[0m05:21:51.879830 [error] [MainThread]:   LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1...
[0m05:21:51.879830 [error] [MainThread]:                                                         ^
[0m05:21:51.880829 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:21:51.880829 [info ] [MainThread]: 
[0m05:21:51.880829 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:21:51.881830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B822F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B8220E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9B820490>]}


============================== 2022-08-22 05:26:55.632702 | 75f1e815-04c8-4dae-a926-c423ac11ab01 ==============================
[0m05:26:55.632702 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:26:55.633673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:26:55.634672 [debug] [MainThread]: Tracking: tracking
[0m05:26:55.651672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C87DEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C87DDAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C87DF700>]}
[0m05:26:55.828704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:26:55.829674 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:26:55.841705 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:26:55.865675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m05:26:55.871704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8AA9810>]}
[0m05:26:55.909674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8A67E80>]}
[0m05:26:55.909674 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:26:55.910673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8A25930>]}
[0m05:26:55.912672 [info ] [MainThread]: 
[0m05:26:55.912672 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:26:55.914674 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:26:55.922673 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:26:55.923674 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:26:55.923674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:55.961674 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.04 seconds
[0m05:26:55.962674 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:26:55.964674 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:26:55.970673 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:26:55.970673 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:26:55.970673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:26:55.983674 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:26:55.983674 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:26:55.983674 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:26:55.986674 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:26:55.987674 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:26:55.988674 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:26:55.988674 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:26:55.991673 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:26:55.991673 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:26:55.991673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:26:56.005673 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.005673 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:26:56.005673 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:26:56.007673 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:26:56.009675 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:26:56.010685 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:26:56.015675 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:56.015675 [debug] [MainThread]: On master: BEGIN
[0m05:26:56.016674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:26:56.028674 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.029674 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:56.029674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:26:56.041674 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:26:56.043673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8B03640>]}
[0m05:26:56.043673 [debug] [MainThread]: On master: ROLLBACK
[0m05:26:56.044675 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:56.044675 [debug] [MainThread]: On master: BEGIN
[0m05:26:56.046673 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:26:56.046673 [debug] [MainThread]: On master: COMMIT
[0m05:26:56.046673 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:56.046673 [debug] [MainThread]: On master: COMMIT
[0m05:26:56.047674 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.047674 [debug] [MainThread]: On master: Close
[0m05:26:56.048675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:26:56.048675 [info ] [MainThread]: 
[0m05:26:56.053414 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:26:56.053414 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:26:56.054420 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.054420 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:26:56.054420 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:26:56.057414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:26:56.058413 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.059413 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:26:56.092412 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:26:56.094413 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.094413 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:26:56.094413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:26:56.125417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:26:56.125417 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.125417 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:26:56.128414 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:56.134414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.134414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:26:56.136415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.139414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.139414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:26:56.140415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.156414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:26:56.156414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.156414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:26:56.159413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.164413 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:26:56.165414 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:26:56.168415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:56.169415 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.169415 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:26:56.170415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8B536A0>]}
[0m05:26:56.170415 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m05:26:56.171415 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:26:56.171415 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:26:56.172414 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:26:56.172414 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.172414 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:26:56.173414 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:26:56.175418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:26:56.177416 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.178416 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:26:56.181414 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:26:56.183415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.183415 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:26:56.183415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.218416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m05:26:56.218416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.218416 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:26:56.221417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:56.223414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.224414 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:26:56.225414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.228415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.228415 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:26:56.229415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.231415 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:26:56.231415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.231415 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:26:56.234421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.236414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:26:56.237415 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:26:56.240414 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:56.241414 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.241414 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:26:56.241414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8BB4550>]}
[0m05:26:56.242415 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m05:26:56.242415 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:26:56.243415 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:26:56.243415 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:26:56.244415 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.244415 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:26:56.244415 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:26:56.247414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:26:56.248417 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.248417 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:26:56.252415 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:26:56.254414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.254414 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:26:56.254414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.267414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.267414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.268415 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:26:56.270415 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:56.273418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.273418 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:26:56.274415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.277415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.277415 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:26:56.278415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.280415 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:26:56.280415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.280415 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:26:56.282416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.285415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:26:56.285415 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:26:56.288415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:56.289415 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.289415 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:26:56.290414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8BC53F0>]}
[0m05:26:56.290414 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:26:56.291415 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:26:56.291415 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:26:56.292416 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:26:56.292416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.292416 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:26:56.293415 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:26:56.295415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.297414 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.297414 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:26:56.300416 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.302419 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.302419 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:26:56.302419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.315414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.315414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.316415 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:26:56.318416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:56.321415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.321415 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:26:56.322416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.323418 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:26:56.324419 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.324419 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:26:56.326416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.328415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:26:56.328415 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:26:56.329417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:56.330415 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.330415 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:26:56.331416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8C30A00>]}
[0m05:26:56.331416 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:26:56.332415 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:26:56.332415 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:26:56.333416 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:26:56.333416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.333416 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:26:56.334416 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:26:56.338416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.339416 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.340416 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:26:56.343415 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.345419 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.345419 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:26:56.345419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.359416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.359416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.359416 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:26:56.361416 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:56.364415 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.364415 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:26:56.365416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.367416 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:26:56.367416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.367416 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:26:56.369416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.372416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:26:56.372416 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:26:56.373417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:56.374416 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.374416 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:26:56.375416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8B03DC0>]}
[0m05:26:56.375416 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:26:56.376415 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:26:56.376415 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:26:56.377416 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:26:56.377416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.377416 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:26:56.378416 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:26:56.399466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:26:56.401416 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.402416 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:26:56.436416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.436416 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp122656424414"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:26:56.436416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.579418 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.14 seconds
[0m05:26:56.586418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.586418 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:26:56.587418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:26:56.587418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.588417 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122656424414'
        
      order by ordinal_position

  
[0m05:26:56.593420 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:26:56.598419 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.598419 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:26:56.602417 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:26:56.614417 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.614417 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122656424414'
        
      order by ordinal_position

  
[0m05:26:56.617417 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:26:56.621416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.621416 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:26:56.624418 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:26:56.633416 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:26:56.640417 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:26:56.642416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.642416 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp122656424414"
    )
  
[0m05:26:56.643417 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:26:56.645417 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:26:56.645417 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:26:56.645417 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:26:56.647418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.648417 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.648417 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:26:56.649418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8C7C190>]}
[0m05:26:56.649418 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.27s]
[0m05:26:56.650417 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:26:56.650417 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:26:56.650417 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:26:56.651417 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.651417 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:26:56.651417 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:26:56.655418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.656417 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.656417 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:26:56.660417 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.662416 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.662416 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:26:56.662416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.675417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.676417 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.676417 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:26:56.678417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:26:56.681417 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.681417 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:26:56.682417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:26:56.684418 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:26:56.684418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.684418 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:26:56.686417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.688418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:26:56.688418 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:26:56.689417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:26:56.690418 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.690418 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:26:56.691418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8C0EDA0>]}
[0m05:26:56.691418 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:26:56.692418 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:26:56.692418 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:26:56.693418 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:26:56.693418 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:26:56.693418 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:26:56.694417 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:26:56.697418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:26:56.698416 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.699420 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:26:56.740418 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:26:56.742418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:26:56.742418 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:26:56.742418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:26:56.768418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:26:56.768418 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:26:56.768418 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1, fm.full_moon_date)
  );
[0m05:26:56.769419 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function date(text, unknown) does not exist
LINE 27:     ON (DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1, f...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:26:56.770418 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:26:56.770418 [debug] [Thread-1 (]: finished collecting timing info
[0m05:26:56.771418 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:26:56.771418 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function date(text, unknown) does not exist
  LINE 27:     ON (DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1, f...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:26:56.772419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75f1e815-04c8-4dae-a926-c423ac11ab01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8BD19C0>]}
[0m05:26:56.772419 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m05:26:56.773417 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:26:56.774419 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:26:56.774419 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:56.774419 [debug] [MainThread]: On master: BEGIN
[0m05:26:56.774419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:26:56.787418 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:26:56.787418 [debug] [MainThread]: On master: COMMIT
[0m05:26:56.787418 [debug] [MainThread]: Using postgres connection "master"
[0m05:26:56.788418 [debug] [MainThread]: On master: COMMIT
[0m05:26:56.788418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:26:56.789419 [debug] [MainThread]: On master: Close
[0m05:26:56.789419 [info ] [MainThread]: 
[0m05:26:56.790418 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m05:26:56.790418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:26:56.791419 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:26:56.791419 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:26:56.791419 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:26:56.828418 [info ] [MainThread]: 
[0m05:26:56.829419 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:26:56.829419 [info ] [MainThread]: 
[0m05:26:56.830418 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:26:56.831418 [error] [MainThread]:   function date(text, unknown) does not exist
[0m05:26:56.831418 [error] [MainThread]:   LINE 27:     ON (DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1, f...
[0m05:26:56.832418 [error] [MainThread]:                    ^
[0m05:26:56.832418 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:26:56.833419 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:26:56.833419 [info ] [MainThread]: 
[0m05:26:56.833419 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:26:56.834419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8BD0A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8BD12A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7C8BD0B80>]}


============================== 2022-08-22 05:29:38.695531 | bf5e404d-3cd8-4d54-b875-63905776fd76 ==============================
[0m05:29:38.695531 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:29:38.695531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:29:38.696538 [debug] [MainThread]: Tracking: tracking
[0m05:29:38.710541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C289C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C289E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C289CD30>]}
[0m05:29:38.870557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:29:38.871555 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:29:38.884553 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:29:38.911555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m05:29:38.917553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2B69870>]}
[0m05:29:38.954555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2B27FA0>]}
[0m05:29:38.954555 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:29:38.955554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2AE5990>]}
[0m05:29:38.956587 [info ] [MainThread]: 
[0m05:29:38.957557 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:29:38.958595 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:29:38.967584 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:29:38.967584 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:29:38.968555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:39.027570 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.06 seconds
[0m05:29:39.029593 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:29:39.032555 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:29:39.041555 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:29:39.041555 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:29:39.042560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:39.064561 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:29:39.064561 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:29:39.065557 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:29:39.069563 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:29:39.071565 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:29:39.073562 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:29:39.073562 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:29:39.077563 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:29:39.077563 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:29:39.077563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:39.095555 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:29:39.096555 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:29:39.096555 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:29:39.098555 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:29:39.100555 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:29:39.101557 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:29:39.107555 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:39.107555 [debug] [MainThread]: On master: BEGIN
[0m05:29:39.107555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:29:39.121554 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.122557 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:39.122557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:29:39.135556 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:29:39.136586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2BAD810>]}
[0m05:29:39.136586 [debug] [MainThread]: On master: ROLLBACK
[0m05:29:39.138557 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:39.138557 [debug] [MainThread]: On master: BEGIN
[0m05:29:39.139556 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:29:39.139556 [debug] [MainThread]: On master: COMMIT
[0m05:29:39.140556 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:39.140556 [debug] [MainThread]: On master: COMMIT
[0m05:29:39.140556 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.141556 [debug] [MainThread]: On master: Close
[0m05:29:39.141556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:29:39.142555 [info ] [MainThread]: 
[0m05:29:39.145556 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:29:39.146557 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:29:39.146557 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.146557 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:29:39.147556 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:29:39.149556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:29:39.151556 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.151556 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:29:39.186556 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:29:39.187557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.188557 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:29:39.188557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:29:39.201556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.202556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.202556 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:29:39.204555 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:39.210556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.211555 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:29:39.212555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.215555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.215555 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:29:39.217555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.234556 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:29:39.235556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.235556 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:29:39.239556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.244554 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:39.245555 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:29:39.248555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:39.250556 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.250556 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:29:39.251557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C13640>]}
[0m05:29:39.251557 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m05:29:39.252556 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:29:39.252556 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:29:39.253557 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:29:39.253557 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.253557 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:29:39.254556 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:29:39.257556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:29:39.258556 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.259556 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:29:39.263556 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:29:39.265558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.265558 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:29:39.265558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.280556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.280556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.281557 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:29:39.283556 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:39.286555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.286555 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:29:39.287555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.291556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.291556 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:29:39.292555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.294555 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:29:39.294555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.294555 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:29:39.296556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.298554 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:39.299555 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:29:39.301556 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:39.303556 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.303556 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:29:39.303556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C745B0>]}
[0m05:29:39.304555 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m05:29:39.304555 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:29:39.305556 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:29:39.305556 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:29:39.306556 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.306556 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:29:39.306556 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:29:39.309555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:29:39.311555 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.311555 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:29:39.315556 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:29:39.317556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.318555 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:29:39.318555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.331556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.331556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.331556 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:29:39.333556 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:39.336555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.336555 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:29:39.337556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.340556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.340556 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:29:39.341557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.343555 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:29:39.343555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.343555 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:29:39.345555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.348556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:39.348556 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:29:39.350558 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:39.351555 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.352556 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:29:39.352556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C82CB0>]}
[0m05:29:39.353556 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:29:39.353556 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:29:39.354558 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:39.354558 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:29:39.355558 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.355558 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:39.356557 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:29:39.358556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.360557 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.360557 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:39.364556 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.366555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.366555 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:29:39.366555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.380558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.380558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.380558 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:29:39.382559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:39.385556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.386557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:29:39.387556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.388556 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:29:39.388556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.388556 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:29:39.390558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.393557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:39.393557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:29:39.394557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:39.395557 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.395557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:29:39.395557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2CF0A60>]}
[0m05:29:39.396557 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m05:29:39.397556 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:39.397556 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:29:39.397556 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:29:39.398557 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.398557 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:29:39.398557 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:29:39.402557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.404556 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.404556 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:29:39.408555 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.410558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.410558 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:29:39.410558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.424557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.424557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.424557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:29:39.427555 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:39.430558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.430558 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:29:39.431558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.432556 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:29:39.433557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.433557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:29:39.435557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.437555 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:39.438556 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:29:39.438556 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:39.439557 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.440558 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:29:39.440558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2BACA90>]}
[0m05:29:39.441560 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:29:39.441560 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:29:39.442559 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:29:39.442559 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:29:39.443557 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.443557 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:29:39.443557 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:29:39.466556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:29:39.468558 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.468558 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:29:39.503556 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.503556 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp122939491557"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:29:39.504557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.621556 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.12 seconds
[0m05:29:39.628557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.628557 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:29:39.629557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:29:39.630557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.630557 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122939491557'
        
      order by ordinal_position

  
[0m05:29:39.635557 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:39.640557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.641558 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:29:39.644556 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:39.657557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.657557 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122939491557'
        
      order by ordinal_position

  
[0m05:29:39.660557 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:39.665557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.665557 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:29:39.669560 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:39.679558 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:29:39.687558 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:29:39.689558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.689558 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp122939491557"
    )
  
[0m05:29:39.691558 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:29:39.692558 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:29:39.692558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:39.693558 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:29:39.695558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.695558 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.695558 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:29:39.696557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2D3C190>]}
[0m05:29:39.696557 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.25s]
[0m05:29:39.697558 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:29:39.698561 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:39.698561 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:29:39.699560 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.699560 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:39.699560 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:29:39.702558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.704558 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.705557 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:39.709559 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.711559 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.711559 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:29:39.711559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.724559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.725559 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.725559 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:29:39.727559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:39.730560 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.731564 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:29:39.732557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:39.733558 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:29:39.733558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.734557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:29:39.735557 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.738557 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:39.738557 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:29:39.739557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:39.740558 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.740558 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:29:39.740558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2CD3550>]}
[0m05:29:39.741558 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:29:39.742558 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:39.742558 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:39.742558 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:29:39.743558 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:39.743558 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:39.743558 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:39.746558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:39.748558 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.748558 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:39.789557 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:39.791559 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:39.791559 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:29:39.791559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:39.804558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.804558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:39.804558 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1, fm.full_moon_date)
  );
[0m05:29:39.805558 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "is_full_moon" does not exist
LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1...
                                                      ^

[0m05:29:39.806558 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:29:39.806558 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:39.806558 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:29:39.807558 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  column "is_full_moon" does not exist
  LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1...
                                                        ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:29:39.808090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5e404d-3cd8-4d54-b875-63905776fd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C92440>]}
[0m05:29:39.808640 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.06s]
[0m05:29:39.809349 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:39.810401 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:29:39.810401 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:39.810929 [debug] [MainThread]: On master: BEGIN
[0m05:29:39.810929 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:29:39.823349 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:29:39.823349 [debug] [MainThread]: On master: COMMIT
[0m05:29:39.824352 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:39.824352 [debug] [MainThread]: On master: COMMIT
[0m05:29:39.825351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:29:39.825351 [debug] [MainThread]: On master: Close
[0m05:29:39.826351 [info ] [MainThread]: 
[0m05:29:39.826351 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m05:29:39.826351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:39.827351 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:29:39.827351 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m05:29:39.827351 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:29:39.867091 [info ] [MainThread]: 
[0m05:29:39.868090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:29:39.869091 [info ] [MainThread]: 
[0m05:29:39.869091 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:29:39.870091 [error] [MainThread]:   column "is_full_moon" does not exist
[0m05:29:39.870091 [error] [MainThread]:   LINE 27:     ON (TO_DATE(r.review_date, 'YYYYMMDD') = is_full_moon, 1...
[0m05:29:39.871090 [error] [MainThread]:                                                         ^
[0m05:29:39.871629 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:29:39.871629 [info ] [MainThread]: 
[0m05:29:39.871629 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:29:39.872636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C91000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C92AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C90AC0>]}


============================== 2022-08-22 05:29:57.761205 | 5d852d95-ce75-4cdb-b956-e0fe1bd7348e ==============================
[0m05:29:57.761205 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:29:57.762206 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:29:57.762206 [debug] [MainThread]: Tracking: tracking
[0m05:29:57.777208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B41AEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B41AECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B41ADD80>]}
[0m05:29:57.928207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:29:57.929207 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:29:57.943207 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:29:57.966206 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m05:29:57.972207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B4479840>]}
[0m05:29:58.008207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B443BEB0>]}
[0m05:29:58.009209 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:29:58.009209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B43F5960>]}
[0m05:29:58.011207 [info ] [MainThread]: 
[0m05:29:58.011207 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:29:58.013207 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:29:58.021208 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:29:58.022208 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:29:58.022208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:58.052208 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.03 seconds
[0m05:29:58.053208 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:29:58.055207 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:29:58.060208 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:29:58.061208 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:29:58.061208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:29:58.073207 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:29:58.074207 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:29:58.074207 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:29:58.076207 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m05:29:58.077207 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:29:58.078207 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:29:58.079207 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:29:58.081209 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:29:58.081209 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:29:58.082209 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:29:58.097209 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:29:58.097209 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:29:58.097209 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:29:58.101215 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:29:58.102209 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:29:58.104210 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:29:58.112209 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:58.112209 [debug] [MainThread]: On master: BEGIN
[0m05:29:58.112209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:29:58.147208 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:29:58.147208 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:58.147208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:29:58.160208 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:29:58.161207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B44DFA90>]}
[0m05:29:58.161207 [debug] [MainThread]: On master: ROLLBACK
[0m05:29:58.162208 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:58.162208 [debug] [MainThread]: On master: BEGIN
[0m05:29:58.164209 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:29:58.164209 [debug] [MainThread]: On master: COMMIT
[0m05:29:58.164209 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:58.164209 [debug] [MainThread]: On master: COMMIT
[0m05:29:58.165208 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.165208 [debug] [MainThread]: On master: Close
[0m05:29:58.166208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:29:58.166208 [info ] [MainThread]: 
[0m05:29:58.169207 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:29:58.170210 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:29:58.170210 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.171209 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:29:58.171209 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:29:58.174207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:29:58.175208 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.175208 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:29:58.207240 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:29:58.209209 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.209209 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:29:58.209209 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:29:58.241293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:29:58.241293 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.242293 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:29:58.243293 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:58.249291 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.249291 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:29:58.251293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.254292 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.254292 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:29:58.255293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.271323 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:29:58.271323 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.272323 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:29:58.275681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.279710 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:29:58.279710 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:29:58.283700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:58.284680 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.284680 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:29:58.285678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B4523670>]}
[0m05:29:58.285678 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m05:29:58.286679 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:29:58.287680 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:29:58.287680 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:29:58.288680 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.288680 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:29:58.288680 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:29:58.291680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:29:58.292680 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.293678 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:29:58.297679 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:29:58.299680 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.299680 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:29:58.299680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.312680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:58.313680 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.313680 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:29:58.315682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:58.318678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.318678 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:29:58.319679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.323679 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.323679 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:29:58.325684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.326682 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:29:58.326682 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.327679 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:29:58.329681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.331680 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:29:58.331680 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:29:58.334680 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:58.335679 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.335679 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:29:58.336680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B4584580>]}
[0m05:29:58.336680 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m05:29:58.337683 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:29:58.337683 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:29:58.337683 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:29:58.338681 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.338681 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:29:58.338681 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:29:58.341679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:29:58.343679 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.343679 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:29:58.349678 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:29:58.351680 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.351680 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:29:58.351680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.364685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:58.364685 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.365682 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:29:58.366679 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:58.369679 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.369679 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:29:58.371680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.373678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.374678 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:29:58.375681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.376679 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:29:58.376679 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.376679 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:29:58.379680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.382678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:29:58.382678 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:29:58.385680 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:58.386678 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.386678 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:29:58.386678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B45913C0>]}
[0m05:29:58.387680 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:29:58.387680 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:29:58.388679 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:58.388679 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:29:58.389680 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.389680 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:58.389680 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:29:58.392679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.393679 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.394681 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:58.397679 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.399679 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.399679 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:29:58.399679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.427682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:29:58.427682 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.428681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:29:58.430682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:58.432678 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.433680 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:29:58.434678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.435680 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:29:58.435680 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.435680 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:29:58.438680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.440681 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:29:58.440681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:29:58.441682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:58.442681 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.442681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:29:58.443680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B4600A30>]}
[0m05:29:58.443680 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.05s]
[0m05:29:58.444682 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:29:58.444682 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:29:58.444682 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:29:58.445680 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.445680 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:29:58.445680 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:29:58.449683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.451681 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.452681 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:29:58.455678 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.457680 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.457680 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:29:58.457680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.491681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:29:58.491681 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.491681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:29:58.494681 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:58.496679 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.497681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:29:58.498680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.499681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:29:58.499681 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.499681 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:29:58.501681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.503679 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:29:58.504680 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:29:58.504680 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:58.505681 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.506680 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:29:58.506680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B44DEB60>]}
[0m05:29:58.506680 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m05:29:58.507682 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:29:58.508681 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:29:58.508681 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:29:58.509680 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.509680 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:29:58.509680 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:29:58.530715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:29:58.533684 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.533684 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:29:58.565711 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.565711 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp122958553710"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:29:58.565711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.699655 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.13 seconds
[0m05:29:58.708581 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.708581 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:29:58.709582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:29:58.709582 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.710583 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122958553710'
        
      order by ordinal_position

  
[0m05:29:58.716580 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:58.721581 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.721581 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:29:58.725582 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:58.740473 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.740473 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp122958553710'
        
      order by ordinal_position

  
[0m05:29:58.744148 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:58.746763 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.747772 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:29:58.750770 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:29:58.761533 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:29:58.770518 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:29:58.772518 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.772518 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp122958553710"
    )
  
[0m05:29:58.774517 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:29:58.775518 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:29:58.775518 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:29:58.775518 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:29:58.778516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.778516 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.778516 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:29:58.779517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B464C190>]}
[0m05:29:58.779517 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.27s]
[0m05:29:58.780519 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:29:58.781520 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:58.781520 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:29:58.782520 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.782520 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:58.782520 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:29:58.786516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.788522 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.788522 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:58.792914 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.794923 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.795924 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:29:58.795924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.807923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:58.808922 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.808922 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:29:58.811500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:29:58.814508 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.814508 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:29:58.815509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:29:58.816509 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:29:58.816509 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.816509 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:29:58.818509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.820508 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:29:58.821512 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:29:58.822510 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:29:58.823508 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.823508 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:29:58.823508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B45E8BE0>]}
[0m05:29:58.824509 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:29:58.824509 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:29:58.825509 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:58.825509 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:29:58.826509 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:58.826509 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:58.826509 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:58.830509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:58.832508 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.832508 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:58.871508 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:58.873508 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:58.873508 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:29:58.873508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:29:58.887510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:29:58.887510 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:29:58.887510 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date) = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m05:29:58.888509 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function to_date(text) does not exist
LINE 29:     ON (TO_DATE(r.review_date) = INTERVAL '1 DAY' + fm.full_...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:29:58.889511 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m05:29:58.889511 [debug] [Thread-1 (]: finished collecting timing info
[0m05:29:58.890510 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:29:58.890510 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  function to_date(text) does not exist
  LINE 29:     ON (TO_DATE(r.review_date) = INTERVAL '1 DAY' + fm.full_...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:29:58.890510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d852d95-ce75-4cdb-b956-e0fe1bd7348e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B45A0A30>]}
[0m05:29:58.891511 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.07s]
[0m05:29:58.892509 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:29:58.893509 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:29:58.893509 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:58.893509 [debug] [MainThread]: On master: BEGIN
[0m05:29:58.893509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:29:58.905509 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:29:58.906510 [debug] [MainThread]: On master: COMMIT
[0m05:29:58.906510 [debug] [MainThread]: Using postgres connection "master"
[0m05:29:58.906510 [debug] [MainThread]: On master: COMMIT
[0m05:29:58.907509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:29:58.907509 [debug] [MainThread]: On master: Close
[0m05:29:58.907509 [info ] [MainThread]: 
[0m05:29:58.908510 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m05:29:58.908510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:29:58.909511 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:29:58.909511 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:29:58.909511 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:29:58.946510 [info ] [MainThread]: 
[0m05:29:58.947509 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:29:58.948510 [info ] [MainThread]: 
[0m05:29:58.949509 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m05:29:58.949509 [error] [MainThread]:   function to_date(text) does not exist
[0m05:29:58.950509 [error] [MainThread]:   LINE 29:     ON (TO_DATE(r.review_date) = INTERVAL '1 DAY' + fm.full_...
[0m05:29:58.950509 [error] [MainThread]:                    ^
[0m05:29:58.951511 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m05:29:58.951511 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m05:29:58.952511 [info ] [MainThread]: 
[0m05:29:58.953511 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m05:29:58.953511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B45A0A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B45A1870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B45A07C0>]}


============================== 2022-08-22 05:32:08.627935 | 1188c149-aa3a-4219-97e6-2a7686ea0803 ==============================
[0m05:32:08.627935 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:32:08.627935 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:32:08.628935 [debug] [MainThread]: Tracking: tracking
[0m05:32:08.644935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA67EDEC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA67EDDAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA67EDF700>]}
[0m05:32:08.828923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:32:08.828923 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m05:32:08.843923 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m05:32:08.868925 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m05:32:08.874923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA681A9810>]}
[0m05:32:08.912923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6816BF40>]}
[0m05:32:08.913923 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:32:08.913923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA68125930>]}
[0m05:32:08.915924 [info ] [MainThread]: 
[0m05:32:08.915924 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:32:08.917924 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m05:32:08.925926 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m05:32:08.925926 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m05:32:08.926925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:08.958898 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.03 seconds
[0m05:32:08.959897 [debug] [ThreadPool]: On list_airbnb: Close
[0m05:32:08.961909 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:32:08.966927 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:32:08.966927 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:32:08.967928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:32:09.004711 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m05:32:09.005708 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:32:09.005708 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:32:09.014591 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m05:32:09.018553 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:32:09.021549 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:32:09.023557 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:32:09.029594 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:32:09.029594 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:32:09.030572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:32:09.067537 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m05:32:09.067537 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:32:09.067537 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:32:09.070537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:32:09.071537 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:32:09.072538 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:32:09.077537 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:09.077537 [debug] [MainThread]: On master: BEGIN
[0m05:32:09.078537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:32:09.091538 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:32:09.091538 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:09.091538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:32:09.104540 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:32:09.106538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA68207640>]}
[0m05:32:09.106538 [debug] [MainThread]: On master: ROLLBACK
[0m05:32:09.107540 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:09.107540 [debug] [MainThread]: On master: BEGIN
[0m05:32:09.109537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:32:09.109537 [debug] [MainThread]: On master: COMMIT
[0m05:32:09.109537 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:09.109537 [debug] [MainThread]: On master: COMMIT
[0m05:32:09.110537 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.110537 [debug] [MainThread]: On master: Close
[0m05:32:09.111538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:32:09.111538 [info ] [MainThread]: 
[0m05:32:09.116377 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:32:09.116377 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m05:32:09.117376 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.117376 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:32:09.118377 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:32:09.120375 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:32:09.122377 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.122377 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:32:09.153377 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m05:32:09.156010 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.156010 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m05:32:09.156010 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:32:09.188018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:32:09.189018 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.189018 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
 SELECT
 *
 FROM
 "airbnb"."raw"."raw_hosts"
)
SELECT
 id AS host_id,
 NAME AS host_name,
 is_superhost,
 created_at,
 updated_at
FROM
 raw_hosts
  );
[0m05:32:09.191016 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:32:09.196015 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.197016 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m05:32:09.198018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.201017 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.201017 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "airbnb"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m05:32:09.202017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.217047 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:32:09.218048 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.218048 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m05:32:09.220635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.225671 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m05:32:09.225671 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "airbnb"."dbo"."src_hosts__dbt_backup" cascade
[0m05:32:09.228651 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:32:09.229641 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.229641 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m05:32:09.230641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA682576A0>]}
[0m05:32:09.230641 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m05:32:09.231642 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:32:09.231642 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:32:09.232833 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m05:32:09.232833 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.233841 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:32:09.233841 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:32:09.235839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:32:09.237838 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.237838 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:32:09.241848 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m05:32:09.242870 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.243839 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m05:32:09.243839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.256130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:32:09.256130 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.257131 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_listings"
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m05:32:09.258131 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:32:09.261130 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.261130 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m05:32:09.262654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.265695 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.265695 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "airbnb"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m05:32:09.266992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.268001 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:32:09.268001 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.268001 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m05:32:09.270028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.272001 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m05:32:09.273001 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "airbnb"."dbo"."src_listings__dbt_backup" cascade
[0m05:32:09.275856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:32:09.276856 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.276856 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m05:32:09.276856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA682B4550>]}
[0m05:32:09.277858 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m05:32:09.277858 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:32:09.278858 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:32:09.278858 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m05:32:09.279855 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.279855 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:32:09.279855 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:32:09.282856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:32:09.283855 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.283855 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:32:09.287856 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m05:32:09.289856 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.289856 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m05:32:09.289856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.304060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:32:09.304060 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.304060 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "airbnb"."raw"."raw_reviews"
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m05:32:09.306066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:32:09.308065 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.309065 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m05:32:09.310068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.312067 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.312067 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "airbnb"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m05:32:09.313066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.314066 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:32:09.314066 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.315065 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m05:32:09.316860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.319858 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m05:32:09.319858 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "airbnb"."dbo"."src_reviews__dbt_backup" cascade
[0m05:32:09.322861 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:32:09.323859 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.323859 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m05:32:09.323859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA682C2C50>]}
[0m05:32:09.324859 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m05:32:09.325859 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:32:09.325859 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:32:09.325859 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m05:32:09.326859 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.326859 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:32:09.326859 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:32:09.329860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.330858 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.331860 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:32:09.335861 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.336858 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.337859 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m05:32:09.337859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.349994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m05:32:09.350994 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.350994 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "airbnb"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m05:32:09.352995 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:32:09.355992 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.355992 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "airbnb"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m05:32:09.356991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.357995 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:32:09.358995 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.358995 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m05:32:09.363178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.367173 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:32:09.368177 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m05:32:09.369177 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:32:09.372175 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.372175 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m05:32:09.373177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA68330A00>]}
[0m05:32:09.374177 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.05s]
[0m05:32:09.375176 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:32:09.376176 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:32:09.377175 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m05:32:09.377928 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.377928 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:32:09.378973 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:32:09.385942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.388977 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.389938 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:32:09.393936 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.396972 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.396972 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m05:32:09.396972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.427728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:32:09.427728 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.427728 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "airbnb"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m05:32:09.430897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:32:09.434932 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.434932 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "airbnb"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m05:32:09.435899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.437898 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:32:09.437898 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.438899 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m05:32:09.440919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.443897 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:32:09.443897 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "airbnb"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m05:32:09.445899 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:32:09.446899 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.446899 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m05:32:09.447897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA68207DC0>]}
[0m05:32:09.447897 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m05:32:09.449899 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:32:09.449899 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:32:09.449899 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m05:32:09.450897 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.450897 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:32:09.450897 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:32:09.472928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:32:09.474933 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.474933 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:32:09.505930 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.505930 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp123209494928"
  as (
    
WITH src_reviews AS (
SELECT * FROM "airbnb"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "airbnb"."dbo"."fct_reviews")

  );
  
[0m05:32:09.505930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.637849 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.13 seconds
[0m05:32:09.643847 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.643847 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m05:32:09.645819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:32:09.645819 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.645819 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp123209494928'
        
      order by ordinal_position

  
[0m05:32:09.651849 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m05:32:09.656848 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.657851 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:32:09.661855 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:32:09.674848 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.674848 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp123209494928'
        
      order by ordinal_position

  
[0m05:32:09.678502 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:32:09.680508 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.681508 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "airbnb".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m05:32:09.684508 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m05:32:09.692508 [debug] [Thread-1 (]: 
    In "airbnb"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:32:09.699507 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m05:32:09.701508 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.701508 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "airbnb"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp123209494928"
    )
  
[0m05:32:09.703509 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m05:32:09.704508 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:32:09.704508 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m05:32:09.704508 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m05:32:09.707549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.708545 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.708545 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m05:32:09.709528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6837C190>]}
[0m05:32:09.709528 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 0.26s]
[0m05:32:09.710510 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:32:09.710510 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:32:09.711525 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m05:32:09.711525 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.712510 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:32:09.712510 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:32:09.715536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.717541 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.717541 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:32:09.720538 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.722544 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.722544 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m05:32:09.723538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.751029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:32:09.751029 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.752028 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "airbnb"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "airbnb"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m05:32:09.754027 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:32:09.757027 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.757027 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "airbnb"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m05:32:09.757740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:09.758748 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:32:09.758748 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.759747 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m05:32:09.761863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:32:09.763860 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:32:09.763860 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "airbnb"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m05:32:09.764862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:32:09.765861 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.765861 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m05:32:09.765861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA68312DA0>]}
[0m05:32:09.766860 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m05:32:09.767863 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:32:09.767863 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:32:09.767863 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m05:32:09.768862 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:09.768862 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:32:09.768862 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:32:09.771862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:09.773861 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:09.773861 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:32:09.812275 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:09.814351 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:09.814868 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m05:32:09.814868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:32:09.844042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:32:09.844042 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:09.844042 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM "airbnb"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "airbnb"."dbo"."seed_full_moon_dates"
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m05:32:11.650007 [debug] [Thread-1 (]: SQL status: SELECT 365946 in 1.81 seconds
[0m05:32:11.653006 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:11.653006 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */
alter table "airbnb"."dbo"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m05:32:11.654007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:32:11.659007 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: COMMIT
[0m05:32:11.659007 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:11.659007 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: COMMIT
[0m05:32:11.667256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:32:11.669256 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:32:11.669256 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */
drop table if exists "airbnb"."dbo"."mart_fullmoon_reviews__dbt_backup" cascade
[0m05:32:11.670255 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:32:11.671257 [debug] [Thread-1 (]: finished collecting timing info
[0m05:32:11.672256 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m05:32:11.672256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1188c149-aa3a-4219-97e6-2a7686ea0803', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6837D9F0>]}
[0m05:32:11.672256 [info ] [Thread-1 (]: 8 of 8 OK created table model dbo.mart_fullmoon_reviews ........................ [[32mSELECT 365946[0m in 1.90s]
[0m05:32:11.673259 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:32:11.674259 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:32:11.675259 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:11.675259 [debug] [MainThread]: On master: BEGIN
[0m05:32:11.675259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:32:11.709266 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:32:11.710266 [debug] [MainThread]: On master: COMMIT
[0m05:32:11.710266 [debug] [MainThread]: Using postgres connection "master"
[0m05:32:11.710266 [debug] [MainThread]: On master: COMMIT
[0m05:32:11.711266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:32:11.711266 [debug] [MainThread]: On master: Close
[0m05:32:11.712267 [info ] [MainThread]: 
[0m05:32:11.712267 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m05:32:11.713266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:32:11.713266 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m05:32:11.713266 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m05:32:11.713266 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:32:11.752268 [info ] [MainThread]: 
[0m05:32:11.752268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:32:11.753266 [info ] [MainThread]: 
[0m05:32:11.754266 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m05:32:11.754266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6837DF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6837E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA6837E170>]}


============================== 2022-08-22 05:33:39.423806 | 376d753d-7226-43f7-abf5-e0334a767e99 ==============================
[0m05:33:39.423806 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:33:39.424807 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m05:33:39.424807 [debug] [MainThread]: Tracking: tracking
[0m05:33:39.438809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E75590EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E75590DAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E75590F700>]}
[0m05:33:39.587808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:33:39.587808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:33:39.588808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m05:33:39.595809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '376d753d-7226-43f7-abf5-e0334a767e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755BDC0D0>]}
[0m05:33:39.631810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '376d753d-7226-43f7-abf5-e0334a767e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755BA4130>]}
[0m05:33:39.632808 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:33:39.632808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376d753d-7226-43f7-abf5-e0334a767e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755BA42B0>]}
[0m05:33:39.634807 [info ] [MainThread]: 
[0m05:33:39.634807 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:33:39.636808 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:33:39.645808 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:33:39.645808 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:33:39.645808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:39.682808 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m05:33:39.683808 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:33:39.683808 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:33:39.685809 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:33:39.686808 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:33:39.687808 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:33:39.688809 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:33:39.690808 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:33:39.690808 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:33:39.690808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:33:39.703809 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:33:39.703809 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:33:39.703809 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:33:39.706809 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:33:39.707808 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:33:39.708812 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:33:39.713807 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:39.713807 [debug] [MainThread]: On master: BEGIN
[0m05:33:39.713807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:33:39.726809 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:33:39.727809 [debug] [MainThread]: Using postgres connection "master"
[0m05:33:39.727809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:33:39.740810 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:33:39.742809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376d753d-7226-43f7-abf5-e0334a767e99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755B97250>]}
[0m05:33:39.742809 [debug] [MainThread]: On master: ROLLBACK
[0m05:33:39.743843 [debug] [MainThread]: On master: Close
[0m05:33:39.744809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:33:39.744809 [info ] [MainThread]: 
[0m05:33:39.748810 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:33:39.748810 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:33:39.748810 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:33:39.748810 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:33:39.751811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:33:39.753808 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.753808 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:33:39.754809 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.754809 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:33:39.754809 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:33:39.755808 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:33:39.755808 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:33:39.755808 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:33:39.759809 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:33:39.760808 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.760808 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:33:39.761810 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.761810 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:33:39.761810 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:33:39.762808 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:33:39.762808 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:33:39.762808 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:33:39.765810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:33:39.767808 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.767808 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:33:39.767808 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.767808 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:33:39.768808 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m05:33:39.768808 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:33:39.768808 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m05:33:39.769808 [debug] [Thread-1 (]: Compiling seed.dbtpostgres.seed_full_moon_dates
[0m05:33:39.770808 [debug] [Thread-1 (]: Writing injected SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m05:33:39.771810 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.771810 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m05:33:39.771810 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.771810 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m05:33:39.772808 [debug] [Thread-1 (]: Began running node snapshot.dbtpostgres.scd_raw_listings
[0m05:33:39.772808 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.dbtpostgres.scd_raw_listings"
[0m05:33:39.772808 [debug] [Thread-1 (]: Began compiling node snapshot.dbtpostgres.scd_raw_listings
[0m05:33:39.772808 [debug] [Thread-1 (]: Compiling snapshot.dbtpostgres.scd_raw_listings
[0m05:33:39.775809 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.775809 [debug] [Thread-1 (]: Began executing node snapshot.dbtpostgres.scd_raw_listings
[0m05:33:39.776810 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.776810 [debug] [Thread-1 (]: Finished running node snapshot.dbtpostgres.scd_raw_listings
[0m05:33:39.776810 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:33:39.777809 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:33:39.777809 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:33:39.777809 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:33:39.779808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:33:39.781809 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.781809 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:33:39.782811 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.782811 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:33:39.782811 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:33:39.783810 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:33:39.783810 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:33:39.783810 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:33:39.786826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:33:39.787808 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.788809 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:33:39.788809 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.788809 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:33:39.789809 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:33:39.790809 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:33:39.791811 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:33:39.791811 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:33:39.813999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:33:39.816000 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.816000 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:33:39.816000 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.816999 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:33:39.816999 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:33:39.816999 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:33:39.817999 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:33:39.817999 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:33:39.821000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:33:39.823161 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.823161 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:33:39.823682 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.824206 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:33:39.824206 [debug] [Thread-1 (]: Began running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:33:39.824728 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:33:39.825251 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:33:39.825251 [debug] [Thread-1 (]: Compiling test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:33:39.837150 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:33:39.839143 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.839143 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:33:39.839143 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.840141 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:33:39.840141 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:33:39.840141 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:33:39.841142 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:33:39.841142 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:33:39.849142 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:33:39.851142 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.851142 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:33:39.851142 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.852145 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:33:39.852145 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:33:39.852145 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:33:39.853142 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:33:39.853142 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:33:39.857590 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:33:39.859589 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.860592 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:33:39.860592 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.860592 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:33:39.860592 [debug] [Thread-1 (]: Began running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:33:39.861589 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:33:39.861589 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:33:39.861589 [debug] [Thread-1 (]: Compiling test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:33:39.865590 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:33:39.867589 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.867589 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:33:39.867589 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.868588 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:33:39.868588 [debug] [Thread-1 (]: Began running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:33:39.868588 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:33:39.869589 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:33:39.869589 [debug] [Thread-1 (]: Compiling test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:33:39.878152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:33:39.881150 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.881150 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:33:39.881150 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.882151 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:33:39.882151 [debug] [Thread-1 (]: Began running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:33:39.882151 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:33:39.882151 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:33:39.883153 [debug] [Thread-1 (]: Compiling test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:33:39.889151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:33:39.891152 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.892152 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:33:39.892152 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.893152 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:33:39.893152 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:33:39.893152 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:33:39.894151 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:33:39.894151 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:33:39.899153 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:33:39.901151 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.901151 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:33:39.902151 [debug] [Thread-1 (]: finished collecting timing info
[0m05:33:39.902151 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:33:39.903151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:33:39.903151 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m05:33:39.904151 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:33:39.945150 [info ] [MainThread]: Done.
[0m05:33:39.945150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755D75570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755D75780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E755D74130>]}


============================== 2022-08-22 05:39:49.616345 | 88849d73-c45e-44db-b957-55e5536bb2bf ==============================
[0m05:39:49.616345 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:39:49.617384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m05:39:49.617384 [debug] [MainThread]: Tracking: tracking
[0m05:39:49.634346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC071C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC071E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC071CD30>]}
[0m05:39:49.792377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:39:49.793379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:39:49.793379 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m05:39:49.800379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88849d73-c45e-44db-b957-55e5536bb2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC09EC0D0>]}
[0m05:39:49.841026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88849d73-c45e-44db-b957-55e5536bb2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC09B01C0>]}
[0m05:39:49.841026 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m05:39:49.842026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88849d73-c45e-44db-b957-55e5536bb2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC09B0340>]}
[0m05:39:49.844030 [info ] [MainThread]: 
[0m05:39:49.845027 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:39:49.846026 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m05:39:49.856026 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:39:49.856026 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m05:39:49.856026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:49.880465 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:39:49.880465 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m05:39:49.881468 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m05:39:49.883465 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m05:39:49.884466 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m05:39:49.885466 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m05:39:49.885466 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m05:39:49.887467 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:39:49.887467 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m05:39:49.888533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:39:49.901050 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:39:49.902049 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m05:39:49.902049 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m05:39:49.904574 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m05:39:49.906576 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m05:39:49.907573 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m05:39:49.912575 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:49.912575 [debug] [MainThread]: On master: BEGIN
[0m05:39:49.912575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:39:49.925573 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:39:49.925573 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:49.926572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:39:49.939572 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m05:39:49.940574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88849d73-c45e-44db-b957-55e5536bb2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC09A72E0>]}
[0m05:39:49.941607 [debug] [MainThread]: On master: ROLLBACK
[0m05:39:49.942614 [debug] [MainThread]: On master: Close
[0m05:39:49.942614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:39:49.943615 [info ] [MainThread]: 
[0m05:39:49.947615 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m05:39:49.948614 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m05:39:49.948614 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m05:39:49.948614 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m05:39:49.951613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m05:39:49.953618 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.953618 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m05:39:49.953618 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.954618 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m05:39:49.954618 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m05:39:49.954618 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m05:39:49.955616 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m05:39:49.955616 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m05:39:49.958613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m05:39:49.960614 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.960614 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m05:39:49.960614 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.961647 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m05:39:49.961647 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m05:39:49.961647 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m05:39:49.962644 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m05:39:49.962644 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m05:39:49.964614 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m05:39:49.966578 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.966578 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m05:39:49.966578 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.967618 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m05:39:49.967618 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m05:39:49.967618 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m05:39:49.968613 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m05:39:49.968613 [debug] [Thread-1 (]: Compiling seed.dbtpostgres.seed_full_moon_dates
[0m05:39:49.970585 [debug] [Thread-1 (]: Writing injected SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m05:39:49.970585 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.970585 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m05:39:49.970585 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.971585 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m05:39:49.971585 [debug] [Thread-1 (]: Began running node snapshot.dbtpostgres.scd_raw_listings
[0m05:39:49.971585 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.dbtpostgres.scd_raw_listings"
[0m05:39:49.971585 [debug] [Thread-1 (]: Began compiling node snapshot.dbtpostgres.scd_raw_listings
[0m05:39:49.972584 [debug] [Thread-1 (]: Compiling snapshot.dbtpostgres.scd_raw_listings
[0m05:39:49.975615 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.975615 [debug] [Thread-1 (]: Began executing node snapshot.dbtpostgres.scd_raw_listings
[0m05:39:49.975615 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.975615 [debug] [Thread-1 (]: Finished running node snapshot.dbtpostgres.scd_raw_listings
[0m05:39:49.976615 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m05:39:49.976615 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m05:39:49.976615 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m05:39:49.976615 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m05:39:49.979616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m05:39:49.980586 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.981586 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m05:39:49.981586 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.981586 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m05:39:49.981586 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m05:39:49.982585 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m05:39:49.982585 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m05:39:49.982585 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m05:39:49.985619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m05:39:49.986615 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.987603 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m05:39:49.987603 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:49.987603 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m05:39:49.987603 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m05:39:49.989977 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m05:39:49.989977 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m05:39:49.989977 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m05:39:50.011493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m05:39:50.013297 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.013297 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m05:39:50.013297 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.014305 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m05:39:50.014305 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m05:39:50.015304 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m05:39:50.015304 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m05:39:50.015304 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m05:39:50.018333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m05:39:50.019329 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.020304 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m05:39:50.020304 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.020304 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m05:39:50.020304 [debug] [Thread-1 (]: Began running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:39:50.021302 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:39:50.021302 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:39:50.021302 [debug] [Thread-1 (]: Compiling test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:39:50.032333 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m05:39:50.034333 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.035306 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:39:50.035306 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.035306 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m05:39:50.035306 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:39:50.036302 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:39:50.036302 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:39:50.036302 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:39:50.044333 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m05:39:50.045333 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.046305 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:39:50.046305 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.046305 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m05:39:50.046305 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:39:50.047305 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:39:50.047305 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:39:50.047305 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:39:50.051303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m05:39:50.053303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.053303 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:39:50.054303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.054303 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m05:39:50.054303 [debug] [Thread-1 (]: Began running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:39:50.055303 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:39:50.055303 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:39:50.055303 [debug] [Thread-1 (]: Compiling test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:39:50.059302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m05:39:50.060303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.061303 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:39:50.061303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.061303 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m05:39:50.061303 [debug] [Thread-1 (]: Began running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:39:50.062303 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:39:50.062303 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:39:50.062303 [debug] [Thread-1 (]: Compiling test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:39:50.069302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m05:39:50.071303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.071303 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:39:50.072304 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.072304 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m05:39:50.072304 [debug] [Thread-1 (]: Began running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:39:50.073303 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:39:50.073303 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:39:50.073303 [debug] [Thread-1 (]: Compiling test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:39:50.079303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m05:39:50.081303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.081303 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:39:50.082303 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.082303 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m05:39:50.082303 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:39:50.083302 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:39:50.083302 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m05:39:50.083302 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m05:39:50.086304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m05:39:50.088304 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.088304 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m05:39:50.089302 [debug] [Thread-1 (]: finished collecting timing info
[0m05:39:50.089302 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m05:39:50.090303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:39:50.090303 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m05:39:50.090303 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m05:39:50.130302 [info ] [MainThread]: Done.
[0m05:39:50.195304 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
[0m05:39:50.195304 [info ] [MainThread]: Building catalog
[0m05:39:50.198303 [debug] [ThreadPool]: Acquiring new postgres connection "airbnb.information_schema"
[0m05:39:50.204303 [debug] [ThreadPool]: Using postgres connection "airbnb.information_schema"
[0m05:39:50.205303 [debug] [ThreadPool]: On airbnb.information_schema: BEGIN
[0m05:39:50.205303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:50.218304 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:39:50.219304 [debug] [ThreadPool]: Using postgres connection "airbnb.information_schema"
[0m05:39:50.219304 [debug] [ThreadPool]: On airbnb.information_schema: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "airbnb.information_schema"} */

    
    

    select
        'airbnb' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('dev') or upper(sch.nspname) = upper('dbo') or upper(sch.nspname) = upper('raw'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m05:39:50.228303 [debug] [ThreadPool]: SQL status: SELECT 75 in 0.01 seconds
[0m05:39:50.237302 [debug] [ThreadPool]: On airbnb.information_schema: ROLLBACK
[0m05:39:50.238303 [debug] [ThreadPool]: On airbnb.information_schema: Close
[0m05:39:50.280336 [info ] [MainThread]: Catalog written to D:\CMC_Project\G&M\airbyte_sqlserver_psql\dbt_postgres\target\catalog.json
[0m05:39:50.280336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC077CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC09CF6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC09CFF70>]}
[0m05:39:52.040493 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m05:39:52.041460 [debug] [MainThread]: Connection 'airbnb.information_schema' was properly closed.


============================== 2022-08-22 05:40:17.297639 | 92ec24d2-7394-4305-bbd8-0e02d2129c01 ==============================
[0m05:40:17.297639 [info ] [MainThread]: Running with dbt=1.2.0
[0m05:40:17.297639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m05:40:17.298640 [debug] [MainThread]: Tracking: tracking
[0m05:40:17.311640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE341BF370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE341BEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE341BF5B0>]}
[0m05:40:17.339640 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m05:40:17.339640 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m05:40:17.340640 [info ] [MainThread]: 
[0m05:40:17.340640 [info ] [MainThread]: 
[0m05:40:17.341640 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-08-22 06:45:02.838164 | 661a50b4-a6e8-4ccc-94f3-78b2094a4387 ==============================
[0m06:45:02.838164 [info ] [MainThread]: Running with dbt=1.2.0
[0m06:45:02.839165 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m06:45:02.839165 [debug] [MainThread]: Tracking: tracking
[0m06:45:02.858667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AFF1EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AFF1ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217AFF1DD80>]}
[0m06:45:03.155916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m06:45:03.155916 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m06:45:03.156917 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m06:45:03.156917 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m06:45:03.167916 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m06:45:03.179522 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m06:45:03.181521 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m06:45:03.182522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B01C7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B01F8C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217B01F9720>]}


============================== 2022-08-22 07:11:37.799359 | 60ba22a8-f06e-4cdd-84a3-6718be75b709 ==============================
[0m07:11:37.799359 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:11:37.800359 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m07:11:37.800359 [debug] [MainThread]: Tracking: tracking
[0m07:11:37.822359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3ADDFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3ADC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3ADD420>]}
[0m07:11:38.003359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:11:38.004359 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:11:38.004359 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:11:38.004359 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:11:38.017359 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:11:38.027360 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:11:38.029359 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:11:38.043358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m07:11:38.049359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ba22a8-f06e-4cdd-84a3-6718be75b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3DA9900>]}
[0m07:11:38.085359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ba22a8-f06e-4cdd-84a3-6718be75b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3D25AE0>]}
[0m07:11:38.085359 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:11:38.086359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ba22a8-f06e-4cdd-84a3-6718be75b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3D25AB0>]}
[0m07:11:38.088360 [info ] [MainThread]: 
[0m07:11:38.088360 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:11:38.090360 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:11:38.098359 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:11:38.099358 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:11:38.099358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:38.122359 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m07:11:38.122359 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:11:38.122359 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:11:38.139360 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.02 seconds
[0m07:11:38.140360 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:11:38.141359 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:11:38.142361 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:11:38.144359 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:11:38.144359 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:11:38.144359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:11:38.156359 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:11:38.157359 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:11:38.157359 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:11:38.159359 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:11:38.160359 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:11:38.161359 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:11:38.166359 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:38.166359 [debug] [MainThread]: On master: BEGIN
[0m07:11:38.167359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:11:38.179361 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:11:38.179361 [debug] [MainThread]: Using postgres connection "master"
[0m07:11:38.179361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:11:38.197359 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
[0m07:11:38.199360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ba22a8-f06e-4cdd-84a3-6718be75b709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3D68B80>]}
[0m07:11:38.199360 [debug] [MainThread]: On master: ROLLBACK
[0m07:11:38.200360 [debug] [MainThread]: On master: Close
[0m07:11:38.201360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:11:38.201360 [info ] [MainThread]: 
[0m07:11:38.209360 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:11:38.211362 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:11:38.211362 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:11:38.211362 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:11:38.213361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:11:38.214359 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.215358 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:11:38.215358 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.215358 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:11:38.216360 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:11:38.216360 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:11:38.216360 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:11:38.216360 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:11:38.218361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:11:38.220364 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.220364 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:11:38.221363 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.221363 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:11:38.221363 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:11:38.222360 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:11:38.222360 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:11:38.222360 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:11:38.224359 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:11:38.226359 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.226359 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:11:38.226359 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.226359 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:11:38.227358 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m07:11:38.227358 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m07:11:38.227358 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m07:11:38.228362 [debug] [Thread-1 (]: Compiling seed.dbtpostgres.seed_full_moon_dates
[0m07:11:38.229362 [debug] [Thread-1 (]: Writing injected SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m07:11:38.230362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.230362 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m07:11:38.230362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.230362 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m07:11:38.231362 [debug] [Thread-1 (]: Began running node snapshot.dbtpostgres.scd_raw_listings
[0m07:11:38.231362 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.dbtpostgres.scd_raw_listings"
[0m07:11:38.231362 [debug] [Thread-1 (]: Began compiling node snapshot.dbtpostgres.scd_raw_listings
[0m07:11:38.231362 [debug] [Thread-1 (]: Compiling snapshot.dbtpostgres.scd_raw_listings
[0m07:11:38.234361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.235362 [debug] [Thread-1 (]: Began executing node snapshot.dbtpostgres.scd_raw_listings
[0m07:11:38.235362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.235362 [debug] [Thread-1 (]: Finished running node snapshot.dbtpostgres.scd_raw_listings
[0m07:11:38.235362 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:11:38.236362 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:11:38.236362 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:11:38.236362 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:11:38.239362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:11:38.242362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.242362 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:11:38.242362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.242362 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:11:38.243360 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:11:38.243360 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:11:38.243360 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:11:38.243360 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:11:38.246362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:11:38.248358 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.248358 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:11:38.248358 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.249360 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:11:38.249360 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:11:38.250359 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:11:38.250359 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:11:38.250359 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:11:38.271361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:11:38.274359 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.274359 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:11:38.274359 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.275359 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:11:38.275359 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:11:38.275359 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:11:38.276361 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:11:38.276361 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:11:38.279362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:11:38.281360 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.281360 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:11:38.281360 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.281360 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:11:38.282360 [debug] [Thread-1 (]: Began running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:11:38.282360 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:11:38.282360 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:11:38.283373 [debug] [Thread-1 (]: Compiling test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:11:38.294362 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:11:38.297391 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.297391 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:11:38.298373 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.298373 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:11:38.298373 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:11:38.299390 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:11:38.299390 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:11:38.299390 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:11:38.308390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:11:38.311374 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.311374 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:11:38.311374 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.312360 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:11:38.312360 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:11:38.313361 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:11:38.313361 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:11:38.313361 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:11:38.317362 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:11:38.318362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.318362 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:11:38.319360 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.319360 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:11:38.319360 [debug] [Thread-1 (]: Began running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:11:38.320362 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:11:38.320362 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:11:38.320362 [debug] [Thread-1 (]: Compiling test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:11:38.324362 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:11:38.327361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.327361 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:11:38.327361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.328390 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:11:38.328390 [debug] [Thread-1 (]: Began running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:11:38.328390 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:11:38.328390 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:11:38.329362 [debug] [Thread-1 (]: Compiling test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:11:38.336362 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:11:38.337362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.338361 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:11:38.338361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.338361 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:11:38.339363 [debug] [Thread-1 (]: Began running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:11:38.339363 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:11:38.339363 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:11:38.339363 [debug] [Thread-1 (]: Compiling test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:11:38.345362 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:11:38.347218 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.347218 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:11:38.347218 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.348226 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:11:38.348226 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:11:38.348226 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:11:38.349254 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:11:38.349254 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:11:38.353254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:11:38.356045 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.356045 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:11:38.356045 [debug] [Thread-1 (]: finished collecting timing info
[0m07:11:38.357076 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:11:38.357076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:38.358047 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m07:11:38.358047 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m07:11:38.396068 [info ] [MainThread]: Done.
[0m07:11:38.397068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3E582E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3E59D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BC3E5A1A0>]}


============================== 2022-08-22 07:16:52.265662 | e2a39aa4-9f0f-4ff2-9aea-34101b723e97 ==============================
[0m07:16:52.265662 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:16:52.266632 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m07:16:52.266632 [debug] [MainThread]: Tracking: tracking
[0m07:16:52.320630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA91EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA91ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA91DD80>]}
[0m07:16:52.861008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:16:52.862008 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:16:52.862008 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:16:52.862978 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:16:52.874007 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:16:52.885007 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:16:52.887007 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:16:52.901009 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src

[0m07:16:52.906979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2a39aa4-9f0f-4ff2-9aea-34101b723e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CABE9960>]}
[0m07:16:52.941978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2a39aa4-9f0f-4ff2-9aea-34101b723e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CAB65A80>]}
[0m07:16:52.941978 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:16:52.942980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a39aa4-9f0f-4ff2-9aea-34101b723e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CA7FE2C0>]}
[0m07:16:52.944979 [info ] [MainThread]: 
[0m07:16:52.944979 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:16:52.946978 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:16:52.955007 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:16:52.955007 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:16:52.955978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:52.994619 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:16:52.995620 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:16:52.995620 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:16:53.003621 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m07:16:53.004621 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:16:53.005620 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:16:53.006619 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:16:53.008623 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:16:53.008623 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:16:53.009621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:53.035741 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m07:16:53.036739 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:16:53.036739 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:16:53.038737 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:16:53.039739 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:16:53.040738 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:16:53.045737 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:53.045737 [debug] [MainThread]: On master: BEGIN
[0m07:16:53.045737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:53.058736 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:16:53.059739 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:53.059739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:53.072737 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:16:53.073738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a39aa4-9f0f-4ff2-9aea-34101b723e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CABAB250>]}
[0m07:16:53.074738 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:53.075737 [debug] [MainThread]: On master: Close
[0m07:16:53.075737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:53.076738 [info ] [MainThread]: 
[0m07:16:53.083444 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:16:53.085443 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:16:53.085443 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:16:53.085443 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:16:53.087444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:16:53.089442 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.089442 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:16:53.089442 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.089442 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:16:53.090444 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:16:53.090966 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:16:53.090966 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:16:53.090966 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:16:53.092972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:16:53.093971 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.094974 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:16:53.094974 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.094974 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:16:53.094974 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:16:53.095973 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:16:53.095973 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:16:53.095973 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:16:53.097972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:16:53.100004 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.100004 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:16:53.100004 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.100004 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:16:53.101002 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m07:16:53.101002 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m07:16:53.101002 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m07:16:53.101002 [debug] [Thread-1 (]: Compiling seed.dbtpostgres.seed_full_moon_dates
[0m07:16:53.103002 [debug] [Thread-1 (]: Writing injected SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m07:16:53.103002 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.103002 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m07:16:53.103971 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.103971 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m07:16:53.103971 [debug] [Thread-1 (]: Began running node snapshot.dbtpostgres.scd_raw_listings
[0m07:16:53.104972 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.dbtpostgres.scd_raw_listings"
[0m07:16:53.104972 [debug] [Thread-1 (]: Began compiling node snapshot.dbtpostgres.scd_raw_listings
[0m07:16:53.104972 [debug] [Thread-1 (]: Compiling snapshot.dbtpostgres.scd_raw_listings
[0m07:16:53.107972 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.107972 [debug] [Thread-1 (]: Began executing node snapshot.dbtpostgres.scd_raw_listings
[0m07:16:53.107972 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.108972 [debug] [Thread-1 (]: Finished running node snapshot.dbtpostgres.scd_raw_listings
[0m07:16:53.108972 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:16:53.108972 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:16:53.108972 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:16:53.109972 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:16:53.112972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:16:53.115004 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.115004 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:16:53.115004 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.115004 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:16:53.115975 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:16:53.115975 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:16:53.115975 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:16:53.115975 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:16:53.118972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:16:53.120898 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.120898 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:16:53.120898 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.121937 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:16:53.121937 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:16:53.121937 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:16:53.122937 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:16:53.122937 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:16:53.142903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:16:53.144903 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.144903 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:16:53.144903 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.145903 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:16:53.145903 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:16:53.146904 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:16:53.146904 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:16:53.146904 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:16:53.149904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:16:53.150938 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.151904 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:16:53.151904 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.151904 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:16:53.151904 [debug] [Thread-1 (]: Began running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:16:53.152937 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:16:53.152937 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:16:53.152937 [debug] [Thread-1 (]: Compiling test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:16:53.163935 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:16:53.165904 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.166904 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:16:53.166904 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.166904 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:16:53.167935 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:16:53.167935 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:16:53.167935 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:16:53.167935 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:16:53.176912 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:16:53.178905 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.178905 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:16:53.178905 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.178905 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:16:53.179905 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:16:53.179905 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:16:53.179905 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:16:53.179905 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:16:53.183934 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:16:53.184935 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.184935 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:16:53.185904 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.185904 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:16:53.185904 [debug] [Thread-1 (]: Began running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:16:53.186937 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:16:53.186937 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:16:53.186937 [debug] [Thread-1 (]: Compiling test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:16:53.190936 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:16:53.191903 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.192905 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:16:53.192905 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.192905 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:16:53.193937 [debug] [Thread-1 (]: Began running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:16:53.193937 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:16:53.193937 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:16:53.193937 [debug] [Thread-1 (]: Compiling test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:16:53.201904 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:16:53.203379 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.203379 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:16:53.203379 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.204387 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:16:53.204387 [debug] [Thread-1 (]: Began running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:16:53.204387 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:16:53.205416 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:16:53.205416 [debug] [Thread-1 (]: Compiling test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:16:53.210416 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:16:53.212386 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.212386 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:16:53.212386 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.213386 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:16:53.213386 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:16:53.213386 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:16:53.213386 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:16:53.214385 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:16:53.218385 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:16:53.219691 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.219691 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:16:53.219691 [debug] [Thread-1 (]: finished collecting timing info
[0m07:16:53.220731 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:16:53.221698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:16:53.221698 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m07:16:53.221698 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m07:16:53.258698 [info ] [MainThread]: Done.
[0m07:16:53.258698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CAC99DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CAC99540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6CAC98460>]}


============================== 2022-08-22 07:22:34.802252 | d542a49e-50bf-44b3-8a07-e1415c1684ee ==============================
[0m07:22:34.802252 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:22:34.803252 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m07:22:34.803252 [debug] [MainThread]: Tracking: tracking
[0m07:22:34.820253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859429EC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859429DAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001859429F700>]}
[0m07:22:34.986251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:22:34.987253 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:22:34.987253 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:22:34.987253 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:22:35.000252 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:22:35.010253 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:22:35.012253 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:22:35.026251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src

[0m07:22:35.032252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd542a49e-50bf-44b3-8a07-e1415c1684ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018594569990>]}
[0m07:22:35.068254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd542a49e-50bf-44b3-8a07-e1415c1684ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185944E9C30>]}
[0m07:22:35.068254 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:22:35.069251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd542a49e-50bf-44b3-8a07-e1415c1684ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185944E9C00>]}
[0m07:22:35.071257 [info ] [MainThread]: 
[0m07:22:35.071257 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:22:35.073135 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:22:35.081982 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:22:35.081982 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:22:35.081982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:35.107150 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m07:22:35.107150 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:22:35.108150 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:22:35.124447 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.02 seconds
[0m07:22:35.125446 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:22:35.126445 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:22:35.127447 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:22:35.129447 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:22:35.129447 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:22:35.129447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:35.142276 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:22:35.142276 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:22:35.143276 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:22:35.145274 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:22:35.146276 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:22:35.147275 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:22:35.152274 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:35.152274 [debug] [MainThread]: On master: BEGIN
[0m07:22:35.152274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:22:35.165861 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:22:35.165861 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:35.166861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:22:35.184366 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
[0m07:22:35.185367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd542a49e-50bf-44b3-8a07-e1415c1684ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018594527220>]}
[0m07:22:35.185367 [debug] [MainThread]: On master: ROLLBACK
[0m07:22:35.186366 [debug] [MainThread]: On master: Close
[0m07:22:35.187366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:22:35.187366 [info ] [MainThread]: 
[0m07:22:35.191366 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:22:35.193368 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:22:35.193368 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:22:35.193368 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:22:35.195368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:22:35.196367 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.197366 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:22:35.197366 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.197366 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:22:35.198367 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:22:35.198367 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:22:35.198367 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:22:35.198367 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:22:35.200368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:22:35.202365 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.202365 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:22:35.202365 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.202365 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:22:35.203366 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:22:35.203366 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:22:35.203366 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:22:35.204368 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:22:35.205369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:22:35.207192 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.207192 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:22:35.207192 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.208229 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:22:35.208229 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m07:22:35.208229 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m07:22:35.209233 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m07:22:35.209233 [debug] [Thread-1 (]: Compiling seed.dbtpostgres.seed_full_moon_dates
[0m07:22:35.210230 [debug] [Thread-1 (]: Writing injected SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m07:22:35.211229 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.211229 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m07:22:35.211229 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.211229 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m07:22:35.212238 [debug] [Thread-1 (]: Began running node snapshot.dbtpostgres.scd_raw_listings
[0m07:22:35.212238 [debug] [Thread-1 (]: Acquiring new postgres connection "snapshot.dbtpostgres.scd_raw_listings"
[0m07:22:35.212238 [debug] [Thread-1 (]: Began compiling node snapshot.dbtpostgres.scd_raw_listings
[0m07:22:35.212238 [debug] [Thread-1 (]: Compiling snapshot.dbtpostgres.scd_raw_listings
[0m07:22:35.215229 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.215229 [debug] [Thread-1 (]: Began executing node snapshot.dbtpostgres.scd_raw_listings
[0m07:22:35.216234 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.216234 [debug] [Thread-1 (]: Finished running node snapshot.dbtpostgres.scd_raw_listings
[0m07:22:35.216234 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:22:35.217224 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:22:35.217224 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:22:35.217224 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:22:35.220230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:22:35.222201 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.222201 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:22:35.222201 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.223199 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:22:35.223199 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:22:35.223199 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:22:35.224218 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:22:35.224218 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:22:35.226231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:22:35.228198 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.228198 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:22:35.228198 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.229230 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:22:35.229230 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:22:35.229230 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:22:35.230198 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:22:35.230198 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:22:35.251200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:22:35.253232 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.253232 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:22:35.254220 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.254220 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:22:35.254220 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:22:35.255290 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:22:35.255290 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:22:35.255290 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:22:35.258328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:22:35.260299 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.260388 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:22:35.260388 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.260951 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:22:35.261555 [debug] [Thread-1 (]: Began running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:35.261799 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:22:35.261799 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:35.262307 [debug] [Thread-1 (]: Compiling test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:35.273346 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m07:22:35.275317 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.275317 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:35.275317 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.275317 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m07:22:35.276317 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:35.276317 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:22:35.276317 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:35.276317 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:35.285314 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m07:22:35.287316 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.287316 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:35.287316 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.287316 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_host_id.084e4105be
[0m07:22:35.288317 [debug] [Thread-1 (]: Began running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:35.288317 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:22:35.288317 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:35.288317 [debug] [Thread-1 (]: Compiling test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:35.292316 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m07:22:35.293315 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.294316 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:35.294316 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.294316 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m07:22:35.295317 [debug] [Thread-1 (]: Began running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:35.295317 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:22:35.295317 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:35.295317 [debug] [Thread-1 (]: Compiling test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:35.299313 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313"
[0m07:22:35.301315 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.301315 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:35.301315 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.301315 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313
[0m07:22:35.302315 [debug] [Thread-1 (]: Began running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:35.302315 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:22:35.302315 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:35.302315 [debug] [Thread-1 (]: Compiling test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:35.309313 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m07:22:35.311315 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.311315 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:35.312317 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.312317 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m07:22:35.312317 [debug] [Thread-1 (]: Began running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:35.313314 [debug] [Thread-1 (]: Acquiring new postgres connection "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:22:35.313314 [debug] [Thread-1 (]: Began compiling node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:35.313314 [debug] [Thread-1 (]: Compiling test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:35.318314 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m07:22:35.320314 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.320314 [debug] [Thread-1 (]: Began executing node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:35.320314 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.321315 [debug] [Thread-1 (]: Finished running node test.dbtpostgres.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m07:22:35.321315 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:35.321315 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:22:35.322315 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:35.322315 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:35.325313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:22:35.327314 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.328314 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:35.328314 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:35.328314 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:35.329315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:35.329315 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m07:22:35.329315 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m07:22:35.366315 [info ] [MainThread]: Done.
[0m07:22:35.367318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018594615E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018594615510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018594615690>]}


============================== 2022-08-22 07:22:44.850522 | 7e322aed-27e2-4527-b27b-1d8121281245 ==============================
[0m07:22:44.850522 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:22:44.850522 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:22:44.851523 [debug] [MainThread]: Tracking: tracking
[0m07:22:44.863522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EA7C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EA7E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EA7CD30>]}
[0m07:22:45.009552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:22:45.009552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:22:45.010555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m07:22:45.016521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133ED4C0D0>]}
[0m07:22:45.053790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133ED14160>]}
[0m07:22:45.053790 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:22:45.053790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133E95E590>]}
[0m07:22:45.055826 [info ] [MainThread]: 
[0m07:22:45.056791 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:22:45.057821 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:22:45.066790 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:22:45.066790 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:22:45.066790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:45.084792 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.02 seconds
[0m07:22:45.086791 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:22:45.088792 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:22:45.093790 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:22:45.093790 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:22:45.094791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:22:45.108183 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:22:45.108183 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:22:45.109186 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:22:45.111187 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:22:45.112186 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:22:45.113186 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:22:45.113186 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:22:45.116186 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:22:45.116186 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:22:45.116186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:22:45.128440 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:22:45.129439 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:22:45.129439 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:22:45.131438 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:22:45.132440 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:22:45.133441 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:22:45.138440 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:45.138440 [debug] [MainThread]: On master: BEGIN
[0m07:22:45.138440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:22:45.151802 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:22:45.151802 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:45.151802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:22:45.165799 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:22:45.166830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133ED078E0>]}
[0m07:22:45.166830 [debug] [MainThread]: On master: ROLLBACK
[0m07:22:45.167800 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:45.167800 [debug] [MainThread]: On master: BEGIN
[0m07:22:45.169800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:22:45.169800 [debug] [MainThread]: On master: COMMIT
[0m07:22:45.170799 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:45.170799 [debug] [MainThread]: On master: COMMIT
[0m07:22:45.170799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:22:45.171799 [debug] [MainThread]: On master: Close
[0m07:22:45.171799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:22:45.172673 [info ] [MainThread]: 
[0m07:22:45.175459 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:22:45.175459 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:22:45.176465 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:22:45.176465 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:22:45.176465 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:22:45.179463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:22:45.181464 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:45.181464 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:22:45.211518 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:22:45.214466 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:22:45.214466 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:22:45.214466 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:22:45.238662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:22:45.239662 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:22:45.239662 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_hosts"
)
SELECT
    RENAME COLUMN ID TO host_id,
    RENAME COLUMN NAME TO host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:22:45.240665 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ID"
LINE 11:     RENAME COLUMN ID TO host_id,
                           ^

[0m07:22:45.240665 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:22:45.241661 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:45.241661 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:22:45.242661 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  syntax error at or near "ID"
  LINE 11:     RENAME COLUMN ID TO host_id,
                             ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:22:45.242661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EED1B10>]}
[0m07:22:45.242661 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.07s]
[0m07:22:45.243661 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:22:45.243661 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:22:45.244661 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:22:45.244661 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:22:45.245661 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:22:45.245661 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:22:45.247661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:22:45.248661 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:45.249662 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:22:45.252661 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:22:45.254661 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:22:45.254661 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:22:45.255661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:45.268661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:22:45.268661 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:22:45.268661 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_listings"
)
SELECT
    RENAME COLUMN ID TO listing_id,
    RENAME COLUMN NAME TO listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:22:45.269663 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "ID"
LINE 11:     RENAME COLUMN ID TO listing_id,
                           ^

[0m07:22:45.269663 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:22:45.270661 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:45.270661 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:22:45.271661 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  syntax error at or near "ID"
  LINE 11:     RENAME COLUMN ID TO listing_id,
                             ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:22:45.271661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EF040A0>]}
[0m07:22:45.271661 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.03s]
[0m07:22:45.272661 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:22:45.272661 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:22:45.273661 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:22:45.273661 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:22:45.274661 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:22:45.274661 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:22:45.276660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:22:45.277660 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:45.278662 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:22:45.282661 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:22:45.284662 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:22:45.284662 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:22:45.284662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:22:45.316213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:22:45.317212 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:22:45.317212 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_reviews"
)
SELECT
    listing_id,
    RENAME COLUMN DATE TO review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:22:45.318212 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "DATE"
LINE 12:     RENAME COLUMN DATE TO review_date,
                           ^

[0m07:22:45.318212 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:22:45.319213 [debug] [Thread-1 (]: finished collecting timing info
[0m07:22:45.319213 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:22:45.319213 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  syntax error at or near "DATE"
  LINE 12:     RENAME COLUMN DATE TO review_date,
                             ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:22:45.319213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e322aed-27e2-4527-b27b-1d8121281245', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EED51B0>]}
[0m07:22:45.320213 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.05s]
[0m07:22:45.320213 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:22:45.321213 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:22:45.321213 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:22:45.322213 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:22:45.322213 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:22:45.322213 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:22:45.323212 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:22:45.323212 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:22:45.323212 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:22:45.324214 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:22:45.324214 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:22:45.324214 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:22:45.325213 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:22:45.325213 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:45.325213 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:22:45.326212 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:22:45.327213 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:22:45.327213 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:45.327213 [debug] [MainThread]: On master: BEGIN
[0m07:22:45.327213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:22:45.340213 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:22:45.341213 [debug] [MainThread]: On master: COMMIT
[0m07:22:45.341213 [debug] [MainThread]: Using postgres connection "master"
[0m07:22:45.341213 [debug] [MainThread]: On master: COMMIT
[0m07:22:45.342213 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:22:45.342213 [debug] [MainThread]: On master: Close
[0m07:22:45.342213 [info ] [MainThread]: 
[0m07:22:45.343213 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:22:45.343213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:22:45.343213 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:22:45.344213 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m07:22:45.344213 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:22:45.386226 [info ] [MainThread]: 
[0m07:22:45.387226 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:22:45.388226 [info ] [MainThread]: 
[0m07:22:45.388226 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:22:45.389226 [error] [MainThread]:   syntax error at or near "ID"
[0m07:22:45.389226 [error] [MainThread]:   LINE 11:     RENAME COLUMN ID TO host_id,
[0m07:22:45.390226 [error] [MainThread]:                              ^
[0m07:22:45.390226 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:22:45.391225 [info ] [MainThread]: 
[0m07:22:45.391225 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:22:45.392226 [error] [MainThread]:   syntax error at or near "ID"
[0m07:22:45.392226 [error] [MainThread]:   LINE 11:     RENAME COLUMN ID TO listing_id,
[0m07:22:45.392226 [error] [MainThread]:                              ^
[0m07:22:45.393226 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:22:45.393226 [info ] [MainThread]: 
[0m07:22:45.393226 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:22:45.394227 [error] [MainThread]:   syntax error at or near "DATE"
[0m07:22:45.394227 [error] [MainThread]:   LINE 12:     RENAME COLUMN DATE TO review_date,
[0m07:22:45.395227 [error] [MainThread]:                              ^
[0m07:22:45.395227 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:22:45.395227 [info ] [MainThread]: 
[0m07:22:45.396226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:22:45.396226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133ED052D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EEB1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133EE710C0>]}


============================== 2022-08-22 07:24:38.617878 | e9d008c6-e57d-451b-b43f-68a1708adf2a ==============================
[0m07:24:38.617878 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:24:38.618879 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:24:38.618879 [debug] [MainThread]: Tracking: tracking
[0m07:24:38.633879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A36EEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A36EECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A36EDD80>]}
[0m07:24:38.790917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:24:38.790917 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:24:38.791917 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:24:38.791917 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:24:38.805918 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:24:38.816918 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:24:38.818918 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:24:38.835916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m07:24:38.841917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A39B9960>]}
[0m07:24:38.879917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3935B70>]}
[0m07:24:38.880917 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:24:38.880917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A35CDC60>]}
[0m07:24:38.881918 [info ] [MainThread]: 
[0m07:24:38.882918 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:24:38.883918 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:24:38.892916 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:24:38.892916 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:24:38.892916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:38.930587 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.04 seconds
[0m07:24:38.931590 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:24:38.933588 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:24:38.938587 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:24:38.939586 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:24:38.939586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:38.975502 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:24:38.976510 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:24:38.976510 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:24:38.978510 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:24:38.979508 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:24:38.980508 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:24:38.980508 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:24:38.983508 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:24:38.983508 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:24:38.983508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:38.996509 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:24:38.996509 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:24:38.996509 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:24:38.999506 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:24:39.000509 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:24:39.001509 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:24:39.006506 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:39.006506 [debug] [MainThread]: On master: BEGIN
[0m07:24:39.007508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:24:39.019508 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:24:39.019508 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:39.020511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:24:39.033507 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:24:39.035510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3A130D0>]}
[0m07:24:39.035510 [debug] [MainThread]: On master: ROLLBACK
[0m07:24:39.036507 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:39.036507 [debug] [MainThread]: On master: BEGIN
[0m07:24:39.037509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:24:39.038510 [debug] [MainThread]: On master: COMMIT
[0m07:24:39.038510 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:39.038510 [debug] [MainThread]: On master: COMMIT
[0m07:24:39.039197 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:24:39.039197 [debug] [MainThread]: On master: Close
[0m07:24:39.040204 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:24:39.040204 [info ] [MainThread]: 
[0m07:24:39.043204 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:24:39.044209 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:24:39.044209 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:24:39.045205 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:24:39.045205 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:24:39.047202 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:24:39.049205 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:39.049205 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:24:39.080202 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:24:39.082147 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:24:39.082147 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:24:39.082147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:24:39.119319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:24:39.119319 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:24:39.119319 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_hosts"
)
RENAME COLUMN ID TO host_id,
RENAME COLUMN NAME TO host_name,
SELECT
    host_id,
    host_name
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:24:39.120320 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "RENAME"
LINE 10: RENAME COLUMN ID TO host_id,
         ^

[0m07:24:39.121320 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:24:39.122320 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:39.122320 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:24:39.122320 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  syntax error at or near "RENAME"
  LINE 10: RENAME COLUMN ID TO host_id,
           ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:24:39.122320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3A7C070>]}
[0m07:24:39.123321 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.08s]
[0m07:24:39.124319 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:24:39.124319 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:24:39.124319 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:24:39.125321 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:24:39.125321 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:24:39.125321 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:24:39.127317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:24:39.129319 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:39.129319 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:24:39.133318 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:24:39.135348 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:24:39.135348 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:24:39.135348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:39.164996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:24:39.166002 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:24:39.166002 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_listings"
)
RENAME COLUMN ID TO listing_id,
RENAME COLUMN NAME TO listing_name,
SELECT
    listing_id,
    listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:24:39.167005 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "RENAME"
LINE 10: RENAME COLUMN ID TO listing_id,
         ^

[0m07:24:39.167005 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:24:39.168002 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:39.168002 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:24:39.168002 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  syntax error at or near "RENAME"
  LINE 10: RENAME COLUMN ID TO listing_id,
           ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:24:39.169001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3A4FEB0>]}
[0m07:24:39.169001 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.04s]
[0m07:24:39.170002 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:24:39.170002 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:24:39.171001 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:24:39.171001 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:24:39.171001 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:24:39.172002 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:24:39.173000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:24:39.175002 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:39.175002 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:24:39.179003 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:24:39.180004 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:24:39.181003 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:24:39.181003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:39.193717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:24:39.193717 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:24:39.194718 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_reviews"
)
RENAME COLUMN DATE TO review_date,
SELECT
    listing_id,
    review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:24:39.194718 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "RENAME"
LINE 10: RENAME COLUMN DATE TO review_date,
         ^

[0m07:24:39.195717 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:24:39.195717 [debug] [Thread-1 (]: finished collecting timing info
[0m07:24:39.195717 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:24:39.196717 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  syntax error at or near "RENAME"
  LINE 10: RENAME COLUMN DATE TO review_date,
           ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:24:39.196717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9d008c6-e57d-451b-b43f-68a1708adf2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3A99690>]}
[0m07:24:39.196717 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:24:39.197717 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:24:39.197717 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:24:39.198717 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:24:39.198717 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:24:39.199717 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:24:39.199717 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:24:39.199717 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:24:39.200717 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:24:39.200717 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:24:39.200717 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:24:39.201717 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:24:39.201717 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:24:39.201717 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:24:39.202716 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:24:39.202716 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:24:39.202716 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:24:39.203717 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:24:39.203717 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:39.204718 [debug] [MainThread]: On master: BEGIN
[0m07:24:39.204718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:24:39.216717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:24:39.217718 [debug] [MainThread]: On master: COMMIT
[0m07:24:39.217718 [debug] [MainThread]: Using postgres connection "master"
[0m07:24:39.217718 [debug] [MainThread]: On master: COMMIT
[0m07:24:39.218717 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:24:39.218717 [debug] [MainThread]: On master: Close
[0m07:24:39.218717 [info ] [MainThread]: 
[0m07:24:39.219717 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:24:39.219717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:39.219717 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:24:39.220717 [debug] [MainThread]: Connection 'list_airbnb_dbo' was properly closed.
[0m07:24:39.220717 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:24:39.258719 [info ] [MainThread]: 
[0m07:24:39.259492 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:24:39.259492 [info ] [MainThread]: 
[0m07:24:39.260499 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:24:39.261178 [error] [MainThread]:   syntax error at or near "RENAME"
[0m07:24:39.261178 [error] [MainThread]:   LINE 10: RENAME COLUMN ID TO host_id,
[0m07:24:39.262184 [error] [MainThread]:            ^
[0m07:24:39.262184 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:24:39.262184 [info ] [MainThread]: 
[0m07:24:39.263183 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:24:39.263183 [error] [MainThread]:   syntax error at or near "RENAME"
[0m07:24:39.263183 [error] [MainThread]:   LINE 10: RENAME COLUMN ID TO listing_id,
[0m07:24:39.264183 [error] [MainThread]:            ^
[0m07:24:39.264183 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:24:39.265184 [info ] [MainThread]: 
[0m07:24:39.265184 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:24:39.265184 [error] [MainThread]:   syntax error at or near "RENAME"
[0m07:24:39.266183 [error] [MainThread]:   LINE 10: RENAME COLUMN DATE TO review_date,
[0m07:24:39.266183 [error] [MainThread]:            ^
[0m07:24:39.266183 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:24:39.267183 [info ] [MainThread]: 
[0m07:24:39.267183 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:24:39.268184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A397BDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3A0B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210A3A1EB90>]}


============================== 2022-08-22 07:29:01.686261 | 1b0e766c-3cea-47c8-b8bb-fb7aa8f13645 ==============================
[0m07:29:01.686261 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:29:01.687261 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:29:01.687261 [debug] [MainThread]: Tracking: tracking
[0m07:29:01.700261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A05DFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A05C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A05D420>]}
[0m07:29:01.844306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:29:01.844306 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:29:01.845294 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:29:01.845294 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:29:01.856293 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:29:01.866289 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:29:01.868294 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:29:01.883262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src

[0m07:29:01.888261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A329900>]}
[0m07:29:01.925262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A2A5AE0>]}
[0m07:29:01.925262 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:29:01.925262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A2A5AB0>]}
[0m07:29:01.927262 [info ] [MainThread]: 
[0m07:29:01.927881 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:29:01.928920 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:29:01.936889 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:29:01.937886 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:29:01.937886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:01.973298 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.04 seconds
[0m07:29:01.974297 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:29:01.975298 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:29:01.981297 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:29:01.981297 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:29:01.981297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:02.017930 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:29:02.018958 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:29:02.018958 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:29:02.025929 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.01 seconds
[0m07:29:02.026930 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:29:02.027930 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:29:02.027930 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:29:02.030931 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:29:02.030931 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:29:02.030931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:02.044000 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:29:02.044000 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:29:02.044000 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:29:02.047001 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:29:02.047999 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:29:02.047999 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:29:02.052998 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:02.054000 [debug] [MainThread]: On master: BEGIN
[0m07:29:02.054000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:02.079668 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m07:29:02.079668 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:02.079668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:02.117681 [debug] [MainThread]: SQL status: SELECT 7 in 0.04 seconds
[0m07:29:02.120708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A373DF0>]}
[0m07:29:02.120708 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:02.123217 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:02.123217 [debug] [MainThread]: On master: BEGIN
[0m07:29:02.126237 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:29:02.126237 [debug] [MainThread]: On master: COMMIT
[0m07:29:02.127204 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:02.127204 [debug] [MainThread]: On master: COMMIT
[0m07:29:02.129202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:29:02.129202 [debug] [MainThread]: On master: Close
[0m07:29:02.130202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:29:02.131202 [info ] [MainThread]: 
[0m07:29:02.136835 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:29:02.137835 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:29:02.138833 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:29:02.138833 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:29:02.139835 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:29:02.142870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:29:02.145866 [debug] [Thread-1 (]: finished collecting timing info
[0m07:29:02.146842 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:29:02.191862 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:29:02.193833 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:29:02.193833 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:29:02.193833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:29:02.222833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:29:02.222833 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:29:02.222833 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_hosts"
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:29:02.224864 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_hosts"
LINE 8:     "postgres"."dbo"."raw_hosts"
            ^

[0m07:29:02.224864 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:29:02.225832 [debug] [Thread-1 (]: finished collecting timing info
[0m07:29:02.225832 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:29:02.225832 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  cross-database references are not implemented: "postgres.dbo.raw_hosts"
  LINE 8:     "postgres"."dbo"."raw_hosts"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:29:02.226832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A3DA590>]}
[0m07:29:02.226832 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.09s]
[0m07:29:02.227832 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:29:02.227832 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:29:02.228832 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:29:02.228832 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:29:02.228832 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:29:02.229833 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:29:02.230832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:29:02.236837 [debug] [Thread-1 (]: finished collecting timing info
[0m07:29:02.237848 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:29:02.255890 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:29:02.262891 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:29:02.262891 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:29:02.263835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:02.314517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m07:29:02.315549 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:29:02.315549 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_listings"
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:29:02.318520 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_listings"
LINE 8:     "postgres"."dbo"."raw_listings"
            ^

[0m07:29:02.318520 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:29:02.320517 [debug] [Thread-1 (]: finished collecting timing info
[0m07:29:02.321516 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:29:02.321516 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  cross-database references are not implemented: "postgres.dbo.raw_listings"
  LINE 8:     "postgres"."dbo"."raw_listings"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:29:02.322515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A3EA860>]}
[0m07:29:02.322515 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.09s]
[0m07:29:02.323514 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:29:02.323514 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:29:02.324513 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:29:02.324513 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:29:02.324513 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:29:02.325514 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:29:02.327514 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:29:02.328514 [debug] [Thread-1 (]: finished collecting timing info
[0m07:29:02.328514 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:29:02.332514 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:29:02.334513 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:29:02.335511 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:29:02.335511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:02.364513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:29:02.365512 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:29:02.365512 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_reviews"
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:29:02.366512 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_reviews"
LINE 8:     "postgres"."dbo"."raw_reviews"
            ^

[0m07:29:02.367511 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:29:02.368512 [debug] [Thread-1 (]: finished collecting timing info
[0m07:29:02.368512 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:29:02.368512 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  cross-database references are not implemented: "postgres.dbo.raw_reviews"
  LINE 8:     "postgres"."dbo"."raw_reviews"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:29:02.369515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b0e766c-3cea-47c8-b8bb-fb7aa8f13645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A40D6F0>]}
[0m07:29:02.369515 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.05s]
[0m07:29:02.370512 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:29:02.370512 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:29:02.371513 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:29:02.371513 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:29:02.372512 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:29:02.372512 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:29:02.373513 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:29:02.373513 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:29:02.373513 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:29:02.374512 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:29:02.374512 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:29:02.374512 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:29:02.375512 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:29:02.375512 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:29:02.376514 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:29:02.376514 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:29:02.377512 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:29:02.377512 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:02.377512 [debug] [MainThread]: On master: BEGIN
[0m07:29:02.378512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:29:02.392512 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:29:02.392512 [debug] [MainThread]: On master: COMMIT
[0m07:29:02.392512 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:02.393515 [debug] [MainThread]: On master: COMMIT
[0m07:29:02.393515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:29:02.394512 [debug] [MainThread]: On master: Close
[0m07:29:02.394512 [info ] [MainThread]: 
[0m07:29:02.395512 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m07:29:02.395512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:02.396514 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:29:02.396514 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m07:29:02.396514 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:29:02.436511 [info ] [MainThread]: 
[0m07:29:02.436511 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:29:02.437513 [info ] [MainThread]: 
[0m07:29:02.438511 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:29:02.438511 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_hosts"
[0m07:29:02.439511 [error] [MainThread]:   LINE 8:     "postgres"."dbo"."raw_hosts"
[0m07:29:02.439511 [error] [MainThread]:               ^
[0m07:29:02.439511 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:29:02.440511 [info ] [MainThread]: 
[0m07:29:02.440511 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:29:02.441510 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_listings"
[0m07:29:02.441510 [error] [MainThread]:   LINE 8:     "postgres"."dbo"."raw_listings"
[0m07:29:02.441510 [error] [MainThread]:               ^
[0m07:29:02.442513 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:29:02.442513 [info ] [MainThread]: 
[0m07:29:02.443510 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:29:02.443510 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_reviews"
[0m07:29:02.444512 [error] [MainThread]:   LINE 8:     "postgres"."dbo"."raw_reviews"
[0m07:29:02.444512 [error] [MainThread]:               ^
[0m07:29:02.444512 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:29:02.445511 [info ] [MainThread]: 
[0m07:29:02.445511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:29:02.446510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A2ED390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A37A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A91A3815A0>]}


============================== 2022-08-22 07:30:07.432610 | 0affae05-20ad-45d8-b46f-bef8ca060c02 ==============================
[0m07:30:07.432610 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:30:07.433611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:30:07.433611 [debug] [MainThread]: Tracking: tracking
[0m07:30:07.446611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5A9C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5A9E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5A9CD30>]}
[0m07:30:07.588610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:07.589610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:07.589610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m07:30:07.596580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5D6C0D0>]}
[0m07:30:07.632610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5D34160>]}
[0m07:30:07.633616 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:30:07.633616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B597E2C0>]}
[0m07:30:07.635613 [info ] [MainThread]: 
[0m07:30:07.635613 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:30:07.637617 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:30:07.646610 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:30:07.646610 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:30:07.646610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.674294 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.03 seconds
[0m07:30:07.675295 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:30:07.677295 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:30:07.682295 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:30:07.682295 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:30:07.682295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:07.719692 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:30:07.719692 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:30:07.719692 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:30:07.722690 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:30:07.723693 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:30:07.724692 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:30:07.724692 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:30:07.726693 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:30:07.727693 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:30:07.727693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:07.740077 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:30:07.741085 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:30:07.741085 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:30:07.743081 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:30:07.744085 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:30:07.745083 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:30:07.749082 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.749082 [debug] [MainThread]: On master: BEGIN
[0m07:30:07.750082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:07.767084 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m07:30:07.768084 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.768084 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:07.781084 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:30:07.782084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5D2B8E0>]}
[0m07:30:07.783083 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:07.784084 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.784084 [debug] [MainThread]: On master: BEGIN
[0m07:30:07.785084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:30:07.785084 [debug] [MainThread]: On master: COMMIT
[0m07:30:07.785084 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.786084 [debug] [MainThread]: On master: COMMIT
[0m07:30:07.786084 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:30:07.787084 [debug] [MainThread]: On master: Close
[0m07:30:07.787084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:07.787084 [info ] [MainThread]: 
[0m07:30:07.791084 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:30:07.791084 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:30:07.792084 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:30:07.792084 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:30:07.792084 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:30:07.795083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:30:07.796084 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:07.796084 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:30:07.829082 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:30:07.831082 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:30:07.831082 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:30:07.831082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:30:07.844083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:30:07.844083 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:30:07.844083 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_hosts"
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:30:07.845082 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_hosts"
LINE 8:     "postgres"."dbo"."raw_hosts"
            ^

[0m07:30:07.846082 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:30:07.846082 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:07.847082 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:30:07.847082 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  cross-database references are not implemented: "postgres.dbo.raw_hosts"
  LINE 8:     "postgres"."dbo"."raw_hosts"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:30:07.847082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5EF1B10>]}
[0m07:30:07.848083 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.06s]
[0m07:30:07.848083 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:30:07.849083 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:30:07.849083 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:30:07.850085 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:30:07.850085 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:30:07.850085 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:30:07.852082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:30:07.854083 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:07.854083 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:30:07.858082 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:30:07.859082 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:30:07.859082 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:30:07.860082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:07.872083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:30:07.872083 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:30:07.873083 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_listings"
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:30:07.873083 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_listings"
LINE 8:     "postgres"."dbo"."raw_listings"
            ^

[0m07:30:07.874082 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:30:07.874082 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:07.875082 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:30:07.875082 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  cross-database references are not implemented: "postgres.dbo.raw_listings"
  LINE 8:     "postgres"."dbo"."raw_listings"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:30:07.875082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5F280A0>]}
[0m07:30:07.876083 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.02s]
[0m07:30:07.876083 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:30:07.877082 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:30:07.877082 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:30:07.878084 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:30:07.878084 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:30:07.878084 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:30:07.880083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:30:07.882085 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:07.882085 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:30:07.887084 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:30:07.888083 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:30:07.889084 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:30:07.889084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:07.903082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:30:07.903082 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:30:07.903082 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."raw_reviews"
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:30:07.904083 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_reviews"
LINE 8:     "postgres"."dbo"."raw_reviews"
            ^

[0m07:30:07.904083 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:30:07.905083 [debug] [Thread-1 (]: finished collecting timing info
[0m07:30:07.905083 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:30:07.906083 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  cross-database references are not implemented: "postgres.dbo.raw_reviews"
  LINE 8:     "postgres"."dbo"."raw_reviews"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:30:07.906083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0affae05-20ad-45d8-b46f-bef8ca060c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5EF51B0>]}
[0m07:30:07.906083 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:30:07.907083 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:30:07.907083 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:30:07.908082 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:30:07.909082 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:30:07.909082 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:30:07.909082 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:30:07.910082 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:30:07.910082 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:30:07.910082 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:30:07.911082 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:30:07.911082 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:30:07.911082 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:30:07.912082 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:30:07.912082 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:30:07.912082 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:30:07.913082 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:30:07.914081 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:30:07.914081 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.914081 [debug] [MainThread]: On master: BEGIN
[0m07:30:07.914081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:07.927083 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:30:07.927083 [debug] [MainThread]: On master: COMMIT
[0m07:30:07.927083 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:07.927083 [debug] [MainThread]: On master: COMMIT
[0m07:30:07.928086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:30:07.928086 [debug] [MainThread]: On master: Close
[0m07:30:07.929083 [info ] [MainThread]: 
[0m07:30:07.929083 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:30:07.930083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:07.930083 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:30:07.930083 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m07:30:07.930083 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:30:07.967082 [info ] [MainThread]: 
[0m07:30:07.967082 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:30:07.968082 [info ] [MainThread]: 
[0m07:30:07.969082 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:30:07.970083 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_hosts"
[0m07:30:07.970083 [error] [MainThread]:   LINE 8:     "postgres"."dbo"."raw_hosts"
[0m07:30:07.970083 [error] [MainThread]:               ^
[0m07:30:07.971082 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:30:07.971082 [info ] [MainThread]: 
[0m07:30:07.971082 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:30:07.972082 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_listings"
[0m07:30:07.972082 [error] [MainThread]:   LINE 8:     "postgres"."dbo"."raw_listings"
[0m07:30:07.973082 [error] [MainThread]:               ^
[0m07:30:07.973082 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:30:07.973082 [info ] [MainThread]: 
[0m07:30:07.974082 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:30:07.974082 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_reviews"
[0m07:30:07.975083 [error] [MainThread]:   LINE 8:     "postgres"."dbo"."raw_reviews"
[0m07:30:07.975083 [error] [MainThread]:               ^
[0m07:30:07.975083 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:30:07.976082 [info ] [MainThread]: 
[0m07:30:07.976082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:30:07.977082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5D292D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5ED1240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B5E910C0>]}


============================== 2022-08-22 07:31:17.674711 | 6de35b0c-382a-41a0-8ed7-8c44ce0b52ea ==============================
[0m07:31:17.674711 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:31:17.675697 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:31:17.675697 [debug] [MainThread]: Tracking: tracking
[0m07:31:17.687680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD55ED420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD55EC6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD55EEB00>]}
[0m07:31:17.831713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:31:17.831713 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:31:17.832711 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:31:17.832711 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:31:17.843712 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:31:17.853709 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:31:17.855714 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:31:17.869715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m07:31:17.876315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD58B98D0>]}
[0m07:31:17.913314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD5835C00>]}
[0m07:31:17.913314 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:31:17.914324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD5835BD0>]}
[0m07:31:17.915320 [info ] [MainThread]: 
[0m07:31:17.916314 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:31:17.918287 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:31:17.927315 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:31:17.927315 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:31:17.927315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:17.962284 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.03 seconds
[0m07:31:17.963284 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:31:17.965285 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:31:17.970283 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:31:17.971283 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:31:17.971283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:18.010284 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:31:18.010284 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:31:18.010284 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:31:18.014282 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:31:18.015284 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:31:18.016284 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:31:18.016284 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:31:18.019284 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:31:18.019284 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:31:18.019284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:18.032284 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:31:18.032284 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:31:18.032284 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:31:18.035287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:31:18.036284 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:31:18.037284 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:31:18.042285 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.042285 [debug] [MainThread]: On master: BEGIN
[0m07:31:18.042285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:18.056285 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:31:18.057284 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.057284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:18.071285 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:31:18.072314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD59147C0>]}
[0m07:31:18.072314 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:18.073285 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.074292 [debug] [MainThread]: On master: BEGIN
[0m07:31:18.075285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:31:18.076284 [debug] [MainThread]: On master: COMMIT
[0m07:31:18.076284 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.076284 [debug] [MainThread]: On master: COMMIT
[0m07:31:18.077286 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:31:18.077286 [debug] [MainThread]: On master: Close
[0m07:31:18.077286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:31:18.078284 [info ] [MainThread]: 
[0m07:31:18.081284 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:31:18.082284 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:31:18.082284 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:31:18.082284 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:31:18.083284 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:31:18.084288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:31:18.086284 [debug] [Thread-1 (]: finished collecting timing info
[0m07:31:18.086284 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:31:18.117284 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:31:18.119284 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:31:18.119284 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:31:18.120283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:31:18.149284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:31:18.150284 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:31:18.150284 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."raw_hosts"
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:31:18.151283 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_hosts" does not exist
LINE 8:     "postgres"."raw_hosts"
            ^

[0m07:31:18.151283 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:31:18.152283 [debug] [Thread-1 (]: finished collecting timing info
[0m07:31:18.152283 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:31:18.153283 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  relation "postgres.raw_hosts" does not exist
  LINE 8:     "postgres"."raw_hosts"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:31:18.153283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD596ABF0>]}
[0m07:31:18.153283 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.07s]
[0m07:31:18.154286 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:31:18.154286 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:31:18.155284 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:31:18.155284 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:31:18.156284 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:31:18.156284 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:31:18.158284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:31:18.159284 [debug] [Thread-1 (]: finished collecting timing info
[0m07:31:18.159284 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:31:18.164283 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:31:18.165283 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:31:18.166284 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:31:18.166284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:18.197845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:31:18.197845 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:31:18.198847 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."raw_listings"
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:31:18.199845 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_listings" does not exist
LINE 8:     "postgres"."raw_listings"
            ^

[0m07:31:18.199845 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:31:18.200845 [debug] [Thread-1 (]: finished collecting timing info
[0m07:31:18.200845 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:31:18.200845 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  relation "postgres.raw_listings" does not exist
  LINE 8:     "postgres"."raw_listings"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:31:18.201848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD5978250>]}
[0m07:31:18.201848 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.05s]
[0m07:31:18.202846 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:31:18.202846 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:31:18.203846 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:31:18.203846 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:31:18.203846 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:31:18.204844 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:31:18.205843 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:31:18.207845 [debug] [Thread-1 (]: finished collecting timing info
[0m07:31:18.207845 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:31:18.211843 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:31:18.213559 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:31:18.213559 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:31:18.213559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:18.227049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:31:18.227049 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:31:18.227049 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "postgres"."raw_reviews"
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:31:18.228049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_reviews" does not exist
LINE 8:     "postgres"."raw_reviews"
            ^

[0m07:31:18.228049 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:31:18.229077 [debug] [Thread-1 (]: finished collecting timing info
[0m07:31:18.229077 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:31:18.230077 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  relation "postgres.raw_reviews" does not exist
  LINE 8:     "postgres"."raw_reviews"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:31:18.230077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de35b0c-382a-41a0-8ed7-8c44ce0b52ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD5999720>]}
[0m07:31:18.230077 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:31:18.231076 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:31:18.231076 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:31:18.232050 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:31:18.232890 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:31:18.232890 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:31:18.232890 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:31:18.233897 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:31:18.233897 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:31:18.233897 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:31:18.235102 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:31:18.235102 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:31:18.235102 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:31:18.236108 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:31:18.236108 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:31:18.236108 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:31:18.237107 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:31:18.237107 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:31:18.238108 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.238108 [debug] [MainThread]: On master: BEGIN
[0m07:31:18.238108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:31:18.250111 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:31:18.251108 [debug] [MainThread]: On master: COMMIT
[0m07:31:18.251108 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:18.251108 [debug] [MainThread]: On master: COMMIT
[0m07:31:18.252108 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:31:18.252108 [debug] [MainThread]: On master: Close
[0m07:31:18.253108 [info ] [MainThread]: 
[0m07:31:18.253108 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:31:18.254108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:18.254108 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:31:18.254108 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m07:31:18.254108 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:31:18.295110 [info ] [MainThread]: 
[0m07:31:18.296111 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:31:18.296111 [info ] [MainThread]: 
[0m07:31:18.297111 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:31:18.297111 [error] [MainThread]:   relation "postgres.raw_hosts" does not exist
[0m07:31:18.298108 [error] [MainThread]:   LINE 8:     "postgres"."raw_hosts"
[0m07:31:18.298108 [error] [MainThread]:               ^
[0m07:31:18.298108 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:31:18.299108 [info ] [MainThread]: 
[0m07:31:18.299108 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:31:18.300107 [error] [MainThread]:   relation "postgres.raw_listings" does not exist
[0m07:31:18.300107 [error] [MainThread]:   LINE 8:     "postgres"."raw_listings"
[0m07:31:18.300107 [error] [MainThread]:               ^
[0m07:31:18.301108 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:31:18.301108 [info ] [MainThread]: 
[0m07:31:18.301108 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:31:18.302107 [error] [MainThread]:   relation "postgres.raw_reviews" does not exist
[0m07:31:18.302107 [error] [MainThread]:   LINE 8:     "postgres"."raw_reviews"
[0m07:31:18.303107 [error] [MainThread]:               ^
[0m07:31:18.303107 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:31:18.303107 [info ] [MainThread]: 
[0m07:31:18.304107 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:31:18.304107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD587BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD5903040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CD591D030>]}


============================== 2022-08-22 07:32:56.687889 | 079170fc-1164-4a72-9547-4269285c69fc ==============================
[0m07:32:56.687889 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:32:56.688860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:32:56.688860 [debug] [MainThread]: Tracking: tracking
[0m07:32:56.704859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDCAEE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDCAECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDCADD80>]}
[0m07:32:56.867858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:32:56.867858 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:32:56.868858 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:32:56.868858 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:32:56.880857 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:32:56.890858 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:32:56.891859 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:32:56.906859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres.dim
- models.dbt_postgres

[0m07:32:56.912859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDF79960>]}
[0m07:32:56.948858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDEF5B70>]}
[0m07:32:56.948858 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:32:56.949858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDB8DC60>]}
[0m07:32:56.950860 [info ] [MainThread]: 
[0m07:32:56.951859 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:32:56.952859 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:32:56.960857 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:32:56.961858 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:32:56.961858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:56.991862 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.03 seconds
[0m07:32:56.993859 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:32:56.994859 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:32:56.999858 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:32:57.000858 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:32:57.000858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:57.014676 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:32:57.014676 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:32:57.014676 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:32:57.017675 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:32:57.018677 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:32:57.019385 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:32:57.020393 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:32:57.022391 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:32:57.022391 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:32:57.022391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:57.035155 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:32:57.035155 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:32:57.035155 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:32:57.037160 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:32:57.038161 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:32:57.039162 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:32:57.044161 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:57.044161 [debug] [MainThread]: On master: BEGIN
[0m07:32:57.045161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:57.057481 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:32:57.057481 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:57.057481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:32:57.070480 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:32:57.071482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDFD3070>]}
[0m07:32:57.072480 [debug] [MainThread]: On master: ROLLBACK
[0m07:32:57.073481 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:57.073481 [debug] [MainThread]: On master: BEGIN
[0m07:32:57.075645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:32:57.075645 [debug] [MainThread]: On master: COMMIT
[0m07:32:57.075645 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:57.075645 [debug] [MainThread]: On master: COMMIT
[0m07:32:57.076651 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:32:57.076651 [debug] [MainThread]: On master: Close
[0m07:32:57.077651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:32:57.077651 [info ] [MainThread]: 
[0m07:32:57.080651 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:32:57.080651 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:32:57.081651 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:32:57.081651 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:32:57.081651 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:32:57.083650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:32:57.085389 [debug] [Thread-1 (]: finished collecting timing info
[0m07:32:57.085389 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:32:57.116426 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:32:57.117426 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:32:57.118396 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:32:57.118396 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:32:57.148901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:32:57.148901 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:32:57.148901 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "raw_hosts"
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:32:57.149902 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_hosts" does not exist
LINE 8:     "raw_hosts"
            ^
DETAIL:  There is a WITH item named "raw_hosts", but it cannot be referenced from this part of the query.
HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.

[0m07:32:57.150902 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:32:57.150902 [debug] [Thread-1 (]: finished collecting timing info
[0m07:32:57.151902 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:32:57.151902 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  relation "raw_hosts" does not exist
  LINE 8:     "raw_hosts"
              ^
  DETAIL:  There is a WITH item named "raw_hosts", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:32:57.151902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDE03C070>]}
[0m07:32:57.152903 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.07s]
[0m07:32:57.153903 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:32:57.153903 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:32:57.153903 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:32:57.154901 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:32:57.154901 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:32:57.154901 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:32:57.156902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:32:57.158903 [debug] [Thread-1 (]: finished collecting timing info
[0m07:32:57.158903 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:32:57.162901 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:32:57.164902 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:32:57.164902 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:32:57.164902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:57.177904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:32:57.178901 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:32:57.178901 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "raw_listings"
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:32:57.179903 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_listings" does not exist
LINE 8:     "raw_listings"
            ^
DETAIL:  There is a WITH item named "raw_listings", but it cannot be referenced from this part of the query.
HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.

[0m07:32:57.179903 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:32:57.180902 [debug] [Thread-1 (]: finished collecting timing info
[0m07:32:57.180902 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:32:57.180902 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  relation "raw_listings" does not exist
  LINE 8:     "raw_listings"
              ^
  DETAIL:  There is a WITH item named "raw_listings", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:32:57.181901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDE013820>]}
[0m07:32:57.181901 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.03s]
[0m07:32:57.182901 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:32:57.182901 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:32:57.182901 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:32:57.183902 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:32:57.183902 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:32:57.183902 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:32:57.185902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:32:57.187902 [debug] [Thread-1 (]: finished collecting timing info
[0m07:32:57.187902 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:32:57.191901 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:32:57.192901 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:32:57.193902 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:32:57.193902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:57.206903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:32:57.206903 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:32:57.206903 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    "raw_reviews"
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:32:57.207902 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_reviews" does not exist
LINE 8:     "raw_reviews"
            ^
DETAIL:  There is a WITH item named "raw_reviews", but it cannot be referenced from this part of the query.
HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.

[0m07:32:57.208902 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:32:57.208902 [debug] [Thread-1 (]: finished collecting timing info
[0m07:32:57.209901 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:32:57.209901 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  relation "raw_reviews" does not exist
  LINE 8:     "raw_reviews"
              ^
  DETAIL:  There is a WITH item named "raw_reviews", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:32:57.209901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '079170fc-1164-4a72-9547-4269285c69fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDE059690>]}
[0m07:32:57.210902 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:32:57.210902 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:32:57.211902 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:32:57.211902 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:32:57.212902 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:32:57.212902 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:32:57.212902 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:32:57.213902 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:32:57.213902 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:32:57.213902 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:32:57.214902 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:32:57.214902 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:32:57.214902 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:32:57.215901 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:32:57.215901 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:32:57.215901 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:32:57.216902 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:32:57.217903 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:32:57.217903 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:57.217903 [debug] [MainThread]: On master: BEGIN
[0m07:32:57.218902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:32:57.230901 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:32:57.230901 [debug] [MainThread]: On master: COMMIT
[0m07:32:57.231902 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:57.231902 [debug] [MainThread]: On master: COMMIT
[0m07:32:57.231902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:32:57.232901 [debug] [MainThread]: On master: Close
[0m07:32:57.232901 [info ] [MainThread]: 
[0m07:32:57.233903 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m07:32:57.233903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:32:57.234902 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:32:57.234902 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m07:32:57.234902 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:32:57.275901 [info ] [MainThread]: 
[0m07:32:57.276901 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:32:57.277903 [info ] [MainThread]: 
[0m07:32:57.277903 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:32:57.278902 [error] [MainThread]:   relation "raw_hosts" does not exist
[0m07:32:57.278902 [error] [MainThread]:   LINE 8:     "raw_hosts"
[0m07:32:57.278902 [error] [MainThread]:               ^
[0m07:32:57.279902 [error] [MainThread]:   DETAIL:  There is a WITH item named "raw_hosts", but it cannot be referenced from this part of the query.
[0m07:32:57.279902 [error] [MainThread]:   HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
[0m07:32:57.279902 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:32:57.280902 [info ] [MainThread]: 
[0m07:32:57.280902 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:32:57.281902 [error] [MainThread]:   relation "raw_listings" does not exist
[0m07:32:57.281902 [error] [MainThread]:   LINE 8:     "raw_listings"
[0m07:32:57.282904 [error] [MainThread]:               ^
[0m07:32:57.282904 [error] [MainThread]:   DETAIL:  There is a WITH item named "raw_listings", but it cannot be referenced from this part of the query.
[0m07:32:57.282904 [error] [MainThread]:   HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
[0m07:32:57.283902 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:32:57.283902 [info ] [MainThread]: 
[0m07:32:57.284901 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:32:57.284901 [error] [MainThread]:   relation "raw_reviews" does not exist
[0m07:32:57.285901 [error] [MainThread]:   LINE 8:     "raw_reviews"
[0m07:32:57.285901 [error] [MainThread]:               ^
[0m07:32:57.285901 [error] [MainThread]:   DETAIL:  There is a WITH item named "raw_reviews", but it cannot be referenced from this part of the query.
[0m07:32:57.286901 [error] [MainThread]:   HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
[0m07:32:57.286901 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:32:57.286901 [info ] [MainThread]: 
[0m07:32:57.287901 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:32:57.287901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDF3BDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDFD6440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EDDE75B10>]}


============================== 2022-08-22 07:34:25.479391 | 5aedffce-e7a4-4e75-9d9c-cfaacec70d5d ==============================
[0m07:34:25.479391 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:34:25.479391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:34:25.480362 [debug] [MainThread]: Tracking: tracking
[0m07:34:25.495364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4346DFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4346C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4346D420>]}
[0m07:34:25.637393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:34:25.638392 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:34:25.638392 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:34:25.638392 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:34:25.650363 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:34:25.660392 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:34:25.661392 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:34:25.676362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres.dim
- models.dbt_postgres

[0m07:34:25.681392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F43739900>]}
[0m07:34:25.719360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F436B5CC0>]}
[0m07:34:25.719360 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:34:25.720362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F436B5C90>]}
[0m07:34:25.721362 [info ] [MainThread]: 
[0m07:34:25.722361 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:34:25.723362 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb"
[0m07:34:25.732365 [debug] [ThreadPool]: Using postgres connection "list_airbnb"
[0m07:34:25.732365 [debug] [ThreadPool]: On list_airbnb: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb"} */

    select distinct nspname from pg_namespace
  
[0m07:34:25.732365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:25.748363 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.02 seconds
[0m07:34:25.750364 [debug] [ThreadPool]: On list_airbnb: Close
[0m07:34:25.751366 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dbo"
[0m07:34:25.757363 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:34:25.757363 [debug] [ThreadPool]: On list_airbnb_dbo: BEGIN
[0m07:34:25.757363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:25.770363 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:34:25.770363 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dbo"
[0m07:34:25.771367 [debug] [ThreadPool]: On list_airbnb_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dbo"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:34:25.773363 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m07:34:25.774363 [debug] [ThreadPool]: On list_airbnb_dbo: ROLLBACK
[0m07:34:25.775364 [debug] [ThreadPool]: On list_airbnb_dbo: Close
[0m07:34:25.776363 [debug] [ThreadPool]: Acquiring new postgres connection "list_airbnb_dev"
[0m07:34:25.778365 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:34:25.778365 [debug] [ThreadPool]: On list_airbnb_dev: BEGIN
[0m07:34:25.778365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:25.801361 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m07:34:25.801361 [debug] [ThreadPool]: Using postgres connection "list_airbnb_dev"
[0m07:34:25.801361 [debug] [ThreadPool]: On list_airbnb_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_airbnb_dev"} */
select
      'airbnb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'airbnb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:34:25.804362 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:34:25.805364 [debug] [ThreadPool]: On list_airbnb_dev: ROLLBACK
[0m07:34:25.805364 [debug] [ThreadPool]: On list_airbnb_dev: Close
[0m07:34:25.811362 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:25.811362 [debug] [MainThread]: On master: BEGIN
[0m07:34:25.811362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:25.823361 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:34:25.824361 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:25.824361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:34:25.837363 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:34:25.839393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F4378E0E0>]}
[0m07:34:25.839393 [debug] [MainThread]: On master: ROLLBACK
[0m07:34:25.840363 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:25.840363 [debug] [MainThread]: On master: BEGIN
[0m07:34:25.841362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:34:25.841362 [debug] [MainThread]: On master: COMMIT
[0m07:34:25.842360 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:25.842360 [debug] [MainThread]: On master: COMMIT
[0m07:34:25.842360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:34:25.843362 [debug] [MainThread]: On master: Close
[0m07:34:25.843362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:34:25.844364 [info ] [MainThread]: 
[0m07:34:25.847361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:34:25.847361 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:34:25.848361 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:34:25.848361 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:34:25.848361 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:34:25.850360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:34:25.852360 [debug] [Thread-1 (]: finished collecting timing info
[0m07:34:25.852360 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:34:25.883390 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:34:25.885395 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:34:25.885395 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:34:25.886363 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:34:25.912362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:34:25.912362 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:34:25.913362 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "airbnb"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."raw_hosts"
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:34:25.914361 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_hosts" does not exist
LINE 8:     "postgres"."raw_hosts"
            ^

[0m07:34:25.914361 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:34:25.915362 [debug] [Thread-1 (]: finished collecting timing info
[0m07:34:25.915362 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:34:25.915362 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  relation "postgres.raw_hosts" does not exist
  LINE 8:     "postgres"."raw_hosts"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:34:25.915362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F437EA590>]}
[0m07:34:25.916364 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.07s]
[0m07:34:25.917362 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:34:25.917362 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:34:25.917362 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:34:25.918361 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:34:25.918361 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:34:25.918361 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:34:25.920361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:34:25.922361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:34:25.922361 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:34:25.926361 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:34:25.928361 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:34:25.928361 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:34:25.929361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:25.942361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:34:25.942361 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:34:25.942361 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "airbnb"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."raw_listings"
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:34:25.943361 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_listings" does not exist
LINE 8:     "postgres"."raw_listings"
            ^

[0m07:34:25.943361 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:34:25.944361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:34:25.944361 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:34:25.945361 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  relation "postgres.raw_listings" does not exist
  LINE 8:     "postgres"."raw_listings"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:34:25.945361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F437FA860>]}
[0m07:34:25.945361 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.03s]
[0m07:34:25.946361 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:34:25.946361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:34:25.947361 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:34:25.947361 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:34:25.948361 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:34:25.948361 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:34:25.950361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:34:25.951361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:34:25.952362 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:34:25.955361 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:34:25.957362 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:34:25.957362 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:34:25.957362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:25.970362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:34:25.970362 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:34:25.970362 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "airbnb"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:34:25.971361 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "postgres.dbo.raw_reviews"
LINE 8:     postgres.dbo.raw_reviews
            ^

[0m07:34:25.971361 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:34:25.972361 [debug] [Thread-1 (]: finished collecting timing info
[0m07:34:25.972361 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:34:25.973361 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  cross-database references are not implemented: "postgres.dbo.raw_reviews"
  LINE 8:     postgres.dbo.raw_reviews
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:34:25.973361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aedffce-e7a4-4e75-9d9c-cfaacec70d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F438216F0>]}
[0m07:34:25.973361 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:34:25.974362 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:34:25.975361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:34:25.975361 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:34:25.976361 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:34:25.976361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:34:25.976361 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:34:25.977361 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:34:25.977361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:34:25.977361 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:34:25.978361 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:34:25.978361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:34:25.978361 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:34:25.979361 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:34:25.979361 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:34:25.979361 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:34:25.980361 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:34:25.980361 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:34:25.981361 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:25.981361 [debug] [MainThread]: On master: BEGIN
[0m07:34:25.981361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:25.994361 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:34:25.994361 [debug] [MainThread]: On master: COMMIT
[0m07:34:25.994361 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:25.994361 [debug] [MainThread]: On master: COMMIT
[0m07:34:25.995361 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:34:25.995361 [debug] [MainThread]: On master: Close
[0m07:34:25.996361 [info ] [MainThread]: 
[0m07:34:25.996361 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m07:34:25.997364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:25.997364 [debug] [MainThread]: Connection 'list_airbnb' was properly closed.
[0m07:34:25.997364 [debug] [MainThread]: Connection 'list_airbnb_dev' was properly closed.
[0m07:34:25.997364 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:34:26.036361 [info ] [MainThread]: 
[0m07:34:26.036361 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:34:26.037361 [info ] [MainThread]: 
[0m07:34:26.038361 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:34:26.038361 [error] [MainThread]:   relation "postgres.raw_hosts" does not exist
[0m07:34:26.038361 [error] [MainThread]:   LINE 8:     "postgres"."raw_hosts"
[0m07:34:26.039361 [error] [MainThread]:               ^
[0m07:34:26.039361 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:34:26.039361 [info ] [MainThread]: 
[0m07:34:26.040361 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:34:26.040361 [error] [MainThread]:   relation "postgres.raw_listings" does not exist
[0m07:34:26.041361 [error] [MainThread]:   LINE 8:     "postgres"."raw_listings"
[0m07:34:26.041361 [error] [MainThread]:               ^
[0m07:34:26.042362 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:34:26.042362 [info ] [MainThread]: 
[0m07:34:26.042362 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:34:26.043362 [error] [MainThread]:   cross-database references are not implemented: "postgres.dbo.raw_reviews"
[0m07:34:26.044363 [error] [MainThread]:   LINE 8:     postgres.dbo.raw_reviews
[0m07:34:26.044363 [error] [MainThread]:               ^
[0m07:34:26.045361 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:34:26.045361 [info ] [MainThread]: 
[0m07:34:26.045361 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:34:26.046361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F436F9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F43796590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F436255A0>]}


============================== 2022-08-22 07:35:56.554777 | 9de004b0-a0b7-45d7-852b-9ac3427c1cea ==============================
[0m07:35:56.554777 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:35:56.554777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:35:56.555778 [debug] [MainThread]: Tracking: tracking
[0m07:35:56.567778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF58EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF58ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF58DD80>]}
[0m07:35:56.628778 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:35:56.629779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF585D50>]}
[0m07:35:56.743780 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m07:35:56.744779 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m07:35:56.744779 [debug] [MainThread]: Parsing macros\adapters.sql
[0m07:35:56.772777 [debug] [MainThread]: Parsing macros\catalog.sql
[0m07:35:56.774777 [debug] [MainThread]: Parsing macros\relations.sql
[0m07:35:56.775777 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m07:35:56.776777 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:35:56.777777 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:35:56.778777 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:35:56.787779 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:35:56.788811 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:35:56.791780 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:35:56.792809 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m07:35:56.805777 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m07:35:56.813779 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m07:35:56.815777 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m07:35:56.818778 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m07:35:56.824777 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m07:35:56.827777 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m07:35:56.840777 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m07:35:56.842778 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m07:35:56.848777 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m07:35:56.852778 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m07:35:56.853779 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m07:35:56.854778 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m07:35:56.855778 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m07:35:56.856778 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m07:35:56.857777 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m07:35:56.859778 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m07:35:56.861778 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m07:35:56.863778 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m07:35:56.866777 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m07:35:56.870778 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m07:35:56.878777 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m07:35:56.879778 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m07:35:56.892778 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m07:35:56.905777 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m07:35:56.907777 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m07:35:56.912777 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m07:35:56.915778 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m07:35:56.917803 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m07:35:56.918803 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m07:35:56.923812 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m07:35:56.938803 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m07:35:56.944803 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m07:35:56.955802 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m07:35:56.965808 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m07:35:56.967808 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m07:35:56.981803 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m07:35:56.983803 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m07:35:56.987802 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m07:35:56.989803 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:35:56.990802 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m07:35:56.991802 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m07:35:56.992802 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m07:35:56.993779 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m07:35:56.999777 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:35:57.000778 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:35:57.002778 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m07:35:57.003778 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m07:35:57.004778 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m07:35:57.005778 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m07:35:57.006778 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m07:35:57.007778 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:35:57.009778 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m07:35:57.010778 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:35:57.012778 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m07:35:57.013778 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m07:35:57.014778 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m07:35:57.015778 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m07:35:57.016778 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m07:35:57.017778 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:35:57.019778 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m07:35:57.021778 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m07:35:57.025778 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m07:35:57.026778 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m07:35:57.034777 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m07:35:57.037778 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m07:35:57.039778 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m07:35:57.041778 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m07:35:57.043778 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m07:35:57.045778 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m07:35:57.056778 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m07:35:57.059777 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m07:35:57.063777 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m07:35:57.068777 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m07:35:57.070778 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m07:35:57.074777 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m07:35:57.080778 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m07:35:57.081778 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m07:35:57.102777 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m07:35:57.116777 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m07:35:57.126778 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m07:35:57.131778 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m07:35:57.135778 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m07:35:57.139777 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m07:35:57.146777 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m07:35:57.149777 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m07:35:57.152778 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m07:35:57.159779 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m07:35:57.162778 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m07:35:57.170778 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m07:35:57.171777 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m07:35:57.180777 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m07:35:57.182778 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m07:35:57.183777 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m07:35:57.186777 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m07:35:57.205777 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m07:35:57.207777 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m07:35:57.211777 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m07:35:57.245777 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m07:35:57.258778 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m07:35:57.267777 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m07:35:57.277777 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m07:35:57.291777 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m07:35:57.309777 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m07:35:57.317777 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m07:35:57.318780 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m07:35:57.319778 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m07:35:57.354813 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m07:35:57.369817 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m07:35:57.380817 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m07:35:57.391802 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m07:35:57.404814 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m07:35:57.425812 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m07:35:57.434809 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m07:35:57.440810 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m07:35:57.447808 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m07:35:57.481810 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m07:35:57.493808 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m07:35:57.504814 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m07:35:57.514809 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m07:35:57.528809 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m07:35:57.529778 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m07:35:57.537808 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m07:35:57.538808 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m07:35:57.539809 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m07:35:57.540811 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m07:35:57.542808 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m07:35:57.543809 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m07:35:57.546810 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m07:35:57.547806 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m07:35:57.549812 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m07:35:57.551810 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m07:35:57.552809 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m07:35:57.555777 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m07:35:57.560777 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m07:35:57.562777 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m07:35:57.570777 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m07:35:57.572777 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m07:35:57.573778 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m07:35:57.574777 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m07:35:57.575777 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m07:35:57.577777 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m07:35:57.578777 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m07:35:57.581777 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m07:35:57.582777 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m07:35:57.589777 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m07:35:57.590777 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m07:35:57.592777 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m07:35:57.593777 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m07:35:57.595777 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m07:35:57.596777 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m07:35:57.601778 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m07:35:57.605777 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m07:35:57.607777 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m07:35:57.608777 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m07:35:57.610777 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m07:35:57.611777 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m07:35:57.613777 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m07:35:57.616778 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m07:35:57.618777 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m07:35:57.619778 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m07:35:57.621777 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m07:35:57.628777 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m07:35:57.630777 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m07:35:57.631777 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m07:35:57.633778 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m07:35:57.635777 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m07:35:57.637777 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m07:35:57.639777 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m07:35:57.640777 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m07:35:57.642777 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m07:35:57.644777 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m07:35:57.645777 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m07:35:57.646777 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m07:35:57.648778 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m07:35:57.649778 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m07:35:57.669779 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m07:35:57.673778 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m07:35:57.679777 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m07:35:57.682777 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m07:35:57.687777 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m07:35:57.689777 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m07:35:57.691777 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m07:35:57.694777 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m07:35:57.697778 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m07:35:57.702777 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m07:35:57.704778 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m07:35:57.705777 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m07:35:57.707778 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m07:35:57.712778 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m07:35:57.713778 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m07:35:57.714777 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m07:35:57.718778 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m07:35:57.719777 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m07:35:57.723809 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m07:35:57.726809 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m07:35:57.735804 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m07:35:57.742808 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m07:35:57.743802 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m07:35:57.745802 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m07:35:58.436781 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m07:35:58.446779 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m07:35:58.448778 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m07:35:58.449809 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m07:35:58.469827 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m07:35:58.470800 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m07:35:58.472827 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:35:58.473797 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:35:58.475797 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:35:58.632798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m07:35:58.638797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF9680D0>]}
[0m07:35:58.675412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF58DED0>]}
[0m07:35:58.675412 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:35:58.676447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF7EDD80>]}
[0m07:35:58.678026 [info ] [MainThread]: 
[0m07:35:58.679136 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:35:58.680181 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:35:58.689077 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:35:58.689077 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:35:58.689603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:58.712101 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
[0m07:35:58.713688 [debug] [ThreadPool]: On list_postgres: Close
[0m07:35:58.715273 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:35:58.720336 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:35:58.721338 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:35:58.721338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:58.734780 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.735779 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:35:58.735779 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:35:58.739906 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:35:58.740951 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:35:58.741469 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:35:58.741987 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:35:58.744091 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:35:58.744620 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:35:58.744620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:58.756910 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.756910 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:35:58.756910 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:35:58.759910 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.0 seconds
[0m07:35:58.761908 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:35:58.761908 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:35:58.767908 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:58.767908 [debug] [MainThread]: On master: BEGIN
[0m07:35:58.767908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:58.780910 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.780910 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:58.781910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:35:58.814621 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m07:35:58.816621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF99ECB0>]}
[0m07:35:58.816621 [debug] [MainThread]: On master: ROLLBACK
[0m07:35:58.817622 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:58.817622 [debug] [MainThread]: On master: BEGIN
[0m07:35:58.818621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:35:58.819622 [debug] [MainThread]: On master: COMMIT
[0m07:35:58.819622 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:58.819622 [debug] [MainThread]: On master: COMMIT
[0m07:35:58.820621 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:35:58.820621 [debug] [MainThread]: On master: Close
[0m07:35:58.820621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:58.821622 [info ] [MainThread]: 
[0m07:35:58.826623 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:35:58.826623 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:35:58.827623 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:35:58.827623 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:35:58.827623 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:35:58.829623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:35:58.830624 [debug] [Thread-1 (]: finished collecting timing info
[0m07:35:58.831622 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:35:58.863621 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:35:58.865622 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:35:58.865622 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:35:58.865622 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:35:58.878621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.879621 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:35:58.879621 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    "postgres"."raw_hosts"
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:35:58.880622 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_hosts" does not exist
LINE 8:     "postgres"."raw_hosts"
            ^

[0m07:35:58.880622 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:35:58.881622 [debug] [Thread-1 (]: finished collecting timing info
[0m07:35:58.881622 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:35:58.881622 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  relation "postgres.raw_hosts" does not exist
  LINE 8:     "postgres"."raw_hosts"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:35:58.882623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FFA1BAF0>]}
[0m07:35:58.882623 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.06s]
[0m07:35:58.883622 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:35:58.883622 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:35:58.884622 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:35:58.884622 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:35:58.884622 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:35:58.885621 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:35:58.886621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:35:58.888621 [debug] [Thread-1 (]: finished collecting timing info
[0m07:35:58.888621 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:35:58.894622 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:35:58.895621 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:35:58.896623 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:35:58.896623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:58.908622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.909621 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:35:58.909621 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    "postgres"."raw_listings"
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:35:58.910622 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "postgres.raw_listings" does not exist
LINE 8:     "postgres"."raw_listings"
            ^

[0m07:35:58.910622 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:35:58.911622 [debug] [Thread-1 (]: finished collecting timing info
[0m07:35:58.911622 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:35:58.912622 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  relation "postgres.raw_listings" does not exist
  LINE 8:     "postgres"."raw_listings"
              ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:35:58.912622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FFA261D0>]}
[0m07:35:58.913621 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.03s]
[0m07:35:58.913621 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:35:58.914621 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:35:58.914621 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:35:58.915621 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:35:58.915621 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:35:58.915621 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:35:58.917620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:35:58.918620 [debug] [Thread-1 (]: finished collecting timing info
[0m07:35:58.919620 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:35:58.923620 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:35:58.924620 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:35:58.925621 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:35:58.925621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:58.938620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.938620 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:35:58.938620 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:35:58.940620 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 12:     DATE AS review_date,
             ^

[0m07:35:58.940620 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:35:58.941622 [debug] [Thread-1 (]: finished collecting timing info
[0m07:35:58.941622 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:35:58.942621 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 12:     DATE AS review_date,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:35:58.942621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9de004b0-a0b7-45d7-852b-9ac3427c1cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FFA66890>]}
[0m07:35:58.943621 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:35:58.943621 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:35:58.944621 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:35:58.944621 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:35:58.945621 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:35:58.945621 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:35:58.945621 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:35:58.946621 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:35:58.946621 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:35:58.946621 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:35:58.947620 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:35:58.947620 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:35:58.947620 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:35:58.948620 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:35:58.948620 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:35:58.948620 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:35:58.949620 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:35:58.950621 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:35:58.950621 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:58.950621 [debug] [MainThread]: On master: BEGIN
[0m07:35:58.950621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:35:58.964622 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:35:58.964622 [debug] [MainThread]: On master: COMMIT
[0m07:35:58.964622 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:58.964622 [debug] [MainThread]: On master: COMMIT
[0m07:35:58.965622 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:35:58.965622 [debug] [MainThread]: On master: Close
[0m07:35:58.966621 [info ] [MainThread]: 
[0m07:35:58.966621 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m07:35:58.967622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:58.967622 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:35:58.967622 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:35:58.967622 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:35:59.004890 [info ] [MainThread]: 
[0m07:35:59.005891 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:35:59.006924 [info ] [MainThread]: 
[0m07:35:59.006924 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:35:59.007889 [error] [MainThread]:   relation "postgres.raw_hosts" does not exist
[0m07:35:59.007889 [error] [MainThread]:   LINE 8:     "postgres"."raw_hosts"
[0m07:35:59.008888 [error] [MainThread]:               ^
[0m07:35:59.008888 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:35:59.010085 [info ] [MainThread]: 
[0m07:35:59.010085 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:35:59.010085 [error] [MainThread]:   relation "postgres.raw_listings" does not exist
[0m07:35:59.011093 [error] [MainThread]:   LINE 8:     "postgres"."raw_listings"
[0m07:35:59.011093 [error] [MainThread]:               ^
[0m07:35:59.012091 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:35:59.012091 [info ] [MainThread]: 
[0m07:35:59.012091 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:35:59.013092 [error] [MainThread]:   column "date" does not exist
[0m07:35:59.013092 [error] [MainThread]:   LINE 12:     DATE AS review_date,
[0m07:35:59.013092 [error] [MainThread]:                ^
[0m07:35:59.014091 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:35:59.014091 [info ] [MainThread]: 
[0m07:35:59.014091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:35:59.015091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF6C74C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF9528C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7FF953430>]}


============================== 2022-08-22 07:36:47.206313 | 834e0738-aa73-4231-b08a-4270501d423d ==============================
[0m07:36:47.206313 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:36:47.207313 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:36:47.207313 [debug] [MainThread]: Tracking: tracking
[0m07:36:47.221313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F00C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F00E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F00CD30>]}
[0m07:36:47.382312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:36:47.382312 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:36:47.383312 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:36:47.395312 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:36:47.406312 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:36:47.422312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres.dim
- models.dbt_postgres

[0m07:36:47.429312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F2D9F30>]}
[0m07:36:47.468312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F251A50>]}
[0m07:36:47.468312 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:36:47.469312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1EEEE590>]}
[0m07:36:47.471313 [info ] [MainThread]: 
[0m07:36:47.471313 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:36:47.473313 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:36:47.481311 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:36:47.481311 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:36:47.482312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:47.498312 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
[0m07:36:47.499313 [debug] [ThreadPool]: On list_postgres: Close
[0m07:36:47.501312 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:36:47.506315 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:36:47.507316 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:36:47.507316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:47.520313 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:36:47.520313 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:36:47.520313 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:36:47.523313 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:36:47.524316 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:36:47.524316 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:36:47.525316 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:36:47.527315 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:36:47.527315 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:36:47.527315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:47.539314 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:36:47.540313 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:36:47.540313 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:36:47.542312 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.0 seconds
[0m07:36:47.544312 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:36:47.545313 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:36:47.550311 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:47.550311 [debug] [MainThread]: On master: BEGIN
[0m07:36:47.550311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:36:47.563499 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:36:47.563499 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:47.563499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:36:47.596497 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m07:36:47.597525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F325F90>]}
[0m07:36:47.597525 [debug] [MainThread]: On master: ROLLBACK
[0m07:36:47.599478 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:47.599478 [debug] [MainThread]: On master: BEGIN
[0m07:36:47.601484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:36:47.601484 [debug] [MainThread]: On master: COMMIT
[0m07:36:47.601484 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:47.601484 [debug] [MainThread]: On master: COMMIT
[0m07:36:47.602483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:36:47.602483 [debug] [MainThread]: On master: Close
[0m07:36:47.603484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:47.603484 [info ] [MainThread]: 
[0m07:36:47.607483 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:36:47.607483 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:36:47.608483 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:36:47.608483 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:36:47.608483 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:36:47.610482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:36:47.611482 [debug] [Thread-1 (]: finished collecting timing info
[0m07:36:47.612483 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:36:47.642514 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:36:47.644485 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:36:47.644485 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:36:47.645516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:36:47.673485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:36:47.673485 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:36:47.673485 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    ID AS host_id,
    NAME AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:36:47.674485 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 11:     ID AS host_id,
             ^

[0m07:36:47.674485 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: ROLLBACK
[0m07:36:47.675486 [debug] [Thread-1 (]: finished collecting timing info
[0m07:36:47.675486 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:36:47.676485 [debug] [Thread-1 (]: Database Error in model src_hosts (models\src\src_hosts.sql)
  column "id" does not exist
  LINE 11:     ID AS host_id,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:36:47.676485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F373190>]}
[0m07:36:47.676485 [error] [Thread-1 (]: 1 of 8 ERROR creating view model dbo.src_hosts ................................. [[31mERROR[0m in 0.07s]
[0m07:36:47.677487 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:36:47.678483 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:36:47.678483 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:36:47.679485 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:36:47.679485 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:36:47.679485 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:36:47.681482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:36:47.682482 [debug] [Thread-1 (]: finished collecting timing info
[0m07:36:47.682482 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:36:47.687483 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:36:47.689482 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:36:47.689482 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:36:47.689482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:47.704003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:36:47.704003 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:36:47.704003 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:36:47.704988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 11:     ID AS listing_id,
             ^

[0m07:36:47.704988 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:36:47.705995 [debug] [Thread-1 (]: finished collecting timing info
[0m07:36:47.705995 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:36:47.706995 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  column "id" does not exist
  LINE 11:     ID AS listing_id,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:36:47.706995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F3A0100>]}
[0m07:36:47.706995 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.03s]
[0m07:36:47.707995 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:36:47.707995 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:36:47.708995 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:36:47.708995 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:36:47.709995 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:36:47.709995 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:36:47.711993 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:36:47.713223 [debug] [Thread-1 (]: finished collecting timing info
[0m07:36:47.713223 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:36:47.717261 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:36:47.718261 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:36:47.719230 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:36:47.719230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:47.750533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:36:47.750533 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:36:47.750533 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:36:47.752531 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 12:     DATE AS review_date,
             ^

[0m07:36:47.752531 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:36:47.753532 [debug] [Thread-1 (]: finished collecting timing info
[0m07:36:47.753532 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:36:47.753532 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 12:     DATE AS review_date,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:36:47.753532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '834e0738-aa73-4231-b08a-4270501d423d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F3C3760>]}
[0m07:36:47.754534 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.04s]
[0m07:36:47.754534 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:36:47.755536 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:36:47.755536 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbo.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m07:36:47.756532 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:36:47.756532 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:36:47.756532 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:36:47.757532 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:36:47.757532 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:36:47.757532 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:36:47.758532 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:36:47.758532 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:36:47.758532 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:36:47.759532 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:36:47.759532 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:36:47.759532 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:36:47.760532 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:36:47.760532 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:36:47.761531 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:47.761531 [debug] [MainThread]: On master: BEGIN
[0m07:36:47.761531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:36:47.774532 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:36:47.774532 [debug] [MainThread]: On master: COMMIT
[0m07:36:47.775531 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:47.775531 [debug] [MainThread]: On master: COMMIT
[0m07:36:47.775531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:36:47.776531 [debug] [MainThread]: On master: Close
[0m07:36:47.776531 [info ] [MainThread]: 
[0m07:36:47.776531 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m07:36:47.777532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:36:47.777532 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:36:47.777532 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:36:47.777532 [debug] [MainThread]: Connection 'model.dbtpostgres.src_reviews' was properly closed.
[0m07:36:47.814811 [info ] [MainThread]: 
[0m07:36:47.815779 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:36:47.816780 [info ] [MainThread]: 
[0m07:36:47.816780 [error] [MainThread]: [33mDatabase Error in model src_hosts (models\src\src_hosts.sql)[0m
[0m07:36:47.817778 [error] [MainThread]:   column "id" does not exist
[0m07:36:47.817778 [error] [MainThread]:   LINE 11:     ID AS host_id,
[0m07:36:47.818777 [error] [MainThread]:                ^
[0m07:36:47.818777 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_hosts.sql
[0m07:36:47.818777 [info ] [MainThread]: 
[0m07:36:47.819777 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:36:47.819777 [error] [MainThread]:   column "id" does not exist
[0m07:36:47.820777 [error] [MainThread]:   LINE 11:     ID AS listing_id,
[0m07:36:47.820777 [error] [MainThread]:                ^
[0m07:36:47.821777 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:36:47.821777 [info ] [MainThread]: 
[0m07:36:47.821777 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:36:47.822776 [error] [MainThread]:   column "date" does not exist
[0m07:36:47.822776 [error] [MainThread]:   LINE 12:     DATE AS review_date,
[0m07:36:47.823776 [error] [MainThread]:                ^
[0m07:36:47.823776 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:36:47.824777 [info ] [MainThread]: 
[0m07:36:47.824777 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=5 TOTAL=8
[0m07:36:47.825777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F331F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F331CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F333130>]}


============================== 2022-08-22 07:38:08.218180 | 22fc9266-d300-4888-bc4e-ffd24f504b8c ==============================
[0m07:38:08.218180 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:38:08.219185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:38:08.219185 [debug] [MainThread]: Tracking: tracking
[0m07:38:08.233150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BB9DD420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BB9DC6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BB9DEB00>]}
[0m07:38:08.377180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:38:08.377180 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_hosts.sql
[0m07:38:08.389181 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:38:08.412150 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m07:38:08.417151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBCA98D0>]}
[0m07:38:08.453182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBC67FA0>]}
[0m07:38:08.453182 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:38:08.454181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBC21AE0>]}
[0m07:38:08.456180 [info ] [MainThread]: 
[0m07:38:08.456180 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:38:08.458151 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:38:08.466181 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:38:08.466181 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:38:08.466181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:08.492149 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
[0m07:38:08.494150 [debug] [ThreadPool]: On list_postgres: Close
[0m07:38:08.495149 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:38:08.501150 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:38:08.501150 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:38:08.501150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:08.514693 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:38:08.514693 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:38:08.515692 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:38:08.518691 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:38:08.519692 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:38:08.520692 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:38:08.520692 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:38:08.522691 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:38:08.522691 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:38:08.523692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:08.547208 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m07:38:08.548249 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:38:08.549218 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:38:08.559214 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m07:38:08.562241 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:38:08.564204 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:38:08.576242 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:08.577210 [debug] [MainThread]: On master: BEGIN
[0m07:38:08.577210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:08.631951 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m07:38:08.631951 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:08.631951 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:38:08.663981 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m07:38:08.664953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBD1A200>]}
[0m07:38:08.665951 [debug] [MainThread]: On master: ROLLBACK
[0m07:38:08.665951 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:08.666952 [debug] [MainThread]: On master: BEGIN
[0m07:38:08.667951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:38:08.667951 [debug] [MainThread]: On master: COMMIT
[0m07:38:08.667951 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:08.667951 [debug] [MainThread]: On master: COMMIT
[0m07:38:08.668951 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:38:08.668951 [debug] [MainThread]: On master: Close
[0m07:38:08.669950 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:38:08.669950 [info ] [MainThread]: 
[0m07:38:08.673509 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:38:08.674509 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:38:08.674509 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:08.675513 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:38:08.675513 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:38:08.677510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:38:08.678512 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.679510 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:38:08.713058 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:38:08.714058 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:08.715058 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:38:08.715058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:38:08.728058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:08.729060 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:08.729060 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:38:08.733059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:08.739647 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:08.739647 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:38:08.741656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:08.756233 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:38:08.756750 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:08.756750 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:38:08.758839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:08.764582 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:08.764582 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:38:08.766584 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:08.767583 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.767583 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:38:08.768582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBD3BF10>]}
[0m07:38:08.768582 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.09s]
[0m07:38:08.769585 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:38:08.769585 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:38:08.770585 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:38:08.770585 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:38:08.771583 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:38:08.771583 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:38:08.773583 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:38:08.775455 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.775455 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:38:08.779658 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:38:08.781796 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:08.782350 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:38:08.782350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:08.807166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:38:08.808167 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:08.808167 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    ID AS listing_id,
    NAME AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:38:08.809167 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 11:     ID AS listing_id,
             ^

[0m07:38:08.809167 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: ROLLBACK
[0m07:38:08.810167 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.810167 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:38:08.810167 [debug] [Thread-1 (]: Database Error in model src_listings (models\src\src_listings.sql)
  column "id" does not exist
  LINE 11:     ID AS listing_id,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:38:08.811167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBD95600>]}
[0m07:38:08.811167 [error] [Thread-1 (]: 2 of 8 ERROR creating view model dbo.src_listings .............................. [[31mERROR[0m in 0.04s]
[0m07:38:08.812167 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:38:08.812705 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:38:08.813229 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:38:08.813749 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:38:08.813749 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:38:08.814266 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:38:08.815817 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:38:08.817367 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.817884 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:38:08.822033 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:38:08.823588 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:38:08.823588 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:38:08.823588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:08.842594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:38:08.842594 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:38:08.842594 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    DATE AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:38:08.844598 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 12:     DATE AS review_date,
             ^

[0m07:38:08.844598 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:38:08.845597 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.845597 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:38:08.846597 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "date" does not exist
  LINE 12:     DATE AS review_date,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:38:08.846597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBDCD2D0>]}
[0m07:38:08.846597 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:38:08.847597 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:38:08.847597 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:08.847597 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:38:08.848597 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.848597 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:08.848597 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:38:08.852596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.854597 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.854597 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:08.857596 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.859596 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.860597 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:38:08.860597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:08.873595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:08.874595 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.874595 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:38:08.876595 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:08.879594 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.879594 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:38:08.881595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:08.882594 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:38:08.882594 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.882594 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:38:08.884594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:08.886596 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:08.886596 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:38:08.887595 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:08.888594 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:08.889595 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:38:08.889595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22fc9266-d300-4888-bc4e-ffd24f504b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBDCCF70>]}
[0m07:38:08.889595 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m07:38:08.890595 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:08.890595 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:38:08.891596 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbo.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m07:38:08.891596 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:38:08.892596 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:38:08.892596 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:38:08.893595 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:38:08.893595 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:38:08.893595 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbo.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m07:38:08.894595 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:38:08.894595 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:38:08.894595 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:38:08.895595 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:38:08.896594 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:38:08.896594 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:08.896594 [debug] [MainThread]: On master: BEGIN
[0m07:38:08.896594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:38:08.921595 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m07:38:08.922596 [debug] [MainThread]: On master: COMMIT
[0m07:38:08.922596 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:08.922596 [debug] [MainThread]: On master: COMMIT
[0m07:38:08.923595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:38:08.923595 [debug] [MainThread]: On master: Close
[0m07:38:08.924597 [info ] [MainThread]: 
[0m07:38:08.924597 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m07:38:08.925597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:08.925597 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:38:08.925597 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:38:08.925597 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_hosts_cleansed' was properly closed.
[0m07:38:08.964596 [info ] [MainThread]: 
[0m07:38:08.964596 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:38:08.965595 [info ] [MainThread]: 
[0m07:38:08.966595 [error] [MainThread]: [33mDatabase Error in model src_listings (models\src\src_listings.sql)[0m
[0m07:38:08.966595 [error] [MainThread]:   column "id" does not exist
[0m07:38:08.967595 [error] [MainThread]:   LINE 11:     ID AS listing_id,
[0m07:38:08.967595 [error] [MainThread]:                ^
[0m07:38:08.967595 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_listings.sql
[0m07:38:08.968595 [info ] [MainThread]: 
[0m07:38:08.968595 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:38:08.968595 [error] [MainThread]:   column "date" does not exist
[0m07:38:08.969595 [error] [MainThread]:   LINE 12:     DATE AS review_date,
[0m07:38:08.969595 [error] [MainThread]:                ^
[0m07:38:08.970595 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:38:08.970595 [info ] [MainThread]: 
[0m07:38:08.970595 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=4 TOTAL=8
[0m07:38:08.971594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBD95960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBC65210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190BBCCEA10>]}


============================== 2022-08-22 07:38:34.682574 | 7a8f1609-6bed-4623-997b-1e680d8dcd89 ==============================
[0m07:38:34.682574 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:38:34.683574 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:38:34.683574 [debug] [MainThread]: Tracking: tracking
[0m07:38:34.696574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4DEDC760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4DEDE080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4DEDCD30>]}
[0m07:38:34.838574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:38:34.838574 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:38:34.838574 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_listings.sql
[0m07:38:34.849573 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:38:34.859574 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:38:34.874586 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m07:38:34.880574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E1A9F30>]}
[0m07:38:34.925573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E121B40>]}
[0m07:38:34.925573 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:38:34.926573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4DDBE6E0>]}
[0m07:38:34.927573 [info ] [MainThread]: 
[0m07:38:34.928574 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:38:34.929574 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:38:34.938573 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:38:34.938573 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:38:34.938573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:34.972573 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
[0m07:38:34.973573 [debug] [ThreadPool]: On list_postgres: Close
[0m07:38:34.975574 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:38:34.980574 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:38:34.981574 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:38:34.981574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:38:35.018575 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:38:35.018575 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:38:35.018575 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:38:35.021578 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:38:35.023575 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:38:35.024574 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:38:35.025574 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:38:35.028574 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:38:35.028574 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:38:35.028574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:38:35.041574 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.041574 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:38:35.042576 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:38:35.044575 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:38:35.045576 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:38:35.046575 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:38:35.051575 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:35.052574 [debug] [MainThread]: On master: BEGIN
[0m07:38:35.052574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:38:35.065576 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.065576 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:35.065576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:38:35.076576 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
[0m07:38:35.078576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E1F55D0>]}
[0m07:38:35.078576 [debug] [MainThread]: On master: ROLLBACK
[0m07:38:35.079576 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:35.079576 [debug] [MainThread]: On master: BEGIN
[0m07:38:35.080576 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:38:35.080576 [debug] [MainThread]: On master: COMMIT
[0m07:38:35.081576 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:35.081576 [debug] [MainThread]: On master: COMMIT
[0m07:38:35.082576 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.082576 [debug] [MainThread]: On master: Close
[0m07:38:35.082576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:38:35.083576 [info ] [MainThread]: 
[0m07:38:35.086576 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:38:35.087574 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:38:35.087574 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.087574 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:38:35.088575 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:38:35.089574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:38:35.091575 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.091575 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:38:35.124575 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:38:35.126574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.126574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:38:35.126574 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:38:35.140573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.140573 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.141574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:38:35.143573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:35.149574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.150574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:38:35.151575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:35.154574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.154574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:38:35.155574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:35.172574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:38:35.172574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.172574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:38:35.174575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.178573 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:38:35.179575 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:38:35.181574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:35.182574 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.182574 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:38:35.183573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E23FFA0>]}
[0m07:38:35.183573 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m07:38:35.184577 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:38:35.184577 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:38:35.185575 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:38:35.185575 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:38:35.186574 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:38:35.186574 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:38:35.188575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:38:35.189575 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.189575 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:38:35.194575 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:38:35.196575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:35.196575 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:38:35.196575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:35.210579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.210579 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:35.210579 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:38:35.215576 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:35.217576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:35.218575 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:38:35.219576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:35.220577 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:38:35.220577 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:35.220577 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:38:35.222575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.225573 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:38:35.226573 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:38:35.227575 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:35.228605 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.228605 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:38:35.228605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E2CCA30>]}
[0m07:38:35.229577 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.04s]
[0m07:38:35.229577 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:38:35.230577 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:38:35.230577 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:38:35.231576 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:38:35.231576 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:38:35.231576 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:38:35.233576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:38:35.235574 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.235574 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:38:35.239574 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:38:35.241575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:38:35.241575 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:38:35.241575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:35.255576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.255576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:38:35.255576 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:38:35.257575 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "comments" does not exist
LINE 14:     comments AS review_text,
             ^

[0m07:38:35.257575 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:38:35.258575 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.258575 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:38:35.259576 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "comments" does not exist
  LINE 14:     comments AS review_text,
               ^
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:38:35.259576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E26C2E0>]}
[0m07:38:35.259576 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.03s]
[0m07:38:35.260575 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:38:35.260575 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:35.261575 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:38:35.261575 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.262574 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:35.262574 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:38:35.265574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.266574 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.267574 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:35.271573 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.273574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.273574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:38:35.273574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:35.287576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.288574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.288574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:38:35.290574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:35.293574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.294573 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:38:35.295575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:35.297574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:38:35.297574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.297574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:38:35.300576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.302576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:38:35.302576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:38:35.303574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:35.305573 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.305573 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:38:35.305573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E2E13C0>]}
[0m07:38:35.306574 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m07:38:35.306574 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:38:35.307574 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:38:35.307574 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:38:35.308576 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.308576 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:38:35.308576 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:38:35.311574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.313573 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.314574 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:38:35.317575 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.319574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.320576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:38:35.320576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:35.334574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.335574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.335574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:38:35.338574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:35.341574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.341574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:38:35.342575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:35.344574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:38:35.344574 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.344574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:38:35.346573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.348576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:38:35.348576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:38:35.349574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:35.350574 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.351574 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:38:35.351574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E30CBE0>]}
[0m07:38:35.351574 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:38:35.352574 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:38:35.352574 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:38:35.353574 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:38:35.353574 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:38:35.354574 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:38:35.354574 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:38:35.355574 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.355574 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:38:35.355574 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:38:35.359574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.361574 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.361574 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:38:35.365576 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.367576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.367576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:38:35.367576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:38:35.381575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.382575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.382575 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:38:35.385575 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:38:35.388576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.388576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:38:35.389575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:38:35.390575 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:38:35.391576 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.391576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:38:35.393575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.395575 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:38:35.395575 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:38:35.396575 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:38:35.398576 [debug] [Thread-1 (]: finished collecting timing info
[0m07:38:35.398576 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:38:35.398576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a8f1609-6bed-4623-997b-1e680d8dcd89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E387B80>]}
[0m07:38:35.399576 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:38:35.399576 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:38:35.400574 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:38:35.400574 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:38:35.401574 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:38:35.401574 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:38:35.402574 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:35.402574 [debug] [MainThread]: On master: BEGIN
[0m07:38:35.402574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:38:35.415576 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:38:35.416575 [debug] [MainThread]: On master: COMMIT
[0m07:38:35.416575 [debug] [MainThread]: Using postgres connection "master"
[0m07:38:35.416575 [debug] [MainThread]: On master: COMMIT
[0m07:38:35.417575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:38:35.417575 [debug] [MainThread]: On master: Close
[0m07:38:35.418575 [info ] [MainThread]: 
[0m07:38:35.418575 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m07:38:35.418575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:38:35.419574 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:38:35.419574 [debug] [MainThread]: Connection 'list_postgres_dev' was properly closed.
[0m07:38:35.419574 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:38:35.459577 [info ] [MainThread]: 
[0m07:38:35.460575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:38:35.460575 [info ] [MainThread]: 
[0m07:38:35.461575 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:38:35.461575 [error] [MainThread]:   column "comments" does not exist
[0m07:38:35.462575 [error] [MainThread]:   LINE 14:     comments AS review_text,
[0m07:38:35.462575 [error] [MainThread]:                ^
[0m07:38:35.463574 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:38:35.463574 [info ] [MainThread]: 
[0m07:38:35.463574 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 TOTAL=8
[0m07:38:35.464574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E387C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E165300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC4E3979A0>]}


============================== 2022-08-22 07:39:17.854519 | 8199a952-8574-467a-972e-0203c863dcc9 ==============================
[0m07:39:17.854519 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:39:17.854519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:39:17.855518 [debug] [MainThread]: Tracking: tracking
[0m07:39:17.868518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DA8EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DA8ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DA8DD80>]}
[0m07:39:18.011518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:39:18.011518 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:39:18.023518 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:39:18.046519 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m07:39:18.052518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DD59840>]}
[0m07:39:18.087519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DD17F40>]}
[0m07:39:18.087519 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:39:18.088551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979D96DC60>]}
[0m07:39:18.089519 [info ] [MainThread]: 
[0m07:39:18.090518 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:39:18.092518 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:39:18.100517 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:39:18.100517 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:39:18.100517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:18.140518 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
[0m07:39:18.142520 [debug] [ThreadPool]: On list_postgres: Close
[0m07:39:18.143521 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:39:18.149522 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:39:18.149522 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:39:18.149522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:18.218336 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m07:39:18.219381 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:39:18.220337 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:39:18.235336 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m07:39:18.238378 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:39:18.242334 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:39:18.243332 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:39:18.250332 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:39:18.251333 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:39:18.251333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:39:18.291076 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:39:18.292070 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:39:18.292070 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:39:18.297068 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:39:18.299068 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:39:18.301072 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:39:18.311068 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:18.311068 [debug] [MainThread]: On master: BEGIN
[0m07:39:18.312070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:39:18.342069 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m07:39:18.343069 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:18.343069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:39:18.355340 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m07:39:18.356377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DDA9780>]}
[0m07:39:18.356377 [debug] [MainThread]: On master: ROLLBACK
[0m07:39:18.357788 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:18.357788 [debug] [MainThread]: On master: BEGIN
[0m07:39:18.358795 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:39:18.359795 [debug] [MainThread]: On master: COMMIT
[0m07:39:18.359795 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:18.359795 [debug] [MainThread]: On master: COMMIT
[0m07:39:18.360794 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.360794 [debug] [MainThread]: On master: Close
[0m07:39:18.360794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:18.361794 [info ] [MainThread]: 
[0m07:39:18.364794 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:39:18.364794 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:39:18.365794 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.365794 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:39:18.365794 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:39:18.367794 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:39:18.369793 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.369793 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:39:18.400825 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:39:18.402830 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.402830 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:39:18.402830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:39:18.436795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:39:18.437795 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.437795 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:39:18.439793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:18.444794 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.445793 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:39:18.446794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.449793 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.449793 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:39:18.450793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.466825 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:39:18.466825 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.466825 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:39:18.469793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.473795 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:18.474793 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:39:18.478180 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:18.479212 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.479212 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:39:18.480179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DE036D0>]}
[0m07:39:18.480179 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.11s]
[0m07:39:18.481179 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:39:18.481179 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:39:18.482178 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:39:18.482178 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.483179 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:39:18.483179 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:39:18.485179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:39:18.486179 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.487180 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:39:18.490177 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:39:18.492179 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.492179 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:39:18.492179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:18.505995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:39:18.505995 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.505995 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:39:18.508995 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:18.511993 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.511993 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:39:18.512994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.515994 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.515994 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:39:18.516996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.517995 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:39:18.518994 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.518994 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:39:18.521996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.523996 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:18.523996 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:39:18.527298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:18.528306 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.528306 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:39:18.529305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DE60520>]}
[0m07:39:18.529305 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:39:18.530304 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:39:18.530304 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:39:18.530304 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:39:18.531305 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:18.531305 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:39:18.531305 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:39:18.533335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:39:18.535304 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.535304 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:39:18.539303 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:39:18.541044 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:18.541044 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:39:18.541044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:18.576686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:39:18.577686 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:18.577686 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENT" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:39:18.578685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "COMMENT" does not exist
LINE 14:     "COMMENT" AS review_text,
             ^
HINT:  Perhaps you meant to reference the column "raw_reviews.COMMENTS".

[0m07:39:18.578685 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: ROLLBACK
[0m07:39:18.579687 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.579687 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:39:18.580686 [debug] [Thread-1 (]: Database Error in model src_reviews (models\src\src_reviews.sql)
  column "COMMENT" does not exist
  LINE 14:     "COMMENT" AS review_text,
               ^
  HINT:  Perhaps you meant to reference the column "raw_reviews.COMMENTS".
  compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:39:18.580686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DE70D00>]}
[0m07:39:18.580686 [error] [Thread-1 (]: 3 of 8 ERROR creating view model dbo.src_reviews ............................... [[31mERROR[0m in 0.05s]
[0m07:39:18.582699 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:39:18.583690 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:18.584691 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:39:18.585687 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.585687 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:18.586689 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:39:18.591687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.595688 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.596687 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:18.609729 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.612744 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.613791 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:39:18.614758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:18.655551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:39:18.655551 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.656581 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:39:18.660547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:18.666547 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.667599 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:39:18.670037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.672052 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:39:18.672052 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.673047 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:39:18.675703 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.679143 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:18.679143 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:39:18.680850 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:18.682633 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.682633 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:39:18.683211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DE98A00>]}
[0m07:39:18.683725 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m07:39:18.685125 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:18.685719 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:39:18.686231 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:39:18.686774 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.687321 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:39:18.687856 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:39:18.691499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.693498 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.694499 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:39:18.699503 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.702499 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.702499 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:39:18.702499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:18.732173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:39:18.732173 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.732173 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:39:18.736107 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:18.738117 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.739117 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:39:18.740117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.741118 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:39:18.741118 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.742117 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:39:18.743709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.746716 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:18.746716 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:39:18.747714 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:18.748714 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.748714 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:39:18.748714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DF08A90>]}
[0m07:39:18.749714 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m07:39:18.749714 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:39:18.750715 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:39:18.750715 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbo.fct_reviews ........................................... [[33mSKIP[0m]
[0m07:39:18.751714 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:39:18.751714 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:39:18.751714 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:39:18.752714 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.752714 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:39:18.753255 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:39:18.756929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.758482 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.758999 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:39:18.762687 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.764262 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.764785 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:39:18.764785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:18.785953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:39:18.785953 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.785953 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:39:18.789956 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:18.791954 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.792954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:39:18.793953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:18.794954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:39:18.794954 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.794954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:39:18.796951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.798953 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:39:18.798953 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:39:18.799954 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:18.801956 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:18.801956 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:39:18.801956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8199a952-8574-467a-972e-0203c863dcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DE74400>]}
[0m07:39:18.802956 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.05s]
[0m07:39:18.803952 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:39:18.803952 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:39:18.804710 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbo.mart_fullmoon_reviews ................................. [[33mSKIP[0m]
[0m07:39:18.805222 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:39:18.806256 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:39:18.806256 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:18.806256 [debug] [MainThread]: On master: BEGIN
[0m07:39:18.806256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:39:18.819811 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:39:18.819811 [debug] [MainThread]: On master: COMMIT
[0m07:39:18.819811 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:18.819811 [debug] [MainThread]: On master: COMMIT
[0m07:39:18.820810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:39:18.820810 [debug] [MainThread]: On master: Close
[0m07:39:18.821810 [info ] [MainThread]: 
[0m07:39:18.821810 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m07:39:18.822809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:18.822809 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:39:18.822809 [debug] [MainThread]: Connection 'list_postgres_dev' was properly closed.
[0m07:39:18.822809 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:39:18.862089 [info ] [MainThread]: 
[0m07:39:18.863091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:39:18.864109 [info ] [MainThread]: 
[0m07:39:18.864109 [error] [MainThread]: [33mDatabase Error in model src_reviews (models\src\src_reviews.sql)[0m
[0m07:39:18.865090 [error] [MainThread]:   column "COMMENT" does not exist
[0m07:39:18.866090 [error] [MainThread]:   LINE 14:     "COMMENT" AS review_text,
[0m07:39:18.866090 [error] [MainThread]:                ^
[0m07:39:18.866090 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "raw_reviews.COMMENTS".
[0m07:39:18.867089 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\src\src_reviews.sql
[0m07:39:18.867089 [info ] [MainThread]: 
[0m07:39:18.867089 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=2 TOTAL=8
[0m07:39:18.868089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DD15270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DF2FD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001979DED3A30>]}


============================== 2022-08-22 07:39:30.729396 | a209629e-3b59-4a31-92fb-e1b2a4baef3f ==============================
[0m07:39:30.729396 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:39:30.730396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:39:30.730396 [debug] [MainThread]: Tracking: tracking
[0m07:39:30.742367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552349DFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552349C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552349D420>]}
[0m07:39:30.888398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:39:30.889396 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\src\src_reviews.sql
[0m07:39:30.900396 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:39:30.923370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m07:39:30.929396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255237698A0>]}
[0m07:39:31.254820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552372BFD0>]}
[0m07:39:31.254820 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:39:31.255819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255236E1C90>]}
[0m07:39:31.256819 [info ] [MainThread]: 
[0m07:39:31.257818 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:39:31.258818 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:39:31.267819 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:39:31.267819 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:39:31.267819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:31.314604 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.05 seconds
[0m07:39:31.319600 [debug] [ThreadPool]: On list_postgres: Close
[0m07:39:31.325601 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:39:31.341632 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:39:31.342639 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:39:31.343645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:39:31.401809 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m07:39:31.402813 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:39:31.403811 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:39:31.410805 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m07:39:31.412848 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:39:31.415843 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:39:31.416814 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:39:31.422810 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:39:31.423812 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:39:31.423812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:39:31.480009 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m07:39:31.480009 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:39:31.481008 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:39:31.488323 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m07:39:31.492316 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:39:31.495018 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:39:31.508059 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:31.509056 [debug] [MainThread]: On master: BEGIN
[0m07:39:31.510027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:39:31.539274 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m07:39:31.540273 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:31.540273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:39:31.555306 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
[0m07:39:31.557274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255237DB3A0>]}
[0m07:39:31.558273 [debug] [MainThread]: On master: ROLLBACK
[0m07:39:31.558940 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:31.558940 [debug] [MainThread]: On master: BEGIN
[0m07:39:31.560948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:39:31.561948 [debug] [MainThread]: On master: COMMIT
[0m07:39:31.561948 [debug] [MainThread]: Using postgres connection "master"
[0m07:39:31.561948 [debug] [MainThread]: On master: COMMIT
[0m07:39:31.562947 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:39:31.562947 [debug] [MainThread]: On master: Close
[0m07:39:31.563948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:39:31.564949 [info ] [MainThread]: 
[0m07:39:31.568948 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:39:31.568948 [info ] [Thread-1 (]: 1 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:39:31.569948 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.569948 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:39:31.570949 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:39:31.574955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:39:31.580961 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.581997 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:39:31.643948 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:39:31.644949 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.645949 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:39:31.645949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:39:31.679950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:39:31.679950 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.679950 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:39:31.682949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:31.688949 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.688949 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:39:31.689951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.692949 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.693949 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:39:31.694952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.709949 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:39:31.710950 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.710950 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:39:31.714303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:31.719255 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:39:31.719255 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:39:31.723256 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:31.724257 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.724257 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:39:31.725257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025523813670>]}
[0m07:39:31.725257 [info ] [Thread-1 (]: 1 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.16s]
[0m07:39:31.726257 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:39:31.727257 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:39:31.727257 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:39:31.728257 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.728257 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:39:31.728257 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:39:31.730257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:39:31.731256 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.732256 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:39:31.735257 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:39:31.737258 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.737258 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:39:31.737258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:31.751257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:39:31.751257 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.751257 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:39:31.755258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:31.757257 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.757257 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:39:31.759257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.762256 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.762256 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:39:31.763260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.765261 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:39:31.765261 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.765261 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:39:31.767258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:31.770256 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:39:31.770256 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:39:31.773257 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:31.774257 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.774257 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:39:31.774257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025523870580>]}
[0m07:39:31.775258 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:39:31.775258 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:39:31.776257 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:39:31.776257 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:39:31.777258 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:31.777258 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:39:31.777258 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:39:31.779257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:39:31.780258 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.781258 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:39:31.784257 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:39:31.786259 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:31.786259 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:39:31.786259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:31.800257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:39:31.800257 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:31.800257 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:39:31.802258 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:31.805258 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:31.805258 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m07:39:31.806259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.808258 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:39:31.808258 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:31.808258 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:39:31.810271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:31.812261 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:39:31.812261 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m07:39:31.813265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:31.814258 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.815258 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:39:31.815258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255238A81C0>]}
[0m07:39:31.815258 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:39:31.816260 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:39:31.817262 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:31.817262 [info ] [Thread-1 (]: 4 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:39:31.818259 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.818259 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:31.818259 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:39:31.822257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.823259 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.823259 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:31.827259 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.829261 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.829261 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:39:31.829261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:31.844258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:39:31.844258 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.844258 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:39:31.846261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:31.849257 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.849257 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:39:31.850258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.851260 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:39:31.852258 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.852258 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:39:31.854279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:31.856257 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:39:31.856257 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:39:31.857258 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:31.858259 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.858259 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:39:31.858259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025523881330>]}
[0m07:39:31.859260 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m07:39:31.860266 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:39:31.860266 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:39:31.860266 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:39:31.861261 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.861261 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:39:31.861261 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:39:31.864258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.866259 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.866259 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:39:31.870260 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.872259 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.872259 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:39:31.873259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:31.886259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:39:31.887260 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.887260 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:39:31.890075 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:39:31.893116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.893116 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:39:31.894083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:39:31.895114 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:39:31.895114 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.896080 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:39:31.898114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:39:31.900116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:39:31.900116 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:39:31.901115 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:39:31.902117 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.902117 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:39:31.902117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255238CADD0>]}
[0m07:39:31.903118 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:39:31.904115 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:39:31.904115 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:39:31.904115 [info ] [Thread-1 (]: 6 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m07:39:31.905115 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:39:31.905115 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:39:31.905115 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:39:31.924147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:39:31.926146 [debug] [Thread-1 (]: finished collecting timing info
[0m07:39:31.927115 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:39:31.958147 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m07:39:31.960100 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:39:31.960100 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m07:39:31.960100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:39:31.993606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:39:31.993606 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:39:31.993606 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

  create  table "postgres"."dbo"."fct_reviews"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


  );
  
[0m07:40:07.477804 [debug] [Thread-1 (]: SQL status: SELECT 3659460 in 35.48 seconds
[0m07:40:07.482771 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:40:07.482771 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:40:07.482771 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:40:07.489772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m07:40:07.490772 [debug] [Thread-1 (]: finished collecting timing info
[0m07:40:07.490772 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m07:40:07.491772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255237DB6A0>]}
[0m07:40:07.491772 [info ] [Thread-1 (]: 6 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mSELECT 3659460[0m in 35.59s]
[0m07:40:07.492773 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:40:07.492773 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:40:07.493773 [info ] [Thread-1 (]: 7 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:40:07.493773 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.493773 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:40:07.494772 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:40:07.496770 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.498772 [debug] [Thread-1 (]: finished collecting timing info
[0m07:40:07.499771 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:40:07.502771 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.504772 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.505772 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:40:07.505772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:07.520772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:40:07.521772 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.521772 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:40:07.523773 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:40:07.526771 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.526771 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:40:07.528773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:40:07.529772 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:40:07.529772 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.529772 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:40:07.531773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:40:07.533772 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:40:07.534771 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:40:07.535773 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:40:07.536772 [debug] [Thread-1 (]: finished collecting timing info
[0m07:40:07.536772 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:40:07.536772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552378F9D0>]}
[0m07:40:07.537773 [info ] [Thread-1 (]: 7 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:40:07.537773 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:40:07.538773 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:40:07.538773 [info ] [Thread-1 (]: 8 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m07:40:07.539773 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:40:07.539773 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:40:07.539773 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:40:07.542772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:40:07.544773 [debug] [Thread-1 (]: finished collecting timing info
[0m07:40:07.545772 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:40:07.557772 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:40:07.559773 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:40:07.559773 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m07:40:07.560773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:40:07.573773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:40:07.574773 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:40:07.574773 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM "postgres"."dbo"."fct_reviews"
),

full_moon_dates AS (
    SELECT * FROM "postgres"."dbo"."seed_full_moon_dates"
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m07:40:07.575773 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM "postgres"."dbo"."seed_full_moon_dates"
                           ^

[0m07:40:07.575773 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m07:40:07.576773 [debug] [Thread-1 (]: finished collecting timing info
[0m07:40:07.576773 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m07:40:07.576773 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM "postgres"."dbo"."seed_full_moon_dates"
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:40:07.577775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a209629e-3b59-4a31-92fb-e1b2a4baef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025523872CB0>]}
[0m07:40:07.577775 [error] [Thread-1 (]: 8 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.04s]
[0m07:40:07.578774 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:40:07.579774 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:40:07.579774 [debug] [MainThread]: Using postgres connection "master"
[0m07:40:07.579774 [debug] [MainThread]: On master: BEGIN
[0m07:40:07.579774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:40:07.592774 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:40:07.592774 [debug] [MainThread]: On master: COMMIT
[0m07:40:07.593774 [debug] [MainThread]: Using postgres connection "master"
[0m07:40:07.593774 [debug] [MainThread]: On master: COMMIT
[0m07:40:07.593774 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:40:07.594774 [debug] [MainThread]: On master: Close
[0m07:40:07.594774 [info ] [MainThread]: 
[0m07:40:07.594774 [info ] [MainThread]: Finished running 6 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 36.34 seconds (36.34s).
[0m07:40:07.595774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:40:07.595774 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:40:07.595774 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:40:07.595774 [debug] [MainThread]: Connection 'model.dbtpostgres.mart_fullmoon_reviews' was properly closed.
[0m07:40:07.635707 [info ] [MainThread]: 
[0m07:40:07.636741 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:40:07.637712 [info ] [MainThread]: 
[0m07:40:07.637712 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m07:40:07.638713 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m07:40:07.639712 [error] [MainThread]:   LINE 14:     SELECT * FROM "postgres"."dbo"."seed_full_moon_dates"
[0m07:40:07.639712 [error] [MainThread]:                              ^
[0m07:40:07.639712 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:40:07.640712 [info ] [MainThread]: 
[0m07:40:07.640712 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m07:40:07.641712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552386BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002552386BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025523870FD0>]}


============================== 2022-08-22 07:42:35.863096 | 5f68f87e-d421-4f71-9d28-ee72aa0c1307 ==============================
[0m07:42:35.863096 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:42:35.864101 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:42:35.864101 [debug] [MainThread]: Tracking: tracking
[0m07:42:35.877773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374DF9EE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374DF9ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374DF9DD80>]}
[0m07:42:36.020812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:42:36.021784 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m07:42:36.033788 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m07:42:36.056819 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src

[0m07:42:36.062782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E269840>]}
[0m07:42:36.098786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E227EB0>]}
[0m07:42:36.098786 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:42:36.099804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374DE7E4A0>]}
[0m07:42:36.100816 [info ] [MainThread]: 
[0m07:42:36.101814 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:42:36.102814 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:42:36.111814 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:42:36.111814 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:42:36.112789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:36.151375 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
[0m07:42:36.152381 [debug] [ThreadPool]: On list_postgres: Close
[0m07:42:36.153381 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:42:36.159379 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:42:36.159379 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:42:36.159379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:36.196018 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:42:36.197024 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:42:36.197024 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:42:36.199024 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:42:36.200024 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:42:36.201024 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:42:36.202024 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:42:36.204024 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:42:36.204024 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:42:36.204024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:36.216314 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:42:36.217320 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:42:36.217320 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:42:36.219319 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m07:42:36.221320 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:42:36.221320 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:42:36.226319 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:36.227318 [debug] [MainThread]: On master: BEGIN
[0m07:42:36.227318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:36.244317 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m07:42:36.244317 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:36.244317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:36.257316 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:42:36.258318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E2DF0A0>]}
[0m07:42:36.259318 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:36.260317 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:36.260317 [debug] [MainThread]: On master: BEGIN
[0m07:42:36.262344 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:42:36.262344 [debug] [MainThread]: On master: COMMIT
[0m07:42:36.262344 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:36.262344 [debug] [MainThread]: On master: COMMIT
[0m07:42:36.263743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:42:36.263743 [debug] [MainThread]: On master: Close
[0m07:42:36.263743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:36.264749 [info ] [MainThread]: 
[0m07:42:36.267749 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:36.267749 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m07:42:36.268749 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:36.268749 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:36.268749 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:36.271749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:36.272750 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.273750 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:36.306781 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:36.309024 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:36.309024 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m07:42:36.309024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:42:36.323504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:36.323504 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:36.324504 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fc_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m07:42:36.324504 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.fc_reviews" does not exist
LINE 10:     SELECT * FROM postgres.dbo.fc_reviews
                           ^

[0m07:42:36.325503 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m07:42:36.325503 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.326505 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m07:42:36.326505 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.fc_reviews" does not exist
  LINE 10:     SELECT * FROM postgres.dbo.fc_reviews
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:42:36.326505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E317880>]}
[0m07:42:36.327504 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.06s]
[0m07:42:36.327504 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:36.328505 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:42:36.328505 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:42:36.329505 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.329505 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:42:36.329505 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:42:36.331504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:42:36.332505 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.333504 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:42:36.350535 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:42:36.351539 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.352505 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:42:36.352505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:36.400632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m07:42:36.400632 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.401626 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:42:36.407627 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m07:42:36.416656 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.416656 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:42:36.419378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.423420 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.423420 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:42:36.425390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.446418 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:42:36.447425 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.447425 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:42:36.470908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m07:42:36.475908 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:36.475908 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:42:36.478906 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:36.480909 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.480909 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:42:36.480909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E2DDB40>]}
[0m07:42:36.481909 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.15s]
[0m07:42:36.481909 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:42:36.482907 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:42:36.482907 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:42:36.483920 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.483920 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:42:36.483920 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:42:36.485925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:42:36.487477 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.487477 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:42:36.492482 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:42:36.493514 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.493514 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:42:36.494485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:36.507990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:36.507990 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.508988 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:42:36.510987 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:36.512988 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.513986 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:42:36.514627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.516664 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.517663 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:42:36.518634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.519636 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:42:36.519636 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.519636 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:42:36.522216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:36.524245 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:36.524245 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:42:36.527214 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:36.528214 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.529215 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:42:36.529215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E2DE4D0>]}
[0m07:42:36.529215 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:42:36.530215 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:42:36.530215 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:42:36.531215 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:42:36.531215 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.532214 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:42:36.532214 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:42:36.533214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:42:36.535214 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.535214 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:42:36.540215 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:42:36.541214 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.542214 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:42:36.542214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:36.556216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:36.556216 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.556216 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:42:36.559215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:36.561214 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.562218 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m07:42:36.563217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.565215 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.565215 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m07:42:36.566215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.568217 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:42:36.568217 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.568217 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:42:36.606950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m07:42:36.608947 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:36.608947 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m07:42:36.611955 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:36.612947 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.612947 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:42:36.613947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E369450>]}
[0m07:42:36.613947 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.08s]
[0m07:42:36.614947 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:42:36.614947 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:36.615950 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:42:36.616619 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.616619 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:36.616619 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:42:36.619658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.620625 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.621626 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:36.624657 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.626625 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.626625 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:42:36.626625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:36.660367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:42:36.660367 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.661367 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:42:36.663366 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:36.666367 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.666367 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:42:36.667470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.669479 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:42:36.669479 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.669479 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:42:36.751523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.08 seconds
[0m07:42:36.759519 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:36.760560 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:42:36.765515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:36.769518 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.770515 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:42:36.771588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E3F4F40>]}
[0m07:42:36.773517 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m07:42:36.776571 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:36.777513 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:42:36.779517 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:42:36.781510 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.782577 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:42:36.783582 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:42:36.793539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.798567 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.798567 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:42:36.805571 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.808529 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.809527 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:42:36.809527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:36.845529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:42:36.845529 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.846563 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:42:36.851308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:36.857326 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.858330 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:42:36.863336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:36.868329 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:42:36.869328 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.870327 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:42:36.877428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m07:42:36.887451 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:36.888418 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:42:36.890358 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:36.892353 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.893354 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:42:36.894353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E3AAA70>]}
[0m07:42:36.895353 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m07:42:36.897355 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:42:36.897355 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:42:36.898360 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m07:42:36.900355 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:36.900355 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:42:36.901399 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:42:36.929378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:42:36.932350 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:36.932350 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:42:36.957380 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:36.957380 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp144236951379"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m07:42:36.957380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:38.775730 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.82 seconds
[0m07:42:38.781767 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.782763 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m07:42:38.783729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:42:38.783729 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.783729 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp144236951379'
        
      order by ordinal_position

  
[0m07:42:38.791729 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m07:42:38.796758 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.797758 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:42:38.800729 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:42:38.812760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.812760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp144236951379'
        
      order by ordinal_position

  
[0m07:42:38.815728 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:42:38.818760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.818760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:42:38.821730 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:42:38.828759 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:42:38.836760 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m07:42:38.837729 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.838729 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp144236951379"
    )
  
[0m07:42:38.839733 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m07:42:38.840762 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:42:38.841759 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:38.841759 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:42:38.844731 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:38.844731 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:38.844731 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m07:42:38.845729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E42C640>]}
[0m07:42:38.845729 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.95s]
[0m07:42:38.846732 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:42:38.846732 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:38.847729 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:42:38.847729 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.847729 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:38.848729 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:42:38.851729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.852729 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:38.853729 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:38.856729 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.858729 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.859729 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:42:38.859729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:38.872760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:38.872760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.872760 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:42:38.875728 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:38.878730 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.879728 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:42:38.880730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:38.881730 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:42:38.881730 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.881730 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:42:38.883731 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:38.911763 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:38.911763 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:42:38.912767 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:38.913761 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:38.913761 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:42:38.914764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f68f87e-d421-4f71-9d28-ee72aa0c1307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E4C9030>]}
[0m07:42:38.914764 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m07:42:38.915731 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:38.916773 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:42:38.916773 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:38.917731 [debug] [MainThread]: On master: BEGIN
[0m07:42:38.917731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:38.930730 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:42:38.930730 [debug] [MainThread]: On master: COMMIT
[0m07:42:38.930730 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:38.931731 [debug] [MainThread]: On master: COMMIT
[0m07:42:38.931731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:42:38.931731 [debug] [MainThread]: On master: Close
[0m07:42:38.932731 [info ] [MainThread]: 
[0m07:42:38.932731 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m07:42:38.933733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:38.933733 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:42:38.933733 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:42:38.933733 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:42:38.971777 [info ] [MainThread]: 
[0m07:42:38.972732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:42:38.973733 [info ] [MainThread]: 
[0m07:42:38.973733 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m07:42:38.974733 [error] [MainThread]:   relation "dbo.fc_reviews" does not exist
[0m07:42:38.975731 [error] [MainThread]:   LINE 10:     SELECT * FROM postgres.dbo.fc_reviews
[0m07:42:38.975731 [error] [MainThread]:                              ^
[0m07:42:38.975731 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:42:38.976731 [info ] [MainThread]: 
[0m07:42:38.976731 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m07:42:38.977731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E4CA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E4CA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002374E4491B0>]}


============================== 2022-08-22 07:42:57.831383 | 41afd6e6-3015-4f92-873c-8068ba8c8e36 ==============================
[0m07:42:57.831383 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:42:57.831383 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:42:57.831383 [debug] [MainThread]: Tracking: tracking
[0m07:42:57.844383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CA3C760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CA3E080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CA3CD30>]}
[0m07:42:57.985386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:42:57.985386 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m07:42:57.997386 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m07:42:58.021417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres.src
- models.dbt_postgres

[0m07:42:58.026386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CD09870>]}
[0m07:42:58.064418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CC819C0>]}
[0m07:42:58.065388 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:42:58.065388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278C91E6E0>]}
[0m07:42:58.067388 [info ] [MainThread]: 
[0m07:42:58.068128 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:42:58.069134 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:42:58.077164 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:42:58.078164 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:42:58.078164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:58.116449 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
[0m07:42:58.117449 [debug] [ThreadPool]: On list_postgres: Close
[0m07:42:58.119449 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:42:58.125448 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:42:58.125448 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:42:58.125448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:58.161954 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:42:58.161954 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:42:58.161954 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:42:58.164991 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:42:58.165961 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:42:58.166962 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:42:58.167960 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:42:58.169960 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:42:58.169960 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:42:58.169960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:58.181962 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:42:58.182960 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:42:58.182960 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:42:58.184963 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m07:42:58.186960 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:42:58.186960 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:42:58.191963 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:58.192964 [debug] [MainThread]: On master: BEGIN
[0m07:42:58.192964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:58.205863 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:42:58.206862 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:58.206862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:58.218862 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:42:58.219863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CD41C90>]}
[0m07:42:58.220862 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:58.221831 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:58.221831 [debug] [MainThread]: On master: BEGIN
[0m07:42:58.223863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:42:58.223863 [debug] [MainThread]: On master: COMMIT
[0m07:42:58.223863 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:58.223863 [debug] [MainThread]: On master: COMMIT
[0m07:42:58.224864 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:42:58.224864 [debug] [MainThread]: On master: Close
[0m07:42:58.225863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:58.225863 [info ] [MainThread]: 
[0m07:42:58.228863 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:58.229863 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m07:42:58.229863 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:58.229863 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:58.230863 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:58.232863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:58.235106 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.235106 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:58.268143 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:58.270144 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:58.270144 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m07:42:58.270144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:42:58.305114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:42:58.306113 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:42:58.306113 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m07:42:58.307114 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                           ^

[0m07:42:58.307114 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m07:42:58.308113 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.308113 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m07:42:58.308113 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:42:58.309113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CDB1BA0>]}
[0m07:42:58.309113 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m07:42:58.310114 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:42:58.310114 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:42:58.311114 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:42:58.311114 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.311114 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:42:58.312113 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:42:58.313112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:42:58.315114 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.315114 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:42:58.332112 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:42:58.334116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.334116 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:42:58.334116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:58.367562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:42:58.368561 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.368561 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:42:58.370562 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:58.375560 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.376562 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:42:58.377561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.379562 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.379562 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:42:58.381561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.396592 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:42:58.396592 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.396592 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:42:58.399420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:58.403457 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:42:58.404425 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:42:58.407427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:58.408426 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.408426 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:42:58.409426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CD42500>]}
[0m07:42:58.409426 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m07:42:58.410426 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:42:58.410426 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:42:58.411430 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:42:58.411430 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.411430 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:42:58.412426 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:42:58.413425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:42:58.415427 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.415427 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:42:58.420427 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:42:58.422426 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.422426 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:42:58.422426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:58.437428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:42:58.437428 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.438429 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:42:58.441427 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:58.443426 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.444428 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:42:58.445429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.448426 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.448426 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:42:58.449428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.450427 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:42:58.450427 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.451427 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:42:58.453427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:58.455427 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:42:58.455427 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:42:58.457427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:58.458427 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.459427 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:42:58.459427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CDF2C80>]}
[0m07:42:58.459427 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:42:58.460430 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:42:58.461431 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:42:58.461431 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:42:58.462428 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.462428 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:42:58.462428 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:42:58.464426 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:42:58.466429 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.466429 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:42:58.470427 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:42:58.472458 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.472458 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:42:58.472458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:58.486429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:58.486429 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.487428 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:42:58.489428 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:58.492428 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.492428 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m07:42:58.493429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.495427 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.495427 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m07:42:58.497428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.498429 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:42:58.499428 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.499428 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:42:58.501431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:58.503465 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:42:58.503465 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m07:42:58.506459 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:58.507460 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.507460 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:42:58.507460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CE11480>]}
[0m07:42:58.508429 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m07:42:58.509429 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:42:58.509429 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:58.509429 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:42:58.510430 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.510430 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:58.510430 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:42:58.513429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.515428 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.515428 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:58.518431 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.520465 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.520465 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:42:58.520465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:58.533879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:58.534918 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.534918 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:42:58.536884 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:58.539884 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.540885 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:42:58.541886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.542885 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:42:58.542885 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.542885 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:42:58.544886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:58.546885 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:42:58.547886 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:42:58.549187 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:58.550224 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.550224 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:42:58.550224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CE98F70>]}
[0m07:42:58.551194 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m07:42:58.551194 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:42:58.552193 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:42:58.552193 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:42:58.552193 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.553193 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:42:58.553193 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:42:58.555193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.557193 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.557193 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:42:58.561193 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.562981 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.562981 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:42:58.562981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:58.576951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:58.576951 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.576951 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:42:58.579949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:58.582949 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.582949 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:42:58.583950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:58.584950 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:42:58.584950 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.585953 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:42:58.587952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:58.590951 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:42:58.590951 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:42:58.592397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:58.593407 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.593407 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:42:58.593407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CD41510>]}
[0m07:42:58.594407 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:42:58.595406 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:42:58.595406 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:42:58.595406 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m07:42:58.596406 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:58.596406 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:42:58.596406 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:42:58.617434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:42:58.619439 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:58.619439 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:42:58.644435 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:58.645435 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp144258638405"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m07:42:58.645435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:59.741616 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.1 seconds
[0m07:42:59.748585 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.748585 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m07:42:59.749587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:42:59.749587 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.750586 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp144258638405'
        
      order by ordinal_position

  
[0m07:42:59.755588 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m07:42:59.761586 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.761586 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:42:59.764621 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:42:59.776586 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.776586 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp144258638405'
        
      order by ordinal_position

  
[0m07:42:59.780018 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:42:59.783020 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.783020 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:42:59.786018 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:42:59.794018 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:42:59.801018 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m07:42:59.802988 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.802988 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp144258638405"
    )
  
[0m07:42:59.804120 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m07:42:59.806156 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:42:59.806156 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:42:59.806156 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:42:59.808163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:59.809125 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:59.809125 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m07:42:59.809125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CE7A3B0>]}
[0m07:42:59.810126 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.21s]
[0m07:42:59.811130 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:42:59.811130 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:59.812144 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:42:59.812144 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.813126 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:59.813126 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:42:59.816252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.818347 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:59.818876 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:59.822503 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.824646 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.824646 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:42:59.825166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:59.838374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:42:59.838897 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.838897 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:42:59.842022 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:42:59.846902 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.846902 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:42:59.847910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:42:59.848911 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:42:59.849909 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.849909 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:42:59.851909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:42:59.881851 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:42:59.882852 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:42:59.883853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:42:59.884853 [debug] [Thread-1 (]: finished collecting timing info
[0m07:42:59.884853 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:42:59.885852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41afd6e6-3015-4f92-873c-8068ba8c8e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CF6D060>]}
[0m07:42:59.885852 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.07s]
[0m07:42:59.886851 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:42:59.887851 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:42:59.887851 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:59.887851 [debug] [MainThread]: On master: BEGIN
[0m07:42:59.887851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:42:59.901852 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:42:59.901852 [debug] [MainThread]: On master: COMMIT
[0m07:42:59.901852 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:59.902852 [debug] [MainThread]: On master: COMMIT
[0m07:42:59.902852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:42:59.902852 [debug] [MainThread]: On master: Close
[0m07:42:59.903852 [info ] [MainThread]: 
[0m07:42:59.903852 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m07:42:59.904854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:59.904854 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:42:59.904854 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:42:59.904854 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:42:59.941856 [info ] [MainThread]: 
[0m07:42:59.942853 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:42:59.943889 [info ] [MainThread]: 
[0m07:42:59.943889 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m07:42:59.944884 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m07:42:59.945878 [error] [MainThread]:   LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
[0m07:42:59.945878 [error] [MainThread]:                              ^
[0m07:42:59.946890 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:42:59.946890 [info ] [MainThread]: 
[0m07:42:59.947886 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m07:42:59.947886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CF6E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CF6E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002278CEF51E0>]}


============================== 2022-08-22 07:51:14.575641 | d0ed01a0-3106-4e5e-a78b-3915f0d708d8 ==============================
[0m07:51:14.575641 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:51:14.575641 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:51:14.575641 [debug] [MainThread]: Tracking: tracking
[0m07:51:14.592627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2E3CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2E3D570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2E3F040>]}
[0m07:51:14.650648 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:51:14.650648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2E37850>]}
[0m07:51:14.740649 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m07:51:14.741633 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m07:51:14.741633 [debug] [MainThread]: Parsing macros\adapters.sql
[0m07:51:14.764649 [debug] [MainThread]: Parsing macros\catalog.sql
[0m07:51:14.766620 [debug] [MainThread]: Parsing macros\relations.sql
[0m07:51:14.767649 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m07:51:14.768649 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:51:14.769649 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:51:14.769649 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:51:14.775650 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:51:14.776650 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:51:14.777650 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:51:14.778649 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m07:51:14.791620 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m07:51:14.799649 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m07:51:14.802619 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m07:51:14.805620 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m07:51:14.811650 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m07:51:14.815650 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m07:51:14.828650 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m07:51:14.830650 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m07:51:14.837827 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m07:51:14.841515 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m07:51:14.843068 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m07:51:14.843068 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m07:51:14.844073 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m07:51:14.845074 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m07:51:14.846073 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m07:51:14.848074 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m07:51:14.850072 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m07:51:14.852074 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m07:51:14.855073 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m07:51:14.859105 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m07:51:14.867107 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m07:51:14.868104 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m07:51:14.881076 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m07:51:14.894109 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m07:51:14.896102 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m07:51:14.901106 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m07:51:14.904105 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m07:51:14.906076 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m07:51:14.907105 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m07:51:14.912105 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m07:51:14.927105 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m07:51:14.933692 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m07:51:14.944501 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m07:51:14.955501 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m07:51:14.957983 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m07:51:14.972122 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m07:51:14.974122 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m07:51:14.978123 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m07:51:14.980123 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:51:14.980123 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m07:51:14.982124 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m07:51:14.983124 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m07:51:14.984123 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m07:51:14.989115 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:51:14.991116 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:51:14.992114 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m07:51:14.993112 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m07:51:14.994113 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m07:51:14.995115 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m07:51:14.996115 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m07:51:14.996115 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:51:14.998116 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m07:51:14.999115 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:51:15.001115 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m07:51:15.002116 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m07:51:15.003144 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m07:51:15.004816 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m07:51:15.006420 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m07:51:15.007461 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:51:15.009016 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m07:51:15.012127 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m07:51:15.016304 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m07:51:15.016830 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m07:51:15.025837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m07:51:15.028837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m07:51:15.030837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m07:51:15.033837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m07:51:15.034836 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m07:51:15.036837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m07:51:15.047837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m07:51:15.050837 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m07:51:15.055836 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m07:51:15.060837 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m07:51:15.062836 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m07:51:15.067836 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m07:51:15.072868 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m07:51:15.073873 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m07:51:15.095868 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m07:51:15.109869 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m07:51:15.119868 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m07:51:15.124873 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m07:51:15.128868 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m07:51:15.132869 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m07:51:15.139871 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m07:51:15.142868 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m07:51:15.145869 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m07:51:15.150872 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m07:51:15.154869 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m07:51:15.161870 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m07:51:15.162869 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m07:51:15.172869 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m07:51:15.174869 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m07:51:15.175874 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m07:51:15.177839 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m07:51:15.196867 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m07:51:15.198840 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m07:51:15.202869 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m07:51:15.237839 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m07:51:15.249838 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m07:51:15.259839 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m07:51:15.269840 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m07:51:15.283839 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m07:51:15.301839 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m07:51:15.309840 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m07:51:15.310839 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m07:51:15.311839 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m07:51:15.346840 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m07:51:15.360839 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m07:51:15.370840 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m07:51:15.382840 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m07:51:15.394839 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m07:51:15.416866 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m07:51:15.425867 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m07:51:15.431842 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m07:51:15.438874 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m07:51:15.472872 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m07:51:15.484872 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m07:51:15.495876 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m07:51:15.506878 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m07:51:15.521873 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m07:51:15.522872 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m07:51:15.530845 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m07:51:15.531842 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m07:51:15.532844 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m07:51:15.534841 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m07:51:15.535843 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m07:51:15.537843 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m07:51:15.540841 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m07:51:15.541842 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m07:51:15.543873 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m07:51:15.545873 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m07:51:15.546873 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m07:51:15.549873 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m07:51:15.554873 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m07:51:15.557873 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m07:51:15.565844 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m07:51:15.566872 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m07:51:15.568845 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m07:51:15.569844 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m07:51:15.570845 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m07:51:15.572843 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m07:51:15.573841 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m07:51:15.576842 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m07:51:15.577842 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m07:51:15.584873 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m07:51:15.585874 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m07:51:15.587876 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m07:51:15.588873 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m07:51:15.590873 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m07:51:15.591873 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m07:51:15.596874 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m07:51:15.601877 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m07:51:15.603876 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m07:51:15.604873 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m07:51:15.606873 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m07:51:15.607874 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m07:51:15.609873 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m07:51:15.612873 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m07:51:15.613873 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m07:51:15.615874 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m07:51:15.617874 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m07:51:15.624874 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m07:51:15.626873 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m07:51:15.627874 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m07:51:15.629873 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m07:51:15.630876 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m07:51:15.632874 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m07:51:15.635873 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m07:51:15.636874 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m07:51:15.637872 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m07:51:15.640874 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m07:51:15.641874 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m07:51:15.642875 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m07:51:15.643875 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m07:51:15.644875 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m07:51:15.664866 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m07:51:15.668874 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m07:51:15.674875 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m07:51:15.677875 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m07:51:15.682874 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m07:51:15.685874 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m07:51:15.687877 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m07:51:15.690874 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m07:51:15.693875 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m07:51:15.698845 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m07:51:15.700876 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m07:51:15.701872 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m07:51:15.702875 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m07:51:15.707875 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m07:51:15.709876 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m07:51:15.710847 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m07:51:15.714874 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m07:51:15.715877 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m07:51:15.720846 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m07:51:15.724844 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m07:51:15.734844 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m07:51:15.741843 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m07:51:15.743844 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m07:51:15.745844 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m07:51:16.413851 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m07:51:16.422850 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m07:51:16.424851 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m07:51:16.427851 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m07:51:16.446851 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m07:51:16.447852 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m07:51:16.449852 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:51:16.450851 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:51:16.452851 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:51:16.611854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m07:51:16.617852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2FF1840>]}
[0m07:51:16.654852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2E3DF30>]}
[0m07:51:16.654852 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:51:16.655857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2FE19F0>]}
[0m07:51:16.656854 [info ] [MainThread]: 
[0m07:51:16.657852 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:51:16.658853 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:51:16.667885 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:51:16.667885 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:51:16.667885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:16.712319 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.04 seconds
[0m07:51:16.713348 [debug] [ThreadPool]: On list_postgres: Close
[0m07:51:16.714318 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:51:16.720316 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:51:16.720316 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:51:16.720316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:16.750007 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m07:51:16.751008 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:51:16.751008 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:51:16.754051 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:51:16.755052 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:51:16.755916 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:51:16.755916 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_data"
[0m07:51:16.757953 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_data"
[0m07:51:16.757953 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: BEGIN
[0m07:51:16.758922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:16.771924 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:51:16.771924 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_data"
[0m07:51:16.771924 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_data"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_data'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_data'
  
[0m07:51:16.774921 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:51:16.775922 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: ROLLBACK
[0m07:51:16.776923 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: Close
[0m07:51:16.776923 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:51:16.779923 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:51:16.779923 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:51:16.779923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:16.808520 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m07:51:16.808520 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:51:16.808520 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:51:16.811520 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m07:51:16.812523 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:51:16.813520 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:51:16.817520 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.818521 [debug] [MainThread]: On master: BEGIN
[0m07:51:16.818521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:51:16.843596 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m07:51:16.844594 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.844594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:51:16.856597 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:51:16.857596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3218160>]}
[0m07:51:16.858626 [debug] [MainThread]: On master: ROLLBACK
[0m07:51:16.859595 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.859595 [debug] [MainThread]: On master: BEGIN
[0m07:51:16.862029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:51:16.862029 [debug] [MainThread]: On master: COMMIT
[0m07:51:16.862029 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.862029 [debug] [MainThread]: On master: COMMIT
[0m07:51:16.863037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:51:16.863037 [debug] [MainThread]: On master: Close
[0m07:51:16.864036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:51:16.864036 [info ] [MainThread]: 
[0m07:51:16.867037 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:51:16.867037 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m07:51:16.868037 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:51:16.868037 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:51:16.868037 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:51:16.871034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:51:16.873035 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:16.873035 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:51:16.906038 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:51:16.908068 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:51:16.908068 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m07:51:16.908068 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:51:16.939036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:51:16.940038 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:51:16.940038 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m07:51:16.941036 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                           ^

[0m07:51:16.941036 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m07:51:16.942037 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:16.942037 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m07:51:16.942037 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:51:16.943039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E32D9870>]}
[0m07:51:16.943039 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m07:51:16.944038 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:51:16.944038 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:51:16.944038 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:51:16.945038 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:16.945038 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:51:16.946036 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:51:16.948035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:51:16.950037 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:16.950037 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:51:16.966039 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:51:16.968036 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:16.968036 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:51:16.968036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:17.001310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:51:17.002310 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:17.002310 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:51:17.004310 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:51:17.009308 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:17.010309 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:51:17.011309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.013310 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:17.013310 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:51:17.014309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.029347 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:51:17.029347 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:17.030342 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:51:17.032863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:17.037835 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:51:17.037835 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:51:17.040846 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:51:17.041836 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.041836 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:51:17.042835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3054430>]}
[0m07:51:17.042835 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m07:51:17.043835 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:51:17.043835 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:51:17.044837 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:51:17.044837 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.044837 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:51:17.045837 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:51:17.047835 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:51:17.049837 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.049837 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:51:17.053836 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:51:17.055424 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.055424 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:51:17.055424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:17.095197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:51:17.096200 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.097197 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:51:17.107199 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m07:51:17.115194 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.115194 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:51:17.119212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.127248 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.127248 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:51:17.131997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.136014 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:51:17.137016 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.137016 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:51:17.142027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:17.149014 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:51:17.150015 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:51:17.156993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m07:51:17.158004 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.158973 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:51:17.158973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E30CD450>]}
[0m07:51:17.159973 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.11s]
[0m07:51:17.160971 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:51:17.162003 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:51:17.162003 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:51:17.163969 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.163969 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:51:17.163969 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:51:17.168967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:51:17.171967 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.171967 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:51:17.179004 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:51:17.180967 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.181971 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:51:17.181971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:17.219968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:51:17.220967 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.220967 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:51:17.222570 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:51:17.225569 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.225569 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m07:51:17.226540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.228571 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.229569 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m07:51:17.229569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.231538 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:51:17.231538 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.231538 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:51:17.234262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:17.236262 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:51:17.236262 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m07:51:17.238273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:51:17.239263 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.240262 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:51:17.240262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3306110>]}
[0m07:51:17.240262 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.08s]
[0m07:51:17.241263 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:51:17.241263 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:51:17.242263 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:51:17.242263 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.243263 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:51:17.243263 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:51:17.245263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.247265 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.247265 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:51:17.281296 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.283264 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.283264 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:51:17.283264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:17.313553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:51:17.313553 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.313553 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:51:17.317665 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:51:17.319665 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.320664 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:51:17.321694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.322700 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:51:17.322700 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.322700 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:51:17.324785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:17.326699 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:51:17.326699 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:51:17.327700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:51:17.328700 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.328700 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:51:17.328700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E33777F0>]}
[0m07:51:17.329700 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m07:51:17.329700 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:51:17.330700 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:51:17.330700 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:51:17.331700 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.331700 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:51:17.331700 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:51:17.335704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.342087 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.343088 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:51:17.354120 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.361096 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.362090 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:51:17.363158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:17.398278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:51:17.399276 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.399276 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:51:17.404081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:51:17.410128 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.410128 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:51:17.413094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:17.415123 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:51:17.415123 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.415123 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:51:17.418100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:17.422090 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:51:17.422090 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:51:17.424093 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:51:17.426091 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.426091 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:51:17.427092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E2FBDB70>]}
[0m07:51:17.428092 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m07:51:17.429090 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:51:17.430092 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:51:17.430092 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m07:51:17.432090 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:17.432090 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:51:17.432090 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:51:17.445090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:51:17.448095 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:17.449099 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:51:17.476089 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:17.476089 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp145117470088"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m07:51:17.476089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:18.657868 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.18 seconds
[0m07:51:18.664869 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.664869 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m07:51:18.665871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:51:18.665871 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.665871 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp145117470088'
        
      order by ordinal_position

  
[0m07:51:18.671868 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:51:18.676869 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.677869 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:51:18.679869 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:51:18.693257 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.693779 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp145117470088'
        
      order by ordinal_position

  
[0m07:51:18.696974 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:51:18.700105 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.700626 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:51:18.703149 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:51:18.711149 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:51:18.719786 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m07:51:18.721874 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.722398 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp145117470088"
    )
  
[0m07:51:18.723438 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m07:51:18.725007 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:51:18.725007 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:51:18.725529 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:51:18.727103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:18.727636 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:18.727636 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m07:51:18.728643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E33753C0>]}
[0m07:51:18.728643 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.30s]
[0m07:51:18.729644 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:51:18.729644 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:51:18.730646 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:51:18.730646 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.731645 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:51:18.731645 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:51:18.734644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.736645 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:18.737645 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:51:18.741643 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.742643 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.743643 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:51:18.743643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:18.756516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:51:18.757516 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.757516 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:51:18.760517 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:51:18.763517 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.764516 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:51:18.766065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:18.767140 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:51:18.767688 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.767688 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:51:18.769808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:51:18.772403 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:51:18.772403 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:51:18.773442 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:51:18.774485 [debug] [Thread-1 (]: finished collecting timing info
[0m07:51:18.774485 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:51:18.775004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0ed01a0-3106-4e5e-a78b-3915f0d708d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E311ACE0>]}
[0m07:51:18.775525 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:51:18.776048 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:51:18.777091 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:51:18.777091 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:18.777091 [debug] [MainThread]: On master: BEGIN
[0m07:51:18.777091 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:51:18.790099 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:51:18.791098 [debug] [MainThread]: On master: COMMIT
[0m07:51:18.791098 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:18.791098 [debug] [MainThread]: On master: COMMIT
[0m07:51:18.792101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:51:18.792101 [debug] [MainThread]: On master: Close
[0m07:51:18.793099 [info ] [MainThread]: 
[0m07:51:18.793099 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m07:51:18.793099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:18.794099 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:51:18.794099 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:51:18.794099 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:51:18.835101 [info ] [MainThread]: 
[0m07:51:18.836099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:51:18.836099 [info ] [MainThread]: 
[0m07:51:18.837099 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m07:51:18.837099 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m07:51:18.838099 [error] [MainThread]:   LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
[0m07:51:18.838099 [error] [MainThread]:                              ^
[0m07:51:18.838099 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:51:18.839098 [info ] [MainThread]: 
[0m07:51:18.839098 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m07:51:18.840100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3054310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E3054C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222E324F3A0>]}


============================== 2022-08-22 07:57:01.685279 | 7c161ac3-c314-4211-b85e-53c0e492429f ==============================
[0m07:57:01.685279 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:57:01.686278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:57:01.686278 [debug] [MainThread]: Tracking: tracking
[0m07:57:01.706279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBA95FB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBA95D4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBA95F0D0>]}
[0m07:57:01.766279 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:57:01.766279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBA955AE0>]}
[0m07:57:01.877278 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m07:57:01.878282 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m07:57:01.878282 [debug] [MainThread]: Parsing macros\adapters.sql
[0m07:57:01.901280 [debug] [MainThread]: Parsing macros\catalog.sql
[0m07:57:01.903280 [debug] [MainThread]: Parsing macros\relations.sql
[0m07:57:01.904280 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m07:57:01.906280 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:57:01.906280 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:57:01.907280 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:57:01.912279 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:57:01.913280 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:57:01.914280 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:57:01.915280 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m07:57:01.927279 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m07:57:01.935280 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m07:57:01.938280 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m07:57:01.940280 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m07:57:01.946280 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m07:57:01.950280 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m07:57:01.962280 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m07:57:01.964280 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m07:57:01.971280 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m07:57:01.975280 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m07:57:01.976281 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m07:57:01.977281 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m07:57:01.978281 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m07:57:01.978281 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m07:57:01.980281 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m07:57:01.981281 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m07:57:01.983281 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m07:57:01.986280 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m07:57:01.989280 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m07:57:01.993280 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m07:57:02.001281 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m07:57:02.002281 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m07:57:02.016281 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m07:57:02.028279 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m07:57:02.031281 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m07:57:02.035280 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m07:57:02.038279 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m07:57:02.040280 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m07:57:02.041280 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m07:57:02.046281 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m07:57:02.060279 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m07:57:02.066311 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m07:57:02.077282 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m07:57:02.086311 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m07:57:02.088312 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m07:57:02.102312 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m07:57:02.103312 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m07:57:02.107312 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m07:57:02.109285 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:57:02.110283 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m07:57:02.111283 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m07:57:02.113282 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m07:57:02.114282 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m07:57:02.120281 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:57:02.122282 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:57:02.123282 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m07:57:02.124282 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m07:57:02.125282 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m07:57:02.126282 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m07:57:02.127282 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m07:57:02.128282 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:57:02.129282 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m07:57:02.130282 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:57:02.132282 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m07:57:02.133282 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m07:57:02.134282 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m07:57:02.135282 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m07:57:02.136282 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m07:57:02.137282 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:57:02.139282 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m07:57:02.142282 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m07:57:02.146282 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m07:57:02.146282 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m07:57:02.155282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m07:57:02.158282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m07:57:02.160282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m07:57:02.163282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m07:57:02.164282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m07:57:02.166282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m07:57:02.178282 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m07:57:02.181283 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m07:57:02.185282 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m07:57:02.190282 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m07:57:02.192282 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m07:57:02.197282 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m07:57:02.202282 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m07:57:02.203282 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m07:57:02.225313 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m07:57:02.239314 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m07:57:02.249284 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m07:57:02.253283 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m07:57:02.258282 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m07:57:02.262282 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m07:57:02.268282 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m07:57:02.271282 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m07:57:02.275283 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m07:57:02.280283 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m07:57:02.284282 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m07:57:02.291282 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m07:57:02.293283 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m07:57:02.302282 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m07:57:02.304283 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m07:57:02.305283 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m07:57:02.308283 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m07:57:02.327283 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m07:57:02.329283 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m07:57:02.333282 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m07:57:02.366282 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m07:57:02.378282 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m07:57:02.388283 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m07:57:02.398283 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m07:57:02.412282 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m07:57:02.429283 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m07:57:02.437284 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m07:57:02.438284 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m07:57:02.439284 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m07:57:02.473283 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m07:57:02.487283 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m07:57:02.498284 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m07:57:02.511284 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m07:57:02.524285 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m07:57:02.547285 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m07:57:02.557285 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m07:57:02.563285 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m07:57:02.570284 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m07:57:02.605286 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m07:57:02.619287 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m07:57:02.630288 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m07:57:02.642288 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m07:57:02.656288 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m07:57:02.657288 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m07:57:02.665288 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m07:57:02.666288 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m07:57:02.667288 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m07:57:02.668288 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m07:57:02.670288 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m07:57:02.671288 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m07:57:02.674288 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m07:57:02.675289 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m07:57:02.678288 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m07:57:02.679288 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m07:57:02.680288 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m07:57:02.683288 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m07:57:02.688288 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m07:57:02.691288 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m07:57:02.699288 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m07:57:02.700289 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m07:57:02.702288 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m07:57:02.703289 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m07:57:02.704289 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m07:57:02.706289 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m07:57:02.707289 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m07:57:02.710289 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m07:57:02.711289 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m07:57:02.718288 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m07:57:02.719288 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m07:57:02.721288 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m07:57:02.722289 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m07:57:02.724289 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m07:57:02.726289 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m07:57:02.731288 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m07:57:02.735288 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m07:57:02.737289 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m07:57:02.738289 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m07:57:02.740289 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m07:57:02.741289 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m07:57:02.743289 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m07:57:02.746289 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m07:57:02.747289 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m07:57:02.749289 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m07:57:02.751289 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m07:57:02.758288 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m07:57:02.760289 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m07:57:02.761289 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m07:57:02.763289 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m07:57:02.765289 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m07:57:02.766289 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m07:57:02.769289 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m07:57:02.770289 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m07:57:02.772289 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m07:57:02.774289 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m07:57:02.775289 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m07:57:02.776289 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m07:57:02.777290 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m07:57:02.778289 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m07:57:02.799289 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m07:57:02.803289 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m07:57:02.809289 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m07:57:02.812289 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m07:57:02.817291 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m07:57:02.820289 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m07:57:02.822289 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m07:57:02.825289 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m07:57:02.828289 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m07:57:02.833289 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m07:57:02.835290 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m07:57:02.836290 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m07:57:02.837290 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m07:57:02.842289 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m07:57:02.844290 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m07:57:02.845290 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m07:57:02.849289 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m07:57:02.850290 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m07:57:02.854290 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m07:57:02.857289 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m07:57:02.866289 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m07:57:02.873289 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m07:57:02.875290 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m07:57:02.876290 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m07:57:03.551222 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m07:57:03.561145 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m07:57:03.563145 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m07:57:03.565145 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m07:57:03.584151 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m07:57:03.586145 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m07:57:03.587146 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:57:03.589132 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:57:03.591145 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:57:03.760554 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m07:57:03.766551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAB0F8B0>]}
[0m07:57:03.805715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBA95F430>]}
[0m07:57:03.805715 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:57:03.806716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAAFD9C0>]}
[0m07:57:03.808716 [info ] [MainThread]: 
[0m07:57:03.808716 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:57:03.810716 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:57:03.818715 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:57:03.819716 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:57:03.819716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:03.842715 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
[0m07:57:03.843716 [debug] [ThreadPool]: On list_postgres: Close
[0m07:57:03.845716 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:57:03.850714 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:57:03.851714 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:57:03.851714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:03.864715 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:57:03.864715 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:57:03.865716 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:57:03.869716 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m07:57:03.870716 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:57:03.871714 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:57:03.871714 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:57:03.874716 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:57:03.874716 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:57:03.874716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:03.912951 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m07:57:03.912951 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:57:03.912951 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:57:03.917167 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:57:03.918203 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:57:03.919174 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:57:03.919174 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_data"
[0m07:57:03.922172 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_data"
[0m07:57:03.922172 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: BEGIN
[0m07:57:03.922172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:57:03.934717 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:57:03.935723 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_data"
[0m07:57:03.935723 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_data"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_data'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_data'
  
[0m07:57:03.937722 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:57:03.938723 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: ROLLBACK
[0m07:57:03.939722 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: Close
[0m07:57:03.943723 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:03.944723 [debug] [MainThread]: On master: BEGIN
[0m07:57:03.944723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:57:03.956990 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:57:03.956990 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:03.956990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:57:03.969981 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:57:03.970951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBABF3BE0>]}
[0m07:57:03.971951 [debug] [MainThread]: On master: ROLLBACK
[0m07:57:03.973364 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:03.973364 [debug] [MainThread]: On master: BEGIN
[0m07:57:03.975368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:57:03.975368 [debug] [MainThread]: On master: COMMIT
[0m07:57:03.975368 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:03.975368 [debug] [MainThread]: On master: COMMIT
[0m07:57:03.976368 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:57:03.976923 [debug] [MainThread]: On master: Close
[0m07:57:03.976923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:57:03.976923 [info ] [MainThread]: 
[0m07:57:03.981928 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:57:03.981928 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m07:57:03.982928 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:57:03.982928 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:57:03.982928 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:57:03.985928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:57:03.988928 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:03.988928 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:57:04.023931 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:57:04.026930 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:57:04.026930 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m07:57:04.026930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:57:04.051928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:57:04.052929 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:57:04.052929 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m07:57:04.053929 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                           ^

[0m07:57:04.053929 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m07:57:04.054929 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.054929 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m07:57:04.055929 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:57:04.055929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBADC79A0>]}
[0m07:57:04.055929 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.07s]
[0m07:57:04.056929 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:57:04.056929 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:57:04.057929 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:57:04.057929 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.058929 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:57:04.058929 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:57:04.060929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:57:04.062929 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.062929 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:57:04.080928 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:57:04.082929 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.083929 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:57:04.083929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:04.096364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:57:04.096364 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.097364 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:57:04.099364 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:57:04.105362 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.105362 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:57:04.106536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.109542 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.109542 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:57:04.110384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.127374 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:57:04.128374 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.128374 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:57:04.130331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:04.134374 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:57:04.135381 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:57:04.138814 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:57:04.139821 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.139821 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:57:04.139821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBABA3B20>]}
[0m07:57:04.140820 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.08s]
[0m07:57:04.140820 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:57:04.141822 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:57:04.141822 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:57:04.142821 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.142821 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:57:04.142821 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:57:04.145820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:57:04.147823 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.147823 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:57:04.151820 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:57:04.153821 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.153821 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:57:04.153821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:04.167114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:57:04.168116 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.168116 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:57:04.170113 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:57:04.173113 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.173113 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:57:04.174112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.176111 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.177112 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:57:04.177112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.179113 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:57:04.179113 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.179113 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:57:04.180949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:04.182920 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:57:04.182920 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:57:04.185971 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:57:04.186920 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.186920 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:57:04.187921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBABF26E0>]}
[0m07:57:04.187921 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.05s]
[0m07:57:04.188919 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:57:04.188919 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:57:04.188919 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:57:04.189919 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.189919 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:57:04.189919 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:57:04.192916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:57:04.194917 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.194917 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:57:04.197917 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:57:04.199920 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.199920 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:57:04.200918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:04.214025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:57:04.214025 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.214025 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:57:04.216023 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:57:04.219022 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.219022 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m07:57:04.220024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.223023 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.223023 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m07:57:04.224024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.226022 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:57:04.226022 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.226022 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:57:04.228063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:04.230076 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:57:04.231074 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m07:57:04.233086 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:57:04.234076 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.234076 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:57:04.235075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAE1D420>]}
[0m07:57:04.235075 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.05s]
[0m07:57:04.236076 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:57:04.236076 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:57:04.236076 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:57:04.237077 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.237077 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:57:04.237077 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:57:04.240076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.241076 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.242076 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:57:04.274076 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.277080 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.277080 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:57:04.277080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:04.301277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m07:57:04.302276 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.302276 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:57:04.304276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:57:04.307274 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.307274 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:57:04.308276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.309276 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:57:04.309276 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.309276 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:57:04.311288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:04.313274 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:57:04.313274 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:57:04.314274 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:57:04.315276 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.315276 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:57:04.315276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAE918D0>]}
[0m07:57:04.316277 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m07:57:04.319292 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:57:04.320288 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:57:04.321294 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:57:04.323324 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.324327 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:57:04.325320 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:57:04.333320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.339294 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.340296 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:57:04.349283 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.353280 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.354287 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:57:04.354287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:04.389578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:57:04.390578 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.390578 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:57:04.395736 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:57:04.402772 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.402772 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:57:04.404738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:04.406737 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:57:04.406737 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.407734 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:57:04.409721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:04.411717 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:57:04.411717 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:57:04.412719 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:57:04.413718 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.413718 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:57:04.413718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAA48220>]}
[0m07:57:04.414719 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m07:57:04.415722 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:57:04.415722 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:57:04.416719 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m07:57:04.416719 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:04.416719 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:57:04.417719 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:57:04.423718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:57:04.426718 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:04.426718 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:57:04.451749 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:04.451749 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp145704445750"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m07:57:04.451749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:05.861881 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.41 seconds
[0m07:57:05.868883 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.868883 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m07:57:05.870887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:57:05.870887 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.870887 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp145704445750'
        
      order by ordinal_position

  
[0m07:57:05.876882 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m07:57:05.881910 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.881910 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:57:05.886213 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:57:05.899219 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.899219 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp145704445750'
        
      order by ordinal_position

  
[0m07:57:05.903222 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:57:05.906222 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.907222 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:57:05.910219 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:57:05.919220 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:57:05.926219 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m07:57:05.928221 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.928221 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp145704445750"
    )
  
[0m07:57:05.929350 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m07:57:05.931355 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:57:05.931355 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:57:05.931355 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:57:05.933439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:05.933439 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:05.933439 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m07:57:05.934440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAE91330>]}
[0m07:57:05.934440 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.52s]
[0m07:57:05.935440 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:57:05.935440 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:57:05.936439 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:57:05.936439 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.936439 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:57:05.937440 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:57:05.940440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.942449 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:05.942449 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:57:05.946441 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.948439 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.949440 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:57:05.949440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:57:05.962441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m07:57:05.963441 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.963441 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:57:05.966441 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:57:05.969471 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.970478 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:57:05.971442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:57:05.972442 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:57:05.972442 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.972442 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:57:05.974440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:57:05.976438 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:57:05.976438 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:57:05.978441 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:57:05.979441 [debug] [Thread-1 (]: finished collecting timing info
[0m07:57:05.979441 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:57:05.979441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c161ac3-c314-4211-b85e-53c0e492429f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAA47010>]}
[0m07:57:05.980441 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m07:57:05.981443 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:57:05.982441 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:57:05.982441 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:05.982441 [debug] [MainThread]: On master: BEGIN
[0m07:57:05.982441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:57:05.996441 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:57:05.996441 [debug] [MainThread]: On master: COMMIT
[0m07:57:05.996441 [debug] [MainThread]: Using postgres connection "master"
[0m07:57:05.996441 [debug] [MainThread]: On master: COMMIT
[0m07:57:05.997441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:57:05.997441 [debug] [MainThread]: On master: Close
[0m07:57:05.998440 [info ] [MainThread]: 
[0m07:57:05.998440 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m07:57:05.999440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:05.999440 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:57:05.999440 [debug] [MainThread]: Connection 'list_postgres_dbo_seed_data' was properly closed.
[0m07:57:05.999440 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:57:06.038440 [info ] [MainThread]: 
[0m07:57:06.038440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:57:06.039441 [info ] [MainThread]: 
[0m07:57:06.039441 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m07:57:06.040442 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m07:57:06.040442 [error] [MainThread]:   LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
[0m07:57:06.040442 [error] [MainThread]:                              ^
[0m07:57:06.041440 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:57:06.042442 [info ] [MainThread]: 
[0m07:57:06.042442 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m07:57:06.042442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAD84A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBABF06D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFBAD679D0>]}


============================== 2022-08-22 07:59:17.977200 | b919123a-0147-429e-a1c8-b274b3894253 ==============================
[0m07:59:17.977200 [info ] [MainThread]: Running with dbt=1.2.0
[0m07:59:17.977200 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:59:17.978201 [debug] [MainThread]: Tracking: tracking
[0m07:59:17.994200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9C6E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9C6D480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9C6FA60>]}
[0m07:59:18.050236 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:59:18.051201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9C65DB0>]}
[0m07:59:18.142201 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m07:59:18.143202 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m07:59:18.144202 [debug] [MainThread]: Parsing macros\adapters.sql
[0m07:59:18.167201 [debug] [MainThread]: Parsing macros\catalog.sql
[0m07:59:18.169202 [debug] [MainThread]: Parsing macros\relations.sql
[0m07:59:18.170202 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m07:59:18.171202 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:59:18.172201 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:59:18.173202 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:59:18.178201 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:59:18.179202 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:59:18.180202 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:59:18.181202 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m07:59:18.193201 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m07:59:18.201201 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m07:59:18.204202 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m07:59:18.206202 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m07:59:18.213202 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m07:59:18.217202 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m07:59:18.229202 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m07:59:18.231202 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m07:59:18.238202 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m07:59:18.242202 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m07:59:18.243202 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m07:59:18.244203 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m07:59:18.245202 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m07:59:18.245202 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m07:59:18.247202 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m07:59:18.248202 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m07:59:18.250202 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m07:59:18.253202 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m07:59:18.256203 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m07:59:18.260202 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m07:59:18.268202 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m07:59:18.269203 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m07:59:18.283203 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m07:59:18.296202 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m07:59:18.298203 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m07:59:18.303202 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m07:59:18.306202 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m07:59:18.308203 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m07:59:18.309203 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m07:59:18.314202 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m07:59:18.329202 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m07:59:18.335202 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m07:59:18.346203 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m07:59:18.356202 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m07:59:18.357203 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m07:59:18.372203 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m07:59:18.373204 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m07:59:18.377203 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m07:59:18.379203 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:59:18.380204 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m07:59:18.381204 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m07:59:18.382204 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m07:59:18.383204 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m07:59:18.388203 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:59:18.389204 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:59:18.391204 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m07:59:18.392204 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m07:59:18.393204 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m07:59:18.393204 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m07:59:18.394203 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m07:59:18.395204 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:59:18.397204 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m07:59:18.398204 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:59:18.400203 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m07:59:18.401204 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m07:59:18.402204 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m07:59:18.403204 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m07:59:18.404204 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m07:59:18.405204 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:59:18.407204 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m07:59:18.410204 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m07:59:18.414204 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m07:59:18.415204 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m07:59:18.423203 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m07:59:18.426204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m07:59:18.428204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m07:59:18.431204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m07:59:18.432204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m07:59:18.434204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m07:59:18.446204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m07:59:18.448204 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m07:59:18.453203 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m07:59:18.458204 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m07:59:18.460203 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m07:59:18.465203 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m07:59:18.470203 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m07:59:18.471204 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m07:59:18.494204 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m07:59:18.509203 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m07:59:18.518203 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m07:59:18.523204 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m07:59:18.528204 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m07:59:18.532205 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m07:59:18.538204 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m07:59:18.541204 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m07:59:18.545204 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m07:59:18.550204 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m07:59:18.554204 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m07:59:18.562204 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m07:59:18.563205 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m07:59:18.572204 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m07:59:18.574205 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m07:59:18.576205 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m07:59:18.578205 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m07:59:18.598205 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m07:59:18.599205 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m07:59:18.604204 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m07:59:18.638204 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m07:59:18.651204 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m07:59:18.660205 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m07:59:18.670205 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m07:59:18.684809 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m07:59:18.704345 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m07:59:18.712350 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m07:59:18.714351 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m07:59:18.714351 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m07:59:18.751277 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m07:59:18.766430 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m07:59:18.778076 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m07:59:18.792088 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m07:59:18.805088 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m07:59:18.827308 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m07:59:18.836308 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m07:59:18.842311 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m07:59:18.849280 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m07:59:18.883277 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m07:59:18.896276 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m07:59:18.907276 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m07:59:18.918276 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m07:59:18.933276 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m07:59:18.934278 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m07:59:18.942277 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m07:59:18.943278 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m07:59:18.943278 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m07:59:18.945277 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m07:59:18.946278 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m07:59:18.948278 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m07:59:18.951277 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m07:59:18.952278 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m07:59:18.954277 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m07:59:18.956278 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m07:59:18.957278 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m07:59:18.960277 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m07:59:18.965277 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m07:59:18.968277 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m07:59:18.976277 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m07:59:18.977278 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m07:59:18.979278 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m07:59:18.980278 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m07:59:18.981278 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m07:59:18.983277 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m07:59:18.984278 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m07:59:18.987277 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m07:59:18.988278 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m07:59:18.996277 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m07:59:18.996277 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m07:59:18.998278 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m07:59:18.999278 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m07:59:19.001278 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m07:59:19.003278 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m07:59:19.008277 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m07:59:19.012278 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m07:59:19.014278 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m07:59:19.015278 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m07:59:19.018278 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m07:59:19.019278 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m07:59:19.020278 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m07:59:19.024277 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m07:59:19.025278 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m07:59:19.027278 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m07:59:19.028278 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m07:59:19.036277 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m07:59:19.038278 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m07:59:19.039278 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m07:59:19.041278 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m07:59:19.043309 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m07:59:19.045308 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m07:59:19.047308 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m07:59:19.049311 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m07:59:19.050313 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m07:59:19.053308 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m07:59:19.054308 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m07:59:19.055308 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m07:59:19.056309 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m07:59:19.057307 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m07:59:19.077308 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m07:59:19.081310 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m07:59:19.087314 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m07:59:19.090308 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m07:59:19.095311 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m07:59:19.098309 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m07:59:19.100309 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m07:59:19.103314 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m07:59:19.106310 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m07:59:19.111310 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m07:59:19.113310 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m07:59:19.114311 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m07:59:19.116310 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m07:59:19.121279 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m07:59:19.123279 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m07:59:19.124278 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m07:59:19.127310 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m07:59:19.129312 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m07:59:19.132310 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m07:59:19.135310 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m07:59:19.145309 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m07:59:19.151310 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m07:59:19.153311 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m07:59:19.154310 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m07:59:19.819283 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m07:59:19.829661 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m07:59:19.831892 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m07:59:19.833515 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m07:59:19.854428 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m07:59:19.855428 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m07:59:19.857427 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m07:59:19.859427 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m07:59:19.861426 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m07:59:20.021975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.dim
- models.dbt_postgres.src
- seeds.seed_full_moon_dates

[0m07:59:20.027976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9E21540>]}
[0m07:59:20.064977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9C6FD00>]}
[0m07:59:20.064977 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m07:59:20.065977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9DFD9F0>]}
[0m07:59:20.066977 [info ] [MainThread]: 
[0m07:59:20.067976 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:59:20.068977 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m07:59:20.077976 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m07:59:20.077976 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m07:59:20.077976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:20.104976 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
[0m07:59:20.105977 [debug] [ThreadPool]: On list_postgres: Close
[0m07:59:20.106977 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m07:59:20.113978 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:59:20.113978 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m07:59:20.113978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:20.148977 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m07:59:20.148977 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m07:59:20.149978 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m07:59:20.152978 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:20.153979 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m07:59:20.154979 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m07:59:20.154979 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_data"
[0m07:59:20.156980 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_data"
[0m07:59:20.156980 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: BEGIN
[0m07:59:20.157980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:20.170086 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:59:20.170086 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_data"
[0m07:59:20.170086 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_data"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_data'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_data'
  
[0m07:59:20.173086 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:20.174085 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: ROLLBACK
[0m07:59:20.174085 [debug] [ThreadPool]: On list_postgres_dbo_seed_data: Close
[0m07:59:20.175085 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m07:59:20.178086 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:59:20.178086 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m07:59:20.178086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:20.190747 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m07:59:20.190747 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m07:59:20.190747 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m07:59:20.193752 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m07:59:20.194753 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m07:59:20.195753 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m07:59:20.199753 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:20.200753 [debug] [MainThread]: On master: BEGIN
[0m07:59:20.200753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:20.213754 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:59:20.213754 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:20.213754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:59:20.226287 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m07:59:20.227324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EA044160>]}
[0m07:59:20.227324 [debug] [MainThread]: On master: ROLLBACK
[0m07:59:20.229293 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:20.229293 [debug] [MainThread]: On master: BEGIN
[0m07:59:20.230897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:20.230897 [debug] [MainThread]: On master: COMMIT
[0m07:59:20.230897 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:20.230897 [debug] [MainThread]: On master: COMMIT
[0m07:59:20.231900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:20.231900 [debug] [MainThread]: On master: Close
[0m07:59:20.232898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:59:20.232898 [info ] [MainThread]: 
[0m07:59:20.236899 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:59:20.236899 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m07:59:20.237897 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:59:20.237897 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m07:59:20.237897 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m07:59:20.240898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:59:20.242896 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.242896 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m07:59:20.275928 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:59:20.277898 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:59:20.277898 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m07:59:20.277898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:59:20.306611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:59:20.307610 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m07:59:20.307610 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m07:59:20.308611 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                           ^

[0m07:59:20.308611 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m07:59:20.309611 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.309611 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m07:59:20.309611 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:59:20.310610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EA109870>]}
[0m07:59:20.310610 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.07s]
[0m07:59:20.311611 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m07:59:20.311611 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m07:59:20.311611 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m07:59:20.312611 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.312611 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m07:59:20.312611 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m07:59:20.315610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m07:59:20.316611 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.317610 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m07:59:20.334642 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m07:59:20.336611 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.336611 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m07:59:20.336611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:20.369624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:59:20.370624 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.370624 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m07:59:20.373346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:59:20.379348 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.379348 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m07:59:20.380348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.382345 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.383345 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m07:59:20.383763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.399801 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:59:20.399801 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.399801 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m07:59:20.402814 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:20.407813 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m07:59:20.407813 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m07:59:20.411105 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:59:20.412132 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.412132 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m07:59:20.413128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9E808E0>]}
[0m07:59:20.413128 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m07:59:20.414131 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m07:59:20.414131 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m07:59:20.415104 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m07:59:20.415104 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.416100 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m07:59:20.416100 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m07:59:20.418100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m07:59:20.420101 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.421101 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m07:59:20.424099 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m07:59:20.426099 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.426099 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m07:59:20.426099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:20.462569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:59:20.463569 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.463569 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m07:59:20.466569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:59:20.468568 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.469569 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m07:59:20.470021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.473029 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.473029 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m07:59:20.473729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.474736 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:59:20.475734 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.475734 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m07:59:20.477743 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:20.479734 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m07:59:20.479734 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m07:59:20.482735 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:59:20.483735 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.483735 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m07:59:20.484734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9F00280>]}
[0m07:59:20.484734 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m07:59:20.485735 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m07:59:20.485735 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m07:59:20.486737 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m07:59:20.486737 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.487735 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m07:59:20.487735 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m07:59:20.490735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m07:59:20.492252 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.492252 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m07:59:20.496288 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m07:59:20.498225 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.498225 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m07:59:20.498225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:20.525025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:59:20.525025 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.525025 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m07:59:20.528075 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:59:20.531075 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.531075 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m07:59:20.532045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.534074 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.534074 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m07:59:20.535934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.536971 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:59:20.536971 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.536971 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m07:59:20.538940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:20.540940 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m07:59:20.540940 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m07:59:20.543939 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:59:20.544940 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.544940 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m07:59:20.544940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EA136A10>]}
[0m07:59:20.545940 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.06s]
[0m07:59:20.546940 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m07:59:20.546940 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m07:59:20.546940 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m07:59:20.547940 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.547940 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m07:59:20.547940 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m07:59:20.550940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.552939 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.552939 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m07:59:20.585971 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.587971 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.588941 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m07:59:20.588941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:20.620074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:59:20.620074 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.621073 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m07:59:20.623072 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:59:20.625073 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.626071 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m07:59:20.627074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.628071 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:59:20.628071 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.628071 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m07:59:20.631072 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:20.633071 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m07:59:20.633071 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m07:59:20.634236 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:59:20.634236 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.635282 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m07:59:20.635282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EA1A7190>]}
[0m07:59:20.635282 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.09s]
[0m07:59:20.636273 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m07:59:20.637244 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m07:59:20.637244 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m07:59:20.638243 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.638243 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m07:59:20.638243 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m07:59:20.641240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.642561 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.642561 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m07:59:20.646602 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.647603 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.648620 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m07:59:20.648620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:20.681375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m07:59:20.681375 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.681375 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m07:59:20.684373 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:59:20.688375 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.689374 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m07:59:20.690375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:20.691374 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:59:20.691374 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.691374 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m07:59:20.693373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:20.695373 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m07:59:20.696373 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m07:59:20.697373 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:59:20.697373 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.698374 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m07:59:20.698374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9D5BFA0>]}
[0m07:59:20.698374 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.06s]
[0m07:59:20.699374 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m07:59:20.700374 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m07:59:20.700374 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m07:59:20.701521 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:20.701521 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m07:59:20.701521 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m07:59:20.708559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m07:59:20.710559 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:20.710559 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m07:59:20.735558 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:20.736558 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp145920729558"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m07:59:20.736558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:21.911370 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.17 seconds
[0m07:59:21.917402 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.918393 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m07:59:21.919371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:59:21.919371 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.919371 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp145920729558'
        
      order by ordinal_position

  
[0m07:59:21.925371 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m07:59:21.930400 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.931401 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:59:21.934401 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:59:21.946400 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.946400 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp145920729558'
        
      order by ordinal_position

  
[0m07:59:21.949372 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:59:21.952401 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.952401 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m07:59:21.955372 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m07:59:21.963400 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m07:59:21.970403 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m07:59:21.973375 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.973375 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp145920729558"
    )
  
[0m07:59:21.975177 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m07:59:21.976205 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:59:21.976205 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m07:59:21.976205 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m07:59:21.979371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:21.979371 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:21.980353 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m07:59:21.980353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9FB9330>]}
[0m07:59:21.980353 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.28s]
[0m07:59:21.982353 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m07:59:21.982353 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m07:59:21.982353 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m07:59:21.983354 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:21.983354 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m07:59:21.983354 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m07:59:21.986353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:21.988353 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:21.989370 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m07:59:21.993354 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:21.995354 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:21.995354 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m07:59:21.995354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:22.031783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m07:59:22.031783 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:22.032789 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m07:59:22.035302 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:59:22.038306 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:22.039308 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m07:59:22.040308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:59:22.041307 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:59:22.041307 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:22.041307 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m07:59:22.043307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:59:22.045307 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m07:59:22.045307 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m07:59:22.046307 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m07:59:22.047307 [debug] [Thread-1 (]: finished collecting timing info
[0m07:59:22.047307 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m07:59:22.048310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b919123a-0147-429e-a1c8-b274b3894253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9F48280>]}
[0m07:59:22.048310 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m07:59:22.049308 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m07:59:22.050308 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m07:59:22.050308 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.051308 [debug] [MainThread]: On master: BEGIN
[0m07:59:22.051308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:22.063828 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m07:59:22.063828 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.063828 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.063828 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.064827 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:22.064827 [debug] [MainThread]: On master: Close
[0m07:59:22.065827 [info ] [MainThread]: 
[0m07:59:22.066828 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m07:59:22.066828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:22.066828 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m07:59:22.066828 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m07:59:22.067827 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m07:59:22.105859 [info ] [MainThread]: 
[0m07:59:22.106489 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:59:22.107099 [info ] [MainThread]: 
[0m07:59:22.108106 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m07:59:22.108106 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m07:59:22.109104 [error] [MainThread]:   LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
[0m07:59:22.109104 [error] [MainThread]:                              ^
[0m07:59:22.110104 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m07:59:22.110104 [info ] [MainThread]: 
[0m07:59:22.110104 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m07:59:22.111104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EA1A52A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E9E80610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EA093580>]}


============================== 2022-08-22 08:01:16.386563 | 00834807-b1cc-46b0-89ab-1071e3bf1f4d ==============================
[0m08:01:16.386563 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:01:16.386563 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:01:16.387563 [debug] [MainThread]: Tracking: tracking
[0m08:01:16.400562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F03CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F03D570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F03F040>]}
[0m08:01:16.456593 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:01:16.457564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F0378B0>]}
[0m08:01:16.543594 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
[0m08:01:16.544568 [debug] [MainThread]: Parsing macros\positive_value.sql
[0m08:01:16.545564 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:01:16.566596 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:01:16.568596 [debug] [MainThread]: Parsing macros\relations.sql
[0m08:01:16.569583 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m08:01:16.571594 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:01:16.571594 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:01:16.572595 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:01:16.577594 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:01:16.578564 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:01:16.580565 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:01:16.581595 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:01:16.592594 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:01:16.600594 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:01:16.602596 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:01:16.604594 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:01:16.610594 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:01:16.614595 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:01:16.626594 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:01:16.628595 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:01:16.635594 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:01:16.638595 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:01:16.640596 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:01:16.640596 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:01:16.641593 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:01:16.642565 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:01:16.643595 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:01:16.645594 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:01:16.647594 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:01:16.649594 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:01:16.652595 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:01:16.656595 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:01:16.664594 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:01:16.665598 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:01:16.678595 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:01:16.691595 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:01:16.693595 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:01:16.698595 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:01:16.700595 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:01:16.702596 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:01:16.704595 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:01:16.709595 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:01:16.723597 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:01:16.729596 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:01:16.739599 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:01:16.749595 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:01:16.750596 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:01:16.764595 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:01:16.766595 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:01:16.769595 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:01:16.771595 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:01:16.772595 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:01:16.773595 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:01:16.774597 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:01:16.775598 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:01:16.780601 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:01:16.781596 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:01:16.782596 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:01:16.783595 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:01:16.784595 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:01:16.784595 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:01:16.785595 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:01:16.786596 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:01:16.788596 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:01:16.789595 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:01:16.791595 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:01:16.792595 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:01:16.793595 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:01:16.794598 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:01:16.795596 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:01:16.796595 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:01:16.798595 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:01:16.800595 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m08:01:16.804595 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m08:01:16.805566 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m08:01:16.813595 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m08:01:16.816596 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m08:01:16.818598 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m08:01:16.820598 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m08:01:16.822565 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m08:01:16.824564 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m08:01:16.834595 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m08:01:16.837596 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m08:01:16.841596 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m08:01:16.846596 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m08:01:16.848597 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m08:01:16.853564 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m08:01:16.859565 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m08:01:16.860565 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m08:01:16.881564 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m08:01:16.895564 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m08:01:16.905565 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m08:01:16.909565 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m08:01:16.914565 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m08:01:16.918595 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m08:01:16.924596 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m08:01:16.927596 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m08:01:16.930566 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m08:01:16.935596 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m08:01:16.939595 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m08:01:16.946596 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m08:01:16.947566 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m08:01:16.956596 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m08:01:16.958596 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m08:01:16.959566 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m08:01:16.962597 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m08:01:16.980599 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m08:01:16.982596 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m08:01:16.987572 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m08:01:17.020596 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m08:01:17.032600 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m08:01:17.042598 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m08:01:17.052598 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m08:01:17.066601 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m08:01:17.084565 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m08:01:17.092565 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m08:01:17.093567 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m08:01:17.094566 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m08:01:17.128599 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m08:01:17.142599 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m08:01:17.152597 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m08:01:17.164597 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m08:01:17.176598 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m08:01:17.197599 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m08:01:17.206599 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m08:01:17.212598 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m08:01:17.219597 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m08:01:17.252597 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m08:01:17.265596 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m08:01:17.276602 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m08:01:17.286600 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m08:01:17.300598 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m08:01:17.301573 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m08:01:17.309598 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m08:01:17.310600 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m08:01:17.311600 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m08:01:17.312599 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
[0m08:01:17.314598 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
[0m08:01:17.315601 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
[0m08:01:17.318598 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m08:01:17.319606 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
[0m08:01:17.321598 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m08:01:17.323604 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m08:01:17.324599 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m08:01:17.327598 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m08:01:17.332599 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m08:01:17.334570 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m08:01:17.342598 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m08:01:17.343598 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m08:01:17.345599 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m08:01:17.346598 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m08:01:17.347598 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m08:01:17.349598 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m08:01:17.350600 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m08:01:17.353599 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m08:01:17.354569 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
[0m08:01:17.361598 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m08:01:17.362598 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m08:01:17.363601 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m08:01:17.364568 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m08:01:17.366600 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m08:01:17.368589 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m08:01:17.373600 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m08:01:17.377596 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m08:01:17.379604 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m08:01:17.380599 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m08:01:17.382598 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m08:01:17.383599 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m08:01:17.385599 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m08:01:17.388599 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m08:01:17.389598 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m08:01:17.391598 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m08:01:17.392603 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m08:01:17.400596 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m08:01:17.401599 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m08:01:17.403602 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m08:01:17.404569 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m08:01:17.406599 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m08:01:17.408599 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m08:01:17.410599 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
[0m08:01:17.412600 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
[0m08:01:17.413599 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m08:01:17.415598 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:01:17.416568 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:01:17.417600 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:01:17.419598 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:01:17.420600 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m08:01:17.439599 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:01:17.443601 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m08:01:17.449599 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:01:17.452599 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:01:17.457596 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m08:01:17.459599 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:01:17.461599 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:01:17.464596 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:01:17.467598 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:01:17.472599 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:01:17.473599 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:01:17.475603 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:01:17.476599 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:01:17.481600 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:01:17.482599 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:01:17.484600 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:01:17.487599 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:01:17.489606 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:01:17.492599 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:01:17.495600 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:01:17.504602 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:01:17.511599 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:01:17.513600 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:01:17.514602 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:01:18.163571 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
[0m08:01:18.173573 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
[0m08:01:18.175572 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
[0m08:01:18.177603 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
[0m08:01:18.196603 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
[0m08:01:18.197602 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m08:01:18.198602 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
[0m08:01:18.200602 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
[0m08:01:18.202605 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
[0m08:01:18.357574 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m08:01:18.363573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F1F31C0>]}
[0m08:01:18.399605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F03DF30>]}
[0m08:01:18.399605 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:01:18.400574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F1CD9F0>]}
[0m08:01:18.401574 [info ] [MainThread]: 
[0m08:01:18.402573 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:01:18.403573 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:01:18.412575 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:01:18.412575 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:01:18.412575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:18.437573 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
[0m08:01:18.438574 [debug] [ThreadPool]: On list_postgres: Close
[0m08:01:18.440575 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:01:18.445572 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:01:18.446574 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: BEGIN
[0m08:01:18.446574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:18.481209 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m08:01:18.481209 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:01:18.481209 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_full_moon_dates"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_full_moon_dates'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_full_moon_dates'
  
[0m08:01:18.483213 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:01:18.484209 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: ROLLBACK
[0m08:01:18.485209 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: Close
[0m08:01:18.486210 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m08:01:18.488210 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:01:18.488210 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m08:01:18.488210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:18.501091 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:01:18.501091 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:01:18.501091 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m08:01:18.504089 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m08:01:18.505092 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m08:01:18.506090 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m08:01:18.506090 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m08:01:18.512102 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:01:18.513105 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m08:01:18.514106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:18.570185 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m08:01:18.570185 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:01:18.570185 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m08:01:18.574187 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:01:18.575185 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m08:01:18.577184 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m08:01:18.583645 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:18.583645 [debug] [MainThread]: On master: BEGIN
[0m08:01:18.584646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:01:18.613529 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m08:01:18.613529 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:18.613529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:01:18.631824 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
[0m08:01:18.632803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F410070>]}
[0m08:01:18.633802 [debug] [MainThread]: On master: ROLLBACK
[0m08:01:18.634805 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:18.634805 [debug] [MainThread]: On master: BEGIN
[0m08:01:18.636606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:01:18.636606 [debug] [MainThread]: On master: COMMIT
[0m08:01:18.637612 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:18.637612 [debug] [MainThread]: On master: COMMIT
[0m08:01:18.638610 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:01:18.638610 [debug] [MainThread]: On master: Close
[0m08:01:18.638610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:01:18.639612 [info ] [MainThread]: 
[0m08:01:18.642611 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m08:01:18.642611 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m08:01:18.643612 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:01:18.643612 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m08:01:18.643612 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m08:01:18.646611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:01:18.648610 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.648610 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m08:01:18.680646 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:01:18.682642 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:01:18.683612 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m08:01:18.683612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:01:18.715853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:01:18.716380 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:01:18.716380 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m08:01:18.717420 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                           ^

[0m08:01:18.717946 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m08:01:18.718469 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.718997 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m08:01:18.718997 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m08:01:18.718997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F4A5E40>]}
[0m08:01:18.720006 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m08:01:18.721006 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m08:01:18.721006 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m08:01:18.721006 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m08:01:18.722004 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.722004 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m08:01:18.722004 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m08:01:18.725004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m08:01:18.727004 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.727004 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m08:01:18.743634 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m08:01:18.745634 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.745634 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m08:01:18.746638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:18.759911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:01:18.759911 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.760911 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m08:01:18.762910 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:18.768494 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.769500 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m08:01:18.770501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:18.772500 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.773500 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m08:01:18.774501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:18.791500 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m08:01:18.791500 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.791500 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m08:01:18.794270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:01:18.799281 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:01:18.799281 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m08:01:18.803279 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:18.804280 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.804280 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m08:01:18.805279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F2D3370>]}
[0m08:01:18.805279 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:01:18.806281 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m08:01:18.806281 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m08:01:18.807282 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m08:01:18.808280 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.808280 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m08:01:18.808280 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m08:01:18.811280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m08:01:18.812279 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.813280 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m08:01:18.816279 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m08:01:18.818280 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.818280 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m08:01:18.818280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:18.855280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m08:01:18.855280 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.855280 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m08:01:18.859454 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:18.861453 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.862452 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m08:01:18.863455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:18.865455 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.865455 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m08:01:18.866455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:18.868456 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m08:01:18.868456 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.868456 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m08:01:18.870857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:01:18.872856 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:01:18.872856 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m08:01:18.875856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:18.876859 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.876859 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m08:01:18.877856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F465540>]}
[0m08:01:18.877856 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m08:01:18.878857 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m08:01:18.878857 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m08:01:18.879857 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m08:01:18.879857 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.880857 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m08:01:18.880857 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m08:01:18.882856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m08:01:18.884856 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.884856 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m08:01:18.887856 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m08:01:18.889857 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.889857 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m08:01:18.890857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:18.917843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:01:18.918843 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.918843 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m08:01:18.920572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:18.923596 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.924571 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m08:01:18.925467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:18.927504 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.927504 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m08:01:18.928505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:18.930506 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m08:01:18.930506 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.930506 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m08:01:18.932772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:01:18.934780 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:01:18.934780 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m08:01:18.936777 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:18.937780 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.937780 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m08:01:18.938780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F504910>]}
[0m08:01:18.938780 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.06s]
[0m08:01:18.939780 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m08:01:18.939780 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m08:01:18.940776 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m08:01:18.940776 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:18.940776 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m08:01:18.941778 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m08:01:18.943776 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:18.945776 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:18.945776 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m08:01:18.977810 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:18.979808 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:18.979808 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m08:01:18.980781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:19.011449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:01:19.011449 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:19.012448 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m08:01:19.014450 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:19.017448 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:19.017448 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m08:01:19.019473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:19.024457 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m08:01:19.025459 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:19.026461 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m08:01:19.034464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m08:01:19.042463 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:01:19.043505 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m08:01:19.047461 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:19.051505 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:19.052506 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m08:01:19.054505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F577E50>]}
[0m08:01:19.055469 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m08:01:19.059506 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m08:01:19.060505 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m08:01:19.062505 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m08:01:19.064462 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.065505 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m08:01:19.066505 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m08:01:19.076516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.080486 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:19.081456 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m08:01:19.088483 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.091450 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.092450 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m08:01:19.092450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:19.114448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m08:01:19.114448 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.114448 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m08:01:19.117448 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:19.120448 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.120448 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m08:01:19.122449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:19.123449 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m08:01:19.123449 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.123449 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m08:01:19.126449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:01:19.128448 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:01:19.128448 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m08:01:19.129449 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:19.130448 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:19.130448 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m08:01:19.130448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F1BED10>]}
[0m08:01:19.131449 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m08:01:19.132449 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m08:01:19.132449 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m08:01:19.132449 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m08:01:19.133448 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:19.133448 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m08:01:19.133448 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m08:01:19.140449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m08:01:19.142448 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:19.142448 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m08:01:19.168447 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:19.168447 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp150119162448"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m08:01:19.168447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:20.335912 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.17 seconds
[0m08:01:20.342910 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.342910 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m08:01:20.343878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:01:20.344878 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.344878 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp150119162448'
        
      order by ordinal_position

  
[0m08:01:20.349879 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m08:01:20.355908 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.355908 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m08:01:20.358880 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:01:20.370878 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.371908 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp150119162448'
        
      order by ordinal_position

  
[0m08:01:20.373879 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:01:20.376877 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.377909 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m08:01:20.379880 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:01:20.387908 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:01:20.394907 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m08:01:20.396878 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.396878 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp150119162448"
    )
  
[0m08:01:20.397913 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m08:01:20.399877 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m08:01:20.399877 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:01:20.399877 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m08:01:20.402877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:01:20.402877 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:20.403877 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m08:01:20.403877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F5753C0>]}
[0m08:01:20.403877 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.27s]
[0m08:01:20.404876 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m08:01:20.404876 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m08:01:20.405877 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m08:01:20.405877 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.406877 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m08:01:20.406877 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m08:01:20.409877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.411877 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:20.411877 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m08:01:20.415876 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.416876 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.417877 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m08:01:20.417877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:20.430877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:01:20.431877 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.431877 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m08:01:20.433876 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:20.437877 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.437877 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m08:01:20.438877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:20.440877 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m08:01:20.440877 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.440877 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m08:01:20.442877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:01:20.445876 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:01:20.445876 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m08:01:20.446876 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:20.447877 [debug] [Thread-1 (]: finished collecting timing info
[0m08:01:20.447877 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m08:01:20.447877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00834807-b1cc-46b0-89ab-1071e3bf1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F283D90>]}
[0m08:01:20.448877 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.04s]
[0m08:01:20.449877 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m08:01:20.450877 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:01:20.450877 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:20.450877 [debug] [MainThread]: On master: BEGIN
[0m08:01:20.450877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:01:20.463878 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m08:01:20.464877 [debug] [MainThread]: On master: COMMIT
[0m08:01:20.464877 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:20.464877 [debug] [MainThread]: On master: COMMIT
[0m08:01:20.465878 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:01:20.465878 [debug] [MainThread]: On master: Close
[0m08:01:20.465878 [info ] [MainThread]: 
[0m08:01:20.466877 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m08:01:20.466877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:20.466877 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m08:01:20.467877 [debug] [MainThread]: Connection 'list_postgres_dev' was properly closed.
[0m08:01:20.467877 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m08:01:20.503889 [info ] [MainThread]: 
[0m08:01:20.504857 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:01:20.505856 [info ] [MainThread]: 
[0m08:01:20.506856 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m08:01:20.507856 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m08:01:20.507856 [error] [MainThread]:   LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
[0m08:01:20.507856 [error] [MainThread]:                              ^
[0m08:01:20.508855 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m08:01:20.508855 [info ] [MainThread]: 
[0m08:01:20.509855 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m08:01:20.509855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F38B6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F388C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001672F466AD0>]}


============================== 2022-08-22 08:04:42.854083 | 1a946d23-859d-465a-ac32-6bdb038a0782 ==============================
[0m08:04:42.854083 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:04:42.854083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m08:04:42.855083 [debug] [MainThread]: Tracking: tracking
[0m08:04:42.868083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7560FB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7560D4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7560F0D0>]}
[0m08:04:43.015083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:04:43.015083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:04:43.016083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres
- models.dbt_postgres.src
- models.dbt_postgres.dim

[0m08:04:43.023084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a946d23-859d-465a-ac32-6bdb038a0782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F758D80D0>]}
[0m08:04:43.059086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a946d23-859d-465a-ac32-6bdb038a0782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F758A0190>]}
[0m08:04:43.059086 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:04:43.060084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a946d23-859d-465a-ac32-6bdb038a0782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F758A0310>]}
[0m08:04:43.061084 [info ] [MainThread]: 
[0m08:04:43.062086 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:04:43.063086 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:04:43.072084 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:04:43.072084 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:04:43.072084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:43.099084 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.03 seconds
[0m08:04:43.100084 [debug] [ThreadPool]: On list_postgres: Close
[0m08:04:43.101084 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.101084 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.101084 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='dbo_seed_full_moon_dates', identifier=None)"
[0m08:04:43.106082 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.107083 [debug] [ThreadPool]: On create_postgres_dbo_seed_full_moon_dates: BEGIN
[0m08:04:43.107083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:43.122086 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m08:04:43.122086 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.122086 [debug] [ThreadPool]: On create_postgres_dbo_seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "create_postgres_dbo_seed_full_moon_dates"} */
create schema if not exists "dbo_seed_full_moon_dates"
[0m08:04:43.126084 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:04:43.127084 [debug] [ThreadPool]: On create_postgres_dbo_seed_full_moon_dates: COMMIT
[0m08:04:43.128086 [debug] [ThreadPool]: Using postgres connection "create_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.128086 [debug] [ThreadPool]: On create_postgres_dbo_seed_full_moon_dates: COMMIT
[0m08:04:43.130083 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:04:43.130083 [debug] [ThreadPool]: On create_postgres_dbo_seed_full_moon_dates: Close
[0m08:04:43.132084 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.138086 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.138086 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: BEGIN
[0m08:04:43.139087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:43.152085 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:04:43.152085 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:04:43.152085 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_full_moon_dates"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_full_moon_dates'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_full_moon_dates'
  
[0m08:04:43.155084 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:04:43.156086 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: ROLLBACK
[0m08:04:43.157087 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: Close
[0m08:04:43.158087 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m08:04:43.160084 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:04:43.160084 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m08:04:43.160084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:43.173084 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:04:43.174086 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:04:43.174086 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m08:04:43.176084 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:04:43.177084 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m08:04:43.178084 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m08:04:43.179088 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m08:04:43.181087 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:04:43.181087 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m08:04:43.181087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:43.194087 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:04:43.194087 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:04:43.195085 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m08:04:43.197085 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m08:04:43.198087 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m08:04:43.199087 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m08:04:43.205084 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:43.205084 [debug] [MainThread]: On master: BEGIN
[0m08:04:43.205084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:04:43.219088 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m08:04:43.219088 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:43.219088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:04:43.233086 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m08:04:43.234085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a946d23-859d-465a-ac32-6bdb038a0782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F75894B20>]}
[0m08:04:43.235085 [debug] [MainThread]: On master: ROLLBACK
[0m08:04:43.236088 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:43.236088 [debug] [MainThread]: On master: BEGIN
[0m08:04:43.237086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:04:43.237086 [debug] [MainThread]: On master: COMMIT
[0m08:04:43.238084 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:43.238084 [debug] [MainThread]: On master: COMMIT
[0m08:04:43.239085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:04:43.239085 [debug] [MainThread]: On master: Close
[0m08:04:43.239085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:43.240084 [info ] [MainThread]: 
[0m08:04:43.243085 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m08:04:43.243085 [info ] [Thread-1 (]: 1 of 1 START seed file dbo_seed_full_moon_dates.seed_full_moon_dates ........... [RUN]
[0m08:04:43.244084 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:04:43.244084 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m08:04:43.244084 [debug] [Thread-1 (]: finished collecting timing info
[0m08:04:43.244084 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m08:04:43.282473 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:04:43.282473 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: BEGIN
[0m08:04:43.282473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:04:43.318308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m08:04:43.318308 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:04:43.318308 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "seed.dbtpostgres.seed_full_moon_dates"} */

    create table "postgres"."dbo_seed_full_moon_dates"."seed_full_moon_dates" ("full_moon_date" date)
  
[0m08:04:43.322308 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m08:04:43.370339 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:04:43.370339 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: 
          insert into "postgres"."dbo_seed_full_moon_dates"."seed_full_moon_dates" ("full_moon_date") values
          (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%...
[0m08:04:43.376993 [debug] [Thread-1 (]: SQL status: INSERT 0 272 in 0.01 seconds
[0m08:04:43.382000 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m08:04:43.403026 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: COMMIT
[0m08:04:43.403026 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:04:43.404001 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: COMMIT
[0m08:04:43.406430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:04:43.407460 [debug] [Thread-1 (]: finished collecting timing info
[0m08:04:43.407460 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: Close
[0m08:04:43.407460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a946d23-859d-465a-ac32-6bdb038a0782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F75A4FD90>]}
[0m08:04:43.408431 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbo_seed_full_moon_dates.seed_full_moon_dates ....... [[32mINSERT 272[0m in 0.16s]
[0m08:04:43.408431 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m08:04:43.409430 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:04:43.410433 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:43.410433 [debug] [MainThread]: On master: BEGIN
[0m08:04:43.410433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:04:43.423432 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m08:04:43.423432 [debug] [MainThread]: On master: COMMIT
[0m08:04:43.423432 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:43.423432 [debug] [MainThread]: On master: COMMIT
[0m08:04:43.424566 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:04:43.424566 [debug] [MainThread]: On master: Close
[0m08:04:43.425576 [info ] [MainThread]: 
[0m08:04:43.425576 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m08:04:43.426605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:43.426605 [debug] [MainThread]: Connection 'create_postgres_dbo_seed_full_moon_dates' was properly closed.
[0m08:04:43.426605 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m08:04:43.426605 [debug] [MainThread]: Connection 'seed.dbtpostgres.seed_full_moon_dates' was properly closed.
[0m08:04:43.484574 [info ] [MainThread]: 
[0m08:04:43.485573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:04:43.486573 [info ] [MainThread]: 
[0m08:04:43.486573 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:04:43.487572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F75897D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F75A1A050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F75A75030>]}


============================== 2022-08-22 08:05:57.084479 | 8e8390d5-e68f-4a95-ac1c-e5b46ef5c649 ==============================
[0m08:05:57.084479 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:05:57.084479 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m08:05:57.084479 [debug] [MainThread]: Tracking: tracking
[0m08:05:57.098480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC00CFB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC00CD4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC00CF0D0>]}
[0m08:05:57.241480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:05:57.242480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:05:57.242480 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m08:05:57.249480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e8390d5-e68f-4a95-ac1c-e5b46ef5c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC03980D0>]}
[0m08:05:57.284481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e8390d5-e68f-4a95-ac1c-e5b46ef5c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC0360190>]}
[0m08:05:57.284481 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:05:57.285501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8390d5-e68f-4a95-ac1c-e5b46ef5c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC0360310>]}
[0m08:05:57.286511 [info ] [MainThread]: 
[0m08:05:57.287480 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:05:57.288515 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:05:57.296510 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:05:57.296510 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:05:57.296510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:57.328482 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.03 seconds
[0m08:05:57.330481 [debug] [ThreadPool]: On list_postgres: Close
[0m08:05:57.332483 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m08:05:57.337482 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:05:57.338482 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m08:05:57.338482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:57.351805 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:05:57.351805 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:05:57.351805 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m08:05:57.354811 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m08:05:57.355842 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m08:05:57.355842 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m08:05:57.356812 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:05:57.358811 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:05:57.358811 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: BEGIN
[0m08:05:57.358811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:57.372014 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:05:57.372014 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:05:57.372014 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_full_moon_dates"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_full_moon_dates'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_full_moon_dates'
  
[0m08:05:57.375014 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:05:57.376014 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: ROLLBACK
[0m08:05:57.376014 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: Close
[0m08:05:57.377013 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m08:05:57.379015 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:05:57.379015 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m08:05:57.379015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:57.400926 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m08:05:57.401928 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:05:57.402926 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m08:05:57.408792 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m08:05:57.410783 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m08:05:57.413816 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m08:05:57.424831 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:57.425827 [debug] [MainThread]: On master: BEGIN
[0m08:05:57.426789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:05:57.473388 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m08:05:57.474436 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:57.474436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:05:57.498242 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
[0m08:05:57.499252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8390d5-e68f-4a95-ac1c-e5b46ef5c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC0354B20>]}
[0m08:05:57.500252 [debug] [MainThread]: On master: ROLLBACK
[0m08:05:57.502178 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:57.502178 [debug] [MainThread]: On master: BEGIN
[0m08:05:57.504177 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:05:57.505177 [debug] [MainThread]: On master: COMMIT
[0m08:05:57.505177 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:57.505177 [debug] [MainThread]: On master: COMMIT
[0m08:05:57.506178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:05:57.507177 [debug] [MainThread]: On master: Close
[0m08:05:57.507177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:05:57.508176 [info ] [MainThread]: 
[0m08:05:57.513175 [debug] [Thread-1 (]: Began running node seed.dbtpostgres.seed_full_moon_dates
[0m08:05:57.513175 [info ] [Thread-1 (]: 1 of 1 START seed file dbo_seed_full_moon_dates.seed_full_moon_dates ........... [RUN]
[0m08:05:57.514174 [debug] [Thread-1 (]: Acquiring new postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:05:57.514174 [debug] [Thread-1 (]: Began compiling node seed.dbtpostgres.seed_full_moon_dates
[0m08:05:57.514174 [debug] [Thread-1 (]: finished collecting timing info
[0m08:05:57.514174 [debug] [Thread-1 (]: Began executing node seed.dbtpostgres.seed_full_moon_dates
[0m08:05:57.548205 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:05:57.548205 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: BEGIN
[0m08:05:57.548205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:05:57.577768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:05:57.577768 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:05:57.577768 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "seed.dbtpostgres.seed_full_moon_dates"} */
truncate table "postgres"."dbo_seed_full_moon_dates"."seed_full_moon_dates"
[0m08:05:57.580767 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m08:05:57.627801 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:05:57.627801 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: 
          insert into "postgres"."dbo_seed_full_moon_dates"."seed_full_moon_dates" ("full_moon_date") values
          (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%...
[0m08:05:57.631013 [debug] [Thread-1 (]: SQL status: INSERT 0 272 in 0.0 seconds
[0m08:05:57.636020 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtpostgres.seed_full_moon_dates"
[0m08:05:57.652049 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: COMMIT
[0m08:05:57.652049 [debug] [Thread-1 (]: Using postgres connection "seed.dbtpostgres.seed_full_moon_dates"
[0m08:05:57.652049 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: COMMIT
[0m08:05:57.655068 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:05:57.656070 [debug] [Thread-1 (]: finished collecting timing info
[0m08:05:57.656070 [debug] [Thread-1 (]: On seed.dbtpostgres.seed_full_moon_dates: Close
[0m08:05:57.657067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8390d5-e68f-4a95-ac1c-e5b46ef5c649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC050AA40>]}
[0m08:05:57.657067 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbo_seed_full_moon_dates.seed_full_moon_dates ....... [[32mINSERT 272[0m in 0.14s]
[0m08:05:57.658098 [debug] [Thread-1 (]: Finished running node seed.dbtpostgres.seed_full_moon_dates
[0m08:05:57.659068 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:05:57.659068 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:57.660068 [debug] [MainThread]: On master: BEGIN
[0m08:05:57.660068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:05:57.688871 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m08:05:57.688871 [debug] [MainThread]: On master: COMMIT
[0m08:05:57.689868 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:57.689868 [debug] [MainThread]: On master: COMMIT
[0m08:05:57.690843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:05:57.690843 [debug] [MainThread]: On master: Close
[0m08:05:57.690843 [info ] [MainThread]: 
[0m08:05:57.691849 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m08:05:57.691849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:57.691849 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m08:05:57.692849 [debug] [MainThread]: Connection 'list_postgres_dev' was properly closed.
[0m08:05:57.692849 [debug] [MainThread]: Connection 'seed.dbtpostgres.seed_full_moon_dates' was properly closed.
[0m08:05:57.728145 [info ] [MainThread]: 
[0m08:05:57.729150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:05:57.730151 [info ] [MainThread]: 
[0m08:05:57.730151 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:05:57.731150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC050ABF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC050B4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FC04FA7A0>]}


============================== 2022-08-22 08:06:04.791712 | d970c11e-0703-45c4-baea-2a368c5ce5cf ==============================
[0m08:06:04.791712 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:06:04.792712 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:06:04.792712 [debug] [MainThread]: Tracking: tracking
[0m08:06:04.805684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BAE0FB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BAE0D4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BAE0F0D0>]}
[0m08:06:04.955060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:06:04.955060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:06:04.956060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.dim
- models.dbt_postgres
- models.dbt_postgres.src

[0m08:06:04.962059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB0DC0D0>]}
[0m08:06:04.998062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB0A4190>]}
[0m08:06:04.999060 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:06:04.999060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB0A4310>]}
[0m08:06:05.001060 [info ] [MainThread]: 
[0m08:06:05.001060 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:06:05.003091 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:06:05.011090 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:06:05.011090 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:06:05.011090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:05.041124 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.03 seconds
[0m08:06:05.042168 [debug] [ThreadPool]: On list_postgres: Close
[0m08:06:05.044131 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m08:06:05.049128 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:06:05.049128 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m08:06:05.049128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:05.062174 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:06:05.062174 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:06:05.063172 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m08:06:05.065176 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:06:05.066173 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m08:06:05.067175 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m08:06:05.067175 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:06:05.069173 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:06:05.069173 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: BEGIN
[0m08:06:05.069173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:05.081792 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:06:05.081792 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:06:05.081792 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_full_moon_dates"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_full_moon_dates'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_full_moon_dates'
  
[0m08:06:05.084789 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:06:05.085790 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: ROLLBACK
[0m08:06:05.086790 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: Close
[0m08:06:05.086790 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m08:06:05.088790 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:06:05.088790 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m08:06:05.089790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:05.101790 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:06:05.101790 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:06:05.101790 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m08:06:05.104789 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m08:06:05.105791 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m08:06:05.106791 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m08:06:05.110792 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:05.110792 [debug] [MainThread]: On master: BEGIN
[0m08:06:05.111793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:05.124423 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m08:06:05.124423 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:05.124423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:06:05.139422 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
[0m08:06:05.140453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB098A30>]}
[0m08:06:05.140453 [debug] [MainThread]: On master: ROLLBACK
[0m08:06:05.142051 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:05.142051 [debug] [MainThread]: On master: BEGIN
[0m08:06:05.144057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:06:05.144057 [debug] [MainThread]: On master: COMMIT
[0m08:06:05.144057 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:05.144057 [debug] [MainThread]: On master: COMMIT
[0m08:06:05.145057 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:06:05.145057 [debug] [MainThread]: On master: Close
[0m08:06:05.146057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:06:05.146057 [info ] [MainThread]: 
[0m08:06:05.150055 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:05.150055 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m08:06:05.151056 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:05.151056 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:05.151056 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:05.154055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:05.156055 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.156055 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:05.189060 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:05.191090 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:05.192060 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m08:06:05.192060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:06:05.228951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m08:06:05.228951 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:05.229951 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m08:06:05.230950 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbo.seed_full_moon_dates" does not exist
LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                           ^

[0m08:06:05.230950 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: ROLLBACK
[0m08:06:05.231950 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.231950 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m08:06:05.231950 [debug] [Thread-1 (]: Database Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)
  relation "dbo.seed_full_moon_dates" does not exist
  LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
                             ^
  compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m08:06:05.232953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB234610>]}
[0m08:06:05.232953 [error] [Thread-1 (]: 1 of 8 ERROR creating table model dbo.mart_fullmoon_reviews .................... [[31mERROR[0m in 0.08s]
[0m08:06:05.233953 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:05.233953 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m08:06:05.233953 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m08:06:05.234953 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.234953 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m08:06:05.234953 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m08:06:05.236949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m08:06:05.238951 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.238951 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m08:06:05.254981 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m08:06:05.257337 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.257337 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m08:06:05.257337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:05.292044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:06:05.292044 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.293044 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m08:06:05.296045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:06:05.301043 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.301043 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m08:06:05.303044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.305044 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.305044 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m08:06:05.306044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.321075 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m08:06:05.322046 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.322046 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m08:06:05.324810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:05.329841 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:06:05.329841 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m08:06:05.333818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:06:05.334809 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.334809 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m08:06:05.335808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB28E4A0>]}
[0m08:06:05.335808 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m08:06:05.336808 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m08:06:05.337808 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m08:06:05.337808 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m08:06:05.338894 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.338894 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m08:06:05.338894 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m08:06:05.340932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m08:06:05.341930 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.342903 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m08:06:05.346930 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m08:06:05.348930 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.348930 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m08:06:05.349931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:05.387057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m08:06:05.387057 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.387057 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m08:06:05.390657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:06:05.392663 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.392663 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m08:06:05.394864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.396870 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.396870 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m08:06:05.397900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.398870 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m08:06:05.399870 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.399870 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m08:06:05.402416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:05.404414 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:06:05.404414 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m08:06:05.407414 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:06:05.408415 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.408415 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m08:06:05.409415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB23ADA0>]}
[0m08:06:05.409415 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m08:06:05.410415 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m08:06:05.410415 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m08:06:05.410415 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m08:06:05.411415 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.411415 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m08:06:05.411415 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m08:06:05.413414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m08:06:05.415414 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.415414 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m08:06:05.419415 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m08:06:05.421413 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.421413 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m08:06:05.421413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:05.448406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:06:05.449405 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.449405 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m08:06:05.451404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:06:05.454405 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.454405 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m08:06:05.455446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.458485 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.458485 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m08:06:05.459458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.460453 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m08:06:05.460453 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.461453 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m08:06:05.463455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:05.465451 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:06:05.465451 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m08:06:05.467452 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:06:05.468453 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.468453 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m08:06:05.469452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB101090>]}
[0m08:06:05.469452 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.06s]
[0m08:06:05.470455 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m08:06:05.470455 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m08:06:05.471454 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m08:06:05.471932 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.471932 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m08:06:05.471932 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m08:06:05.474968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.475970 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.475970 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m08:06:05.479937 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.480968 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.481938 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m08:06:05.481938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:05.509230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:06:05.510238 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.510238 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m08:06:05.512237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:06:05.516238 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.516238 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m08:06:05.517237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.518239 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m08:06:05.518239 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.518239 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m08:06:05.521246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:05.523235 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:06:05.523235 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m08:06:05.524235 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:06:05.525239 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.525239 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m08:06:05.526239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB2CD5A0>]}
[0m08:06:05.526239 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.05s]
[0m08:06:05.527238 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m08:06:05.527238 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m08:06:05.527238 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m08:06:05.528239 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.528239 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m08:06:05.529236 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m08:06:05.531236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.533235 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.533235 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m08:06:05.537238 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.538264 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.539237 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m08:06:05.539237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:05.552991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:06:05.552991 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.553991 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m08:06:05.555991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:06:05.558991 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.558991 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m08:06:05.560992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:05.561993 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m08:06:05.561993 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.561993 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m08:06:05.563991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:05.566990 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:06:05.567991 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m08:06:05.568280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:06:05.569317 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.569317 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m08:06:05.570318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB2DF670>]}
[0m08:06:05.570318 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m08:06:05.571288 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m08:06:05.571288 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m08:06:05.572286 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m08:06:05.572658 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:05.572658 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m08:06:05.572658 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m08:06:05.592696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m08:06:05.595698 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:05.595698 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m08:06:05.620665 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:05.620665 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp150605614665"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m08:06:05.621664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:06.950764 [debug] [Thread-1 (]: SQL status: SELECT 0 in 1.33 seconds
[0m08:06:06.956760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:06.956760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m08:06:06.958734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:06:06.958734 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:06.958734 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp150605614665'
        
      order by ordinal_position

  
[0m08:06:06.964730 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m08:06:06.968761 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:06.968761 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m08:06:06.972731 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:06:06.984761 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:06.985730 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp150605614665'
        
      order by ordinal_position

  
[0m08:06:06.988730 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:06:06.990764 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:06.991761 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m08:06:06.994730 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:06:07.001762 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:06:07.008760 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m08:06:07.011765 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:07.011765 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp150605614665"
    )
  
[0m08:06:07.013741 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m08:06:07.014760 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m08:06:07.014760 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:06:07.015729 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m08:06:07.017729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:07.018730 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:07.018730 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m08:06:07.018730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB2A1D20>]}
[0m08:06:07.019729 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 1.45s]
[0m08:06:07.020730 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m08:06:07.020730 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m08:06:07.021730 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m08:06:07.021730 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.021730 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m08:06:07.022732 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m08:06:07.024733 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.027731 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:07.027731 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m08:06:07.031728 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.033730 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.033730 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m08:06:07.033730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:07.059763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:06:07.059763 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.060730 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m08:06:07.063732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:06:07.066730 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.066730 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m08:06:07.067463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:06:07.069468 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m08:06:07.070468 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.070468 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m08:06:07.072792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:06:07.074799 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:06:07.074799 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m08:06:07.075316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:06:07.076353 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:07.076353 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m08:06:07.077323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd970c11e-0703-45c4-baea-2a368c5ce5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB239270>]}
[0m08:06:07.077323 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.06s]
[0m08:06:07.078336 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m08:06:07.079324 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:06:07.079324 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:07.079324 [debug] [MainThread]: On master: BEGIN
[0m08:06:07.080321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:06:07.092470 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m08:06:07.092470 [debug] [MainThread]: On master: COMMIT
[0m08:06:07.093497 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:07.093497 [debug] [MainThread]: On master: COMMIT
[0m08:06:07.094472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:06:07.094472 [debug] [MainThread]: On master: Close
[0m08:06:07.094472 [info ] [MainThread]: 
[0m08:06:07.095472 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m08:06:07.095472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:07.095472 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m08:06:07.096471 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m08:06:07.096471 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m08:06:07.134092 [info ] [MainThread]: 
[0m08:06:07.135096 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:06:07.136093 [info ] [MainThread]: 
[0m08:06:07.136093 [error] [MainThread]: [33mDatabase Error in model mart_fullmoon_reviews (models\mart\mart_fullmoon_reviews.sql)[0m
[0m08:06:07.137094 [error] [MainThread]:   relation "dbo.seed_full_moon_dates" does not exist
[0m08:06:07.137094 [error] [MainThread]:   LINE 14:     SELECT * FROM postgres.dbo.seed_full_moon_dates
[0m08:06:07.138092 [error] [MainThread]:                              ^
[0m08:06:07.138092 [error] [MainThread]:   compiled SQL at target\run\dbtpostgres\models\mart\mart_fullmoon_reviews.sql
[0m08:06:07.139091 [info ] [MainThread]: 
[0m08:06:07.139091 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m08:06:07.140093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB160CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB161030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137BB2F1930>]}


============================== 2022-08-22 08:06:48.796792 | d1f8ef86-2441-4039-8d30-65b1cb221c7e ==============================
[0m08:06:48.796792 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:06:48.796792 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:06:48.796792 [debug] [MainThread]: Tracking: tracking
[0m08:06:48.808794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028873F7FB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028873F7D4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028873F7F0D0>]}
[0m08:06:48.957076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:06:48.957076 [debug] [MainThread]: Partial parsing: updated file: dbtpostgres://models\mart\mart_fullmoon_reviews.sql
[0m08:06:48.968076 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
[0m08:06:48.991046 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_postgres.src
- models.dbt_postgres
- models.dbt_postgres.dim

[0m08:06:48.997076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874249870>]}
[0m08:06:49.033077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874207FA0>]}
[0m08:06:49.033077 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 622 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
[0m08:06:49.034073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288741C1990>]}
[0m08:06:49.035076 [info ] [MainThread]: 
[0m08:06:49.036047 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:06:49.037077 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:06:49.046045 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:06:49.046045 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:06:49.046045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:49.086046 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.04 seconds
[0m08:06:49.087046 [debug] [ThreadPool]: On list_postgres: Close
[0m08:06:49.089046 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:06:49.094046 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:06:49.094046 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: BEGIN
[0m08:06:49.094046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:49.130871 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m08:06:49.130871 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo_seed_full_moon_dates"
[0m08:06:49.131869 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo_seed_full_moon_dates"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo_seed_full_moon_dates'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo_seed_full_moon_dates'
  
[0m08:06:49.133866 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:06:49.135869 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: ROLLBACK
[0m08:06:49.135869 [debug] [ThreadPool]: On list_postgres_dbo_seed_full_moon_dates: Close
[0m08:06:49.136869 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m08:06:49.138870 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:06:49.138870 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m08:06:49.138870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:49.150854 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m08:06:49.151859 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m08:06:49.151859 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m08:06:49.153858 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m08:06:49.154860 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m08:06:49.156497 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m08:06:49.156497 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dev"
[0m08:06:49.159533 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:06:49.159533 [debug] [ThreadPool]: On list_postgres_dev: BEGIN
[0m08:06:49.159533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:49.178988 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m08:06:49.179984 [debug] [ThreadPool]: Using postgres connection "list_postgres_dev"
[0m08:06:49.180984 [debug] [ThreadPool]: On list_postgres_dev: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "list_postgres_dev"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m08:06:49.189138 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m08:06:49.192094 [debug] [ThreadPool]: On list_postgres_dev: ROLLBACK
[0m08:06:49.195101 [debug] [ThreadPool]: On list_postgres_dev: Close
[0m08:06:49.209149 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:49.210152 [debug] [MainThread]: On master: BEGIN
[0m08:06:49.211109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:49.262868 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m08:06:49.262868 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:49.263903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:06:49.285782 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
[0m08:06:49.287793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874295E40>]}
[0m08:06:49.287793 [debug] [MainThread]: On master: ROLLBACK
[0m08:06:49.289791 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:49.289791 [debug] [MainThread]: On master: BEGIN
[0m08:06:49.291909 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:06:49.292908 [debug] [MainThread]: On master: COMMIT
[0m08:06:49.292908 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:49.292908 [debug] [MainThread]: On master: COMMIT
[0m08:06:49.293907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:06:49.293907 [debug] [MainThread]: On master: Close
[0m08:06:49.293907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:06:49.294908 [info ] [MainThread]: 
[0m08:06:49.297907 [debug] [Thread-1 (]: Began running node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:49.297907 [info ] [Thread-1 (]: 1 of 8 START table model dbo.mart_fullmoon_reviews ............................. [RUN]
[0m08:06:49.298907 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:49.298907 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:49.298907 [debug] [Thread-1 (]: Compiling model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:49.301908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:49.303909 [debug] [Thread-1 (]: finished collecting timing info
[0m08:06:49.304907 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.mart_fullmoon_reviews
[0m08:06:49.336938 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:49.338913 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:49.339929 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: BEGIN
[0m08:06:49.339929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:06:49.353326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:06:49.354326 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:06:49.354326 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */


  create  table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp"
  as (
    

-- SQLINES LICENSE FOR EVALUATION USE ONLY
WITH fct_reviews AS (
    SELECT * FROM postgres.dbo.fct_reviews
),

full_moon_dates AS (
    SELECT * FROM postgres.dbo_seed_full_moon_dates.seed_full_moon_dates
)

-- SQLINES LICENSE FOR EVALUATION USE ONLY
SELECT
    r.*,
    CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
    r
    LEFT JOIN full_moon_dates
    fm
    ON (TO_DATE(r.review_date, 'YYYY-MM-DD') = INTERVAL '1 DAY' + fm.full_moon_date)
  );
[0m08:07:23.815312 [debug] [Thread-1 (]: SQL status: SELECT 3659460 in 34.46 seconds
[0m08:07:23.823314 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:07:23.823314 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */
alter table "postgres"."dbo"."mart_fullmoon_reviews__dbt_tmp" rename to "mart_fullmoon_reviews"
[0m08:07:23.830314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.01 seconds
[0m08:07:23.847314 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: COMMIT
[0m08:07:23.847314 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:07:23.847314 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: COMMIT
[0m08:07:23.859321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m08:07:23.864323 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.mart_fullmoon_reviews"
[0m08:07:23.865321 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.mart_fullmoon_reviews"} */
drop table if exists "postgres"."dbo"."mart_fullmoon_reviews__dbt_backup" cascade
[0m08:07:23.866323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:07:23.867321 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:23.867321 [debug] [Thread-1 (]: On model.dbtpostgres.mart_fullmoon_reviews: Close
[0m08:07:23.867321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288742EFE80>]}
[0m08:07:23.868322 [info ] [Thread-1 (]: 1 of 8 OK created table model dbo.mart_fullmoon_reviews ........................ [[32mSELECT 3659460[0m in 34.57s]
[0m08:07:23.869322 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.mart_fullmoon_reviews
[0m08:07:23.869322 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_hosts
[0m08:07:23.869322 [info ] [Thread-1 (]: 2 of 8 START view model dbo.src_hosts .......................................... [RUN]
[0m08:07:23.870322 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.870322 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_hosts
[0m08:07:23.870322 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_hosts
[0m08:07:23.872321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_hosts"
[0m08:07:23.874322 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:23.874322 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_hosts
[0m08:07:23.891323 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_hosts"
[0m08:07:23.893322 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.893322 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: BEGIN
[0m08:07:23.893322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:23.918235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m08:07:23.919237 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.919237 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */

  create view "postgres"."dbo"."src_hosts__dbt_tmp" as (
    WITH raw_hosts AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_hosts
)
SELECT
    "ID" AS host_id,
    "NAME" AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    raw_hosts
  );
[0m08:07:23.922237 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:07:23.924236 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.925235 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts" rename to "src_hosts__dbt_backup"
[0m08:07:23.926237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:23.929235 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.929235 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
alter table "postgres"."dbo"."src_hosts__dbt_tmp" rename to "src_hosts"
[0m08:07:23.930375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:23.933381 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m08:07:23.934379 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.934379 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: COMMIT
[0m08:07:23.936525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:23.938561 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_hosts"
[0m08:07:23.938561 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_hosts"} */
drop view if exists "postgres"."dbo"."src_hosts__dbt_backup" cascade
[0m08:07:23.941542 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:07:23.942531 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:23.942531 [debug] [Thread-1 (]: On model.dbtpostgres.src_hosts: Close
[0m08:07:23.943530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002887434BFD0>]}
[0m08:07:23.943530 [info ] [Thread-1 (]: 2 of 8 OK created view model dbo.src_hosts ..................................... [[32mCREATE VIEW[0m in 0.07s]
[0m08:07:23.944532 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_hosts
[0m08:07:23.944532 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_listings
[0m08:07:23.945532 [info ] [Thread-1 (]: 3 of 8 START view model dbo.src_listings ....................................... [RUN]
[0m08:07:23.945532 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_listings"
[0m08:07:23.946531 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_listings
[0m08:07:23.946531 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_listings
[0m08:07:23.948530 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_listings"
[0m08:07:23.951530 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:23.951530 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_listings
[0m08:07:23.954533 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_listings"
[0m08:07:23.956533 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:07:23.956533 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: BEGIN
[0m08:07:23.956533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:23.990292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m08:07:23.990292 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:07:23.990292 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */

  create view "postgres"."dbo"."src_listings__dbt_tmp" as (
    WITH raw_listings AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_listings
)
SELECT
    "ID" AS listing_id,
    "NAME" AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m08:07:23.993293 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:07:23.995293 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:07:23.996292 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings" rename to "src_listings__dbt_backup"
[0m08:07:23.997294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:24.000292 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:07:24.000292 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
alter table "postgres"."dbo"."src_listings__dbt_tmp" rename to "src_listings"
[0m08:07:24.001292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:24.002293 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m08:07:24.002293 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:07:24.003292 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: COMMIT
[0m08:07:24.004292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:24.006293 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_listings"
[0m08:07:24.007292 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_listings"} */
drop view if exists "postgres"."dbo"."src_listings__dbt_backup" cascade
[0m08:07:24.009293 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:07:24.010293 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.011293 [debug] [Thread-1 (]: On model.dbtpostgres.src_listings: Close
[0m08:07:24.011293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874248D00>]}
[0m08:07:24.011293 [info ] [Thread-1 (]: 3 of 8 OK created view model dbo.src_listings .................................. [[32mCREATE VIEW[0m in 0.07s]
[0m08:07:24.012294 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_listings
[0m08:07:24.012294 [debug] [Thread-1 (]: Began running node model.dbtpostgres.src_reviews
[0m08:07:24.013293 [info ] [Thread-1 (]: 4 of 8 START view model dbo.src_reviews ........................................ [RUN]
[0m08:07:24.013836 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.013836 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.src_reviews
[0m08:07:24.013836 [debug] [Thread-1 (]: Compiling model.dbtpostgres.src_reviews
[0m08:07:24.015842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.src_reviews"
[0m08:07:24.017861 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.017861 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.src_reviews
[0m08:07:24.020873 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.src_reviews"
[0m08:07:24.022842 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.022842 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: BEGIN
[0m08:07:24.022842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:24.036304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:07:24.036304 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.037303 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */

  create view "postgres"."dbo"."src_reviews__dbt_tmp" as (
    WITH raw_reviews AS (
    SELECT
    *
    FROM
    postgres.dbo.raw_reviews
)
SELECT
    listing_id,
    "DATE" AS review_date,
    reviewer_name,
    "COMMENTS" AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m08:07:24.039301 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:07:24.052304 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.052304 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews" rename to "src_reviews__dbt_backup"
[0m08:07:24.053303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:24.056303 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.056303 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
alter table "postgres"."dbo"."src_reviews__dbt_tmp" rename to "src_reviews"
[0m08:07:24.058302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:24.059304 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m08:07:24.059304 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.059304 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: COMMIT
[0m08:07:24.062079 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:24.065083 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.src_reviews"
[0m08:07:24.065083 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.src_reviews"} */
drop view if exists "postgres"."dbo"."src_reviews__dbt_backup" cascade
[0m08:07:24.068084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:07:24.069085 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.069085 [debug] [Thread-1 (]: On model.dbtpostgres.src_reviews: Close
[0m08:07:24.070087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288743A7D30>]}
[0m08:07:24.070087 [info ] [Thread-1 (]: 4 of 8 OK created view model dbo.src_reviews ................................... [[32mCREATE VIEW[0m in 0.06s]
[0m08:07:24.071084 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.src_reviews
[0m08:07:24.071084 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_hosts_cleansed
[0m08:07:24.071084 [info ] [Thread-1 (]: 5 of 8 START view model dbo.dim_hosts_cleansed ................................. [RUN]
[0m08:07:24.072087 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.072087 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_hosts_cleansed
[0m08:07:24.073086 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_hosts_cleansed
[0m08:07:24.075083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.077084 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.077084 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_hosts_cleansed
[0m08:07:24.080083 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.082059 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.082059 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: BEGIN
[0m08:07:24.082059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:24.096469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:07:24.096469 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.096469 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */

  create view "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" as (
    WITH src_hosts AS (
    SELECT * FROM "postgres"."dbo"."src_hosts"
)
SELECT
    host_id,
    COALESCE(host_name,'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m08:07:24.098466 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:07:24.100466 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.101468 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
alter table "postgres"."dbo"."dim_hosts_cleansed__dbt_tmp" rename to "dim_hosts_cleansed"
[0m08:07:24.101468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:24.103473 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m08:07:24.103473 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.103473 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: COMMIT
[0m08:07:24.106132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:24.108129 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_hosts_cleansed"
[0m08:07:24.108129 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_hosts_cleansed"} */
drop view if exists "postgres"."dbo"."dim_hosts_cleansed__dbt_backup" cascade
[0m08:07:24.109131 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:07:24.110130 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.110130 [debug] [Thread-1 (]: On model.dbtpostgres.dim_hosts_cleansed: Close
[0m08:07:24.110130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288743B02B0>]}
[0m08:07:24.111131 [info ] [Thread-1 (]: 5 of 8 OK created view model dbo.dim_hosts_cleansed ............................ [[32mCREATE VIEW[0m in 0.04s]
[0m08:07:24.111131 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_hosts_cleansed
[0m08:07:24.112131 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_cleansed
[0m08:07:24.112131 [info ] [Thread-1 (]: 6 of 8 START view model dbo.dim_listings_cleansed .............................. [RUN]
[0m08:07:24.112131 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.113131 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_cleansed
[0m08:07:24.113131 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_cleansed
[0m08:07:24.116130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.118131 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.119133 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_cleansed
[0m08:07:24.123130 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.125131 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.125131 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: BEGIN
[0m08:07:24.125131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:24.139131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.01 seconds
[0m08:07:24.139131 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.139131 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */

  create view "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" as (
    WITH src_listings AS (
    SELECT * FROM "postgres"."dbo"."src_listings"
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    ROUND(CAST(REPLACE(price_str,'$', '') AS INTEGER), 2) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m08:07:24.142131 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:07:24.145129 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.145129 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
alter table "postgres"."dbo"."dim_listings_cleansed__dbt_tmp" rename to "dim_listings_cleansed"
[0m08:07:24.146130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:24.148130 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m08:07:24.148130 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.148130 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: COMMIT
[0m08:07:24.150132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:24.152130 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_cleansed"
[0m08:07:24.152130 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_cleansed"} */
drop view if exists "postgres"."dbo"."dim_listings_cleansed__dbt_backup" cascade
[0m08:07:24.153131 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:07:24.155130 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.155130 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_cleansed: Close
[0m08:07:24.155130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874248910>]}
[0m08:07:24.156134 [info ] [Thread-1 (]: 6 of 8 OK created view model dbo.dim_listings_cleansed ......................... [[32mCREATE VIEW[0m in 0.04s]
[0m08:07:24.157136 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_cleansed
[0m08:07:24.157136 [debug] [Thread-1 (]: Began running node model.dbtpostgres.fct_reviews
[0m08:07:24.157136 [info ] [Thread-1 (]: 7 of 8 START incremental model dbo.fct_reviews ................................. [RUN]
[0m08:07:24.158130 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:24.158130 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.fct_reviews
[0m08:07:24.158130 [debug] [Thread-1 (]: Compiling model.dbtpostgres.fct_reviews
[0m08:07:24.179932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.fct_reviews"
[0m08:07:24.181933 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:24.181933 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.fct_reviews
[0m08:07:24.207962 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:24.207962 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

    

  create temporary table "fct_reviews__dbt_tmp150724201962"
  as (
    
WITH src_reviews AS (
SELECT * FROM "postgres"."dbo"."src_reviews"
)
SELECT 
    md5(cast(coalesce(cast(listing_id as 
    varchar
), '') || '-' || coalesce(cast(review_date as 
    varchar
), '') || '-' || coalesce(cast(reviewer_name as 
    varchar
), '') || '-' || coalesce(cast(review_text as 
    varchar
), '') as 
    varchar
)) AS review_id,
    * 
FROM src_reviews
WHERE review_text is not null


    AND review_date > (select max(review_date) from "postgres"."dbo"."fct_reviews")

  );
  
[0m08:07:24.207962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:30.034637 [debug] [Thread-1 (]: SQL status: SELECT 0 in 5.83 seconds
[0m08:07:30.042641 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.042641 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: BEGIN
[0m08:07:30.043213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:07:30.044220 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.044220 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp150724201962'
        
      order by ordinal_position

  
[0m08:07:30.051768 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.01 seconds
[0m08:07:30.057740 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.057740 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m08:07:30.060738 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:07:30.073740 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.073740 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews__dbt_tmp150724201962'
        
      order by ordinal_position

  
[0m08:07:30.076738 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:07:30.079744 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.079744 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'fct_reviews'
        
        and table_schema = 'dbo'
        
      order by ordinal_position

  
[0m08:07:30.082771 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.0 seconds
[0m08:07:30.090740 [debug] [Thread-1 (]: 
    In "postgres"."dbo"."fct_reviews":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m08:07:30.098740 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.fct_reviews"
[0m08:07:30.101739 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.101739 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.fct_reviews"} */

      

    insert into "postgres"."dbo"."fct_reviews" ("review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment")
    (
        select "review_id", "listing_id", "review_date", "reviewer_name", "review_text", "review_sentiment"
        from "fct_reviews__dbt_tmp150724201962"
    )
  
[0m08:07:30.102768 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m08:07:30.104741 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m08:07:30.104741 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.fct_reviews"
[0m08:07:30.104741 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: COMMIT
[0m08:07:30.106944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:30.106944 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:30.107955 [debug] [Thread-1 (]: On model.dbtpostgres.fct_reviews: Close
[0m08:07:30.107955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874451150>]}
[0m08:07:30.108955 [info ] [Thread-1 (]: 7 of 8 OK created incremental model dbo.fct_reviews ............................ [[32mINSERT 0 0[0m in 5.95s]
[0m08:07:30.108955 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.fct_reviews
[0m08:07:30.109954 [debug] [Thread-1 (]: Began running node model.dbtpostgres.dim_listings_w_hosts
[0m08:07:30.109954 [info ] [Thread-1 (]: 8 of 8 START view model dbo.dim_listings_w_hosts ............................... [RUN]
[0m08:07:30.110955 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.110955 [debug] [Thread-1 (]: Began compiling node model.dbtpostgres.dim_listings_w_hosts
[0m08:07:30.110955 [debug] [Thread-1 (]: Compiling model.dbtpostgres.dim_listings_w_hosts
[0m08:07:30.145954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.147954 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:30.148958 [debug] [Thread-1 (]: Began executing node model.dbtpostgres.dim_listings_w_hosts
[0m08:07:30.151955 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.153953 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.154954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: BEGIN
[0m08:07:30.154954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:30.170955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m08:07:30.170955 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.170955 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */

  create view "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" as (
    WITH 
l AS (
    SELECT
    *
    FROM
    "postgres"."dbo"."dim_listings_cleansed"
),
h AS (
    SELECT *
    FROM "postgres"."dbo"."dim_hosts_cleansed"
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
  );
[0m08:07:30.174954 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:07:30.177954 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.177954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
alter table "postgres"."dbo"."dim_listings_w_hosts__dbt_tmp" rename to "dim_listings_w_hosts"
[0m08:07:30.178955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:07:30.180955 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m08:07:30.180955 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.180955 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: COMMIT
[0m08:07:30.182954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:07:30.185954 [debug] [Thread-1 (]: Using postgres connection "model.dbtpostgres.dim_listings_w_hosts"
[0m08:07:30.185954 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_postgres", "target_name": "dev", "node_id": "model.dbtpostgres.dim_listings_w_hosts"} */
drop view if exists "postgres"."dbo"."dim_listings_w_hosts__dbt_backup" cascade
[0m08:07:30.186954 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m08:07:30.188955 [debug] [Thread-1 (]: finished collecting timing info
[0m08:07:30.188955 [debug] [Thread-1 (]: On model.dbtpostgres.dim_listings_w_hosts: Close
[0m08:07:30.188955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f8ef86-2441-4039-8d30-65b1cb221c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288742D68F0>]}
[0m08:07:30.189956 [info ] [Thread-1 (]: 8 of 8 OK created view model dbo.dim_listings_w_hosts .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m08:07:30.190956 [debug] [Thread-1 (]: Finished running node model.dbtpostgres.dim_listings_w_hosts
[0m08:07:30.191956 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:07:30.191956 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:30.192955 [debug] [MainThread]: On master: BEGIN
[0m08:07:30.192955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:07:30.207954 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m08:07:30.207954 [debug] [MainThread]: On master: COMMIT
[0m08:07:30.208955 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:30.208955 [debug] [MainThread]: On master: COMMIT
[0m08:07:30.209955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:07:30.209955 [debug] [MainThread]: On master: Close
[0m08:07:30.210954 [info ] [MainThread]: 
[0m08:07:30.211958 [info ] [MainThread]: Finished running 1 table model, 6 view models, 1 incremental model in 0 hours 0 minutes and 41.17 seconds (41.17s).
[0m08:07:30.211958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:30.212956 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m08:07:30.212956 [debug] [MainThread]: Connection 'list_postgres_dev' was properly closed.
[0m08:07:30.212956 [debug] [MainThread]: Connection 'model.dbtpostgres.dim_listings_w_hosts' was properly closed.
[0m08:07:30.258954 [info ] [MainThread]: 
[0m08:07:30.259956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:07:30.260956 [info ] [MainThread]: 
[0m08:07:30.260956 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m08:07:30.261955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874297A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874297850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028874297910>]}


============================== 2022-08-22 08:36:22.465760 | ab0ba8e1-2ac5-491c-a581-867deffc316f ==============================
[0m08:36:22.465760 [info ] [MainThread]: Running with dbt=1.2.0
[0m08:36:22.466759 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m08:36:22.466759 [debug] [MainThread]: Tracking: tracking
[0m08:36:22.484761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1732DF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1732DB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1732DD80>]}
[0m08:36:22.484761 [info ] [MainThread]: Setting up your profile.
[0m08:36:25.026398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1732DD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1732DBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A1732FC10>]}


============================== 2022-08-22 09:46:17.575092 | a12877a9-a5ac-43a2-97c7-f8732fe26e97 ==============================
09:46:17.575092 [info ] [MainThread]: Running with dbt=1.1.2
09:46:17.575092 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:46:17.576091 [debug] [MainThread]: Tracking: tracking
09:46:17.576091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025919869F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591986A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591986A440>]}
09:46:17.580120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591986A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591986B640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591986B730>]}


============================== 2022-08-22 09:47:16.397303 | 6d870b29-69d4-477b-aedc-b066da5d6efe ==============================
09:47:16.397303 [info ] [MainThread]: Running with dbt=1.1.2
09:47:16.397303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:47:16.398304 [debug] [MainThread]: Tracking: tracking
09:47:16.398304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A481CA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A481CA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A481CA380>]}
09:47:16.402304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A481CA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A481CBB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A481CBD60>]}


============================== 2022-08-22 09:48:46.299029 | 432efbec-c8d9-47ba-9823-997910249b3e ==============================
09:48:46.299029 [info ] [MainThread]: Running with dbt=1.1.2
09:48:46.300029 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
09:48:46.300029 [debug] [MainThread]: Tracking: tracking
09:48:46.313000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F50C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F51B0>]}
09:48:46.315029 [debug] [MainThread]: Set downloads directory='C:\Users\nkduy3\AppData\Local\Temp\dbt-downloads-pdsb2c1l'
09:48:46.315998 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
09:48:46.648058 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
09:48:46.649090 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
09:48:46.798249 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
09:48:46.805250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
09:48:46.969199 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
09:48:47.067191 [info ] [MainThread]: Installing Datavault-UK/dbtvault
09:48:47.864412 [info ] [MainThread]:   Installed from version 0.8.3
09:48:47.865412 [info ] [MainThread]:   Up to date!
09:48:47.865412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '432efbec-c8d9-47ba-9823-997910249b3e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F55D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F54E0>]}
09:48:47.866413 [info ] [MainThread]: Installing dbt-labs/dbt_utils
09:48:49.004067 [info ] [MainThread]:   Installed from version 0.8.6
09:48:49.005036 [info ] [MainThread]:   Up to date!
09:48:49.005036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '432efbec-c8d9-47ba-9823-997910249b3e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D32711B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D3271000>]}
09:48:49.006064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31C44F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288D31F4BB0>]}


============================== 2022-08-22 09:48:56.298617 | ac5f522e-09e8-4cfd-949b-54569e66ec9a ==============================
09:48:56.298617 [info ] [MainThread]: Running with dbt=1.1.2
09:48:56.298617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:48:56.298617 [debug] [MainThread]: Tracking: tracking
09:48:56.299618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA5649FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA564A440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA564A470>]}
09:48:56.303618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA564A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA564B670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA564B520>]}


============================== 2022-08-22 09:49:16.313236 | 9f3d67bf-0b95-444a-8078-8fb9e7175e82 ==============================
09:49:16.313236 [info ] [MainThread]: Running with dbt=1.1.2
09:49:16.313236 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:49:16.314204 [debug] [MainThread]: Tracking: tracking
09:49:16.314204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1939E020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1939E1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1939E260>]}
09:49:16.318204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1939E170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1939EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE1939EF20>]}


============================== 2022-08-22 09:54:06.117065 | 1115f303-3063-42a7-804b-7cde589f2e34 ==============================
09:54:06.117065 [info ] [MainThread]: Running with dbt=1.1.2
09:54:06.118068 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:54:06.118068 [debug] [MainThread]: Tracking: tracking
09:54:06.118068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638BFDDF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638BFDE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638BFDE440>]}
09:54:06.161070 [info ] [MainThread]: Unable to do partial parsing because of a dbt version mismatch. Saved manifest version: 1.2.0. Current version: 1.1.2.
09:54:06.162042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1115f303-3063-42a7-804b-7cde589f2e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638BFB5600>]}
09:54:06.558743 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
09:54:06.559746 [debug] [MainThread]: Parsing macros\positive_value.sql
09:54:06.560743 [debug] [MainThread]: Parsing macros\adapters.sql
09:54:06.560743 [debug] [MainThread]: Parsing macros\adapters\columns.sql
09:54:06.567743 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
09:54:06.568743 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
09:54:06.575743 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
09:54:06.579743 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
09:54:06.579743 [debug] [MainThread]: Parsing macros\adapters\relation.sql
09:54:06.584743 [debug] [MainThread]: Parsing macros\adapters\schema.sql
09:54:06.586744 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
09:54:06.590743 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
09:54:06.592742 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
09:54:06.593742 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
09:54:06.599744 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
09:54:06.601743 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
09:54:06.601743 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
09:54:06.602714 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
09:54:06.603743 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
09:54:06.608744 [debug] [MainThread]: Parsing macros\adapters\columns.sql
09:54:06.616745 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
09:54:06.618743 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
09:54:06.620713 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
09:54:06.627748 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
09:54:06.630745 [debug] [MainThread]: Parsing macros\adapters\relation.sql
09:54:06.638743 [debug] [MainThread]: Parsing macros\adapters\schema.sql
09:54:06.640743 [debug] [MainThread]: Parsing macros\etc\datetime.sql
09:54:06.647714 [debug] [MainThread]: Parsing macros\etc\statement.sql
09:54:06.651748 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
09:54:06.652746 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
09:54:06.653746 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
09:54:06.654742 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
09:54:06.655742 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
09:54:06.656743 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
09:54:06.657742 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
09:54:06.659743 [debug] [MainThread]: Parsing macros\materializations\configs.sql
09:54:06.661743 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
09:54:06.665743 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
09:54:06.668743 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
09:54:06.677743 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
09:54:06.678746 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
09:54:06.691743 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
09:54:06.704742 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
09:54:06.706745 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
09:54:06.712743 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
09:54:06.715748 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
09:54:06.717743 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
09:54:06.718743 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
09:54:06.724743 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
09:54:06.737743 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
09:54:06.742745 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
09:54:06.752743 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
09:54:06.761743 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
09:54:06.762713 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
09:54:06.776742 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
09:54:06.777742 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
09:54:06.781742 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
09:54:06.782743 [debug] [MainThread]: Parsing tests\generic\builtin.sql
09:54:06.785743 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
09:54:06.789742 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
09:54:06.789742 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
09:54:06.798743 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
09:54:06.801747 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
09:54:06.803742 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
09:54:06.805742 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
09:54:06.806745 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
09:54:06.808743 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
09:54:06.819742 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
09:54:06.822745 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
09:54:06.826743 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
09:54:06.831742 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
09:54:06.833743 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
09:54:06.838743 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
09:54:06.843743 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
09:54:06.844743 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
09:54:06.866743 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
09:54:06.879743 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
09:54:06.889742 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
09:54:06.893745 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
09:54:06.898714 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
09:54:06.902746 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
09:54:06.908743 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
09:54:06.911746 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
09:54:06.915743 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
09:54:06.920748 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
09:54:06.923743 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
09:54:06.931743 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
09:54:06.932742 [debug] [MainThread]: Parsing macros\staging\stage.sql
09:54:06.941745 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
09:54:06.943746 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
09:54:06.944744 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
09:54:06.946743 [debug] [MainThread]: Parsing macros\supporting\hash.sql
09:54:06.965743 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
09:54:06.966744 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
09:54:06.971743 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
09:54:07.004743 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
09:54:07.017743 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
09:54:07.026745 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
09:54:07.036743 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
09:54:07.050751 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
09:54:07.068711 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
09:54:07.076711 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
09:54:07.077711 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
09:54:07.078711 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
09:54:07.113743 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
09:54:07.127743 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
09:54:07.138743 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
09:54:07.150743 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
09:54:07.162714 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
09:54:07.184714 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
09:54:07.193713 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
09:54:07.198714 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
09:54:07.206713 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
09:54:07.239714 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
09:54:07.252744 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
09:54:07.263747 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
09:54:07.274748 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
09:54:07.288744 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
09:54:07.289743 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
09:54:07.297743 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
09:54:07.298746 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
09:54:07.298746 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
09:54:07.300743 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
09:54:07.301744 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
09:54:07.303743 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
09:54:07.305743 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
09:54:07.307743 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
09:54:07.309743 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
09:54:07.310743 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
09:54:07.311743 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
09:54:07.314743 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
09:54:07.320743 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
09:54:07.322743 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
09:54:07.330743 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
09:54:07.332746 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
09:54:07.333743 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
09:54:07.334745 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
09:54:07.336743 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
09:54:07.337744 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
09:54:07.338743 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
09:54:07.342713 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
09:54:07.343713 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
09:54:07.351743 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
09:54:07.352743 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
09:54:07.353743 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
09:54:07.354714 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
09:54:07.356743 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
09:54:07.358715 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
09:54:07.363715 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
09:54:07.367715 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
09:54:07.369715 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
09:54:07.370715 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
09:54:07.373715 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
09:54:07.374716 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
09:54:07.376715 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
09:54:07.379715 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
09:54:07.380716 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
09:54:07.382715 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
09:54:07.383715 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
09:54:07.391715 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
09:54:07.393715 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
09:54:07.394715 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
09:54:07.396715 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
09:54:07.397715 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
09:54:07.399715 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
09:54:07.402715 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
09:54:07.403715 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
09:54:07.404716 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
09:54:07.407715 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
09:54:07.408715 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
09:54:07.409715 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
09:54:07.410715 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
09:54:07.411715 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
09:54:07.432715 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
09:54:07.436715 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
09:54:07.441715 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
09:54:07.445715 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
09:54:07.450715 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
09:54:07.453715 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
09:54:07.455715 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
09:54:07.457715 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
09:54:07.460715 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
09:54:07.466715 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
09:54:07.467715 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
09:54:07.469715 [debug] [MainThread]: Parsing macros\sql\groupby.sql
09:54:07.470715 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
09:54:07.475715 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
09:54:07.476715 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
09:54:07.478715 [debug] [MainThread]: Parsing macros\sql\pivot.sql
09:54:07.481715 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
09:54:07.483715 [debug] [MainThread]: Parsing macros\sql\star.sql
09:54:07.486715 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
09:54:07.489715 [debug] [MainThread]: Parsing macros\sql\union.sql
09:54:07.499715 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
09:54:07.506715 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
09:54:07.507715 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
09:54:07.509715 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
09:54:08.162748 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
09:54:08.172743 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
09:54:08.173746 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
09:54:08.175744 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
09:54:08.194747 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
09:54:08.196726 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
09:54:08.197743 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
09:54:08.199743 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
09:54:08.226743 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
09:54:08.349746 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_sqlserver.src
- models.dbt_sqlserver
- models.dbt_sqlserver.dim

09:54:08.354713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1115f303-3063-42a7-804b-7cde589f2e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638C3591E0>]}
09:54:08.387743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1115f303-3063-42a7-804b-7cde589f2e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638BFFF340>]}
09:54:08.387743 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 556 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
09:54:08.388713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1115f303-3063-42a7-804b-7cde589f2e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638C2F5540>]}
09:54:08.389714 [info ] [MainThread]: 
09:54:08.389714 [debug] [MainThread]: Acquiring new sqlserver connection "master"
09:54:08.391722 [debug] [ThreadPool]: Acquiring new sqlserver connection "list_master"
09:54:08.399753 [debug] [ThreadPool]: SQLServer adapter: Using sqlserver connection "list_master".
09:54:08.399753 [debug] [ThreadPool]: SQLServer adapter: On list_master: USE "master";
    select  name as [schema]
    from sys.schemas
  
09:54:08.399753 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:54:08.400743 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1431;Database=master;UID={SA};PWD=***;Application Name=dbt-sqlserver/1.1.0
09:54:08.554595 [debug] [ThreadPool]: SQLServer adapter: Could not connect to db: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Client unable to establish connection (-2146893019); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0)')
09:54:08.555124 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: USE "master";
    select  name as [schema]
    from sys.schemas
  
09:54:08.555124 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
09:54:08.555124 [debug] [ThreadPool]: On list_master: No close available on handle
09:54:08.555644 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: macro list_schemas
09:54:08.555644 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
09:54:08.556165 [debug] [MainThread]: Connection 'master' was properly closed.
09:54:08.556687 [debug] [MainThread]: Connection 'list_master' was properly closed.
09:54:08.557210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638C3592A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638C3E76A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638C3E7640>]}


============================== 2022-08-22 09:55:10.449318 | 31f4beba-f256-4205-9a4b-2243f45727ca ==============================
09:55:10.449318 [info ] [MainThread]: Running with dbt=1.1.2
09:55:10.449318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:55:10.450287 [debug] [MainThread]: Tracking: tracking
09:55:10.450287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CFECDF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CFECE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7CFECE440>]}
09:55:10.566320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
09:55:10.566320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
09:55:10.567317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_sqlserver
- models.dbt_sqlserver.dim
- models.dbt_sqlserver.src

09:55:10.573290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f4beba-f256-4205-9a4b-2243f45727ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D01780D0>]}
09:55:10.607930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f4beba-f256-4205-9a4b-2243f45727ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D012A6B0>]}
09:55:10.607930 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 556 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
09:55:10.607930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f4beba-f256-4205-9a4b-2243f45727ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D012A830>]}
09:55:10.609969 [info ] [MainThread]: 
09:55:10.609969 [debug] [MainThread]: Acquiring new sqlserver connection "master"
09:55:10.611702 [debug] [ThreadPool]: Acquiring new sqlserver connection "list_master"
09:55:10.619707 [debug] [ThreadPool]: SQLServer adapter: Using sqlserver connection "list_master".
09:55:10.619707 [debug] [ThreadPool]: SQLServer adapter: On list_master: USE "master";
    select  name as [schema]
    from sys.schemas
  
09:55:10.619707 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:55:10.620708 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1431;Database=master;UID={SA};PWD=***;Application Name=dbt-sqlserver/1.1.0
09:55:10.649784 [debug] [ThreadPool]: SQLServer adapter: Could not connect to db: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Client unable to establish connection (-2146893019); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0)')
09:55:10.650317 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: USE "master";
    select  name as [schema]
    from sys.schemas
  
09:55:10.650317 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
09:55:10.650852 [debug] [ThreadPool]: On list_master: No close available on handle
09:55:10.650852 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: macro list_schemas
09:55:10.650852 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
09:55:10.651386 [debug] [MainThread]: Connection 'master' was properly closed.
09:55:10.651917 [debug] [MainThread]: Connection 'list_master' was properly closed.
09:55:10.652446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D0129EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D02AA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D02AA560>]}


============================== 2022-08-22 09:57:15.839946 | 226f3142-44c4-47d9-bfe8-cb9ce5550925 ==============================
09:57:15.839946 [info ] [MainThread]: Running with dbt=1.1.2
09:57:15.841941 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:57:15.842938 [debug] [MainThread]: Tracking: tracking
09:57:15.842938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1955B9FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1955BA440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1955BA470>]}
09:57:15.992959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
09:57:15.992959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
09:57:15.993959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_sqlserver.src
- models.dbt_sqlserver
- models.dbt_sqlserver.dim

09:57:15.999928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '226f3142-44c4-47d9-bfe8-cb9ce5550925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1958680D0>]}
09:57:16.033960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '226f3142-44c4-47d9-bfe8-cb9ce5550925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19581A6E0>]}
09:57:16.033960 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 556 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
09:57:16.034932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '226f3142-44c4-47d9-bfe8-cb9ce5550925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19581A860>]}
09:57:16.035930 [info ] [MainThread]: 
09:57:16.036961 [debug] [MainThread]: Acquiring new sqlserver connection "master"
09:57:16.038029 [debug] [ThreadPool]: Acquiring new sqlserver connection "list_master"
09:57:16.046067 [debug] [ThreadPool]: SQLServer adapter: Using sqlserver connection "list_master".
09:57:16.046067 [debug] [ThreadPool]: SQLServer adapter: On list_master: USE "master";
    select  name as [schema]
    from sys.schemas
  
09:57:16.046067 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:57:16.047036 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1431;Database=master;UID={SA};PWD=***;Application Name=dbt-sqlserver/1.1.0
09:57:16.076115 [debug] [ThreadPool]: SQLServer adapter: Could not connect to db: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Client unable to establish connection (-2146893019); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0)')
09:57:16.076115 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: USE "master";
    select  name as [schema]
    from sys.schemas
  
09:57:16.076641 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
09:57:16.076641 [debug] [ThreadPool]: On list_master: No close available on handle
09:57:16.076641 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: macro list_schemas
09:57:16.077168 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
09:57:16.077691 [debug] [MainThread]: Connection 'master' was properly closed.
09:57:16.077691 [debug] [MainThread]: Connection 'list_master' was properly closed.
09:57:16.078211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C195819ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19599A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19599A590>]}


============================== 2022-08-22 10:00:04.799964 | 15a6a1ba-0ccb-4ff2-bbae-45d331313ff0 ==============================
10:00:04.799964 [info ] [MainThread]: Running with dbt=1.1.2
10:00:04.800965 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:00:04.800965 [debug] [MainThread]: Tracking: tracking
10:00:04.800965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289D39F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289D3A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289D3A440>]}
10:00:04.917000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:00:04.917000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:00:04.917967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_sqlserver.src
- models.dbt_sqlserver
- models.dbt_sqlserver.dim

10:00:04.924966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15a6a1ba-0ccb-4ff2-bbae-45d331313ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289FE80D0>]}
10:00:04.957965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15a6a1ba-0ccb-4ff2-bbae-45d331313ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289F9A6B0>]}
10:00:04.958966 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 556 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
10:00:04.958966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15a6a1ba-0ccb-4ff2-bbae-45d331313ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289F9A830>]}
10:00:04.959965 [info ] [MainThread]: 
10:00:04.960965 [debug] [MainThread]: Acquiring new sqlserver connection "master"
10:00:04.961965 [debug] [ThreadPool]: Acquiring new sqlserver connection "list_master"
10:00:04.969966 [debug] [ThreadPool]: SQLServer adapter: Using sqlserver connection "list_master".
10:00:04.970997 [debug] [ThreadPool]: SQLServer adapter: On list_master: USE "master";
    select  name as [schema]
    from sys.schemas
  
10:00:04.970997 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:00:04.970997 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1431;Database=master;UID={SA};PWD=***;Application Name=dbt-sqlserver/1.1.0
10:00:05.001399 [debug] [ThreadPool]: SQLServer adapter: Could not connect to db: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Client unable to establish connection (-2146893019); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0)')
10:00:05.001931 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: USE "master";
    select  name as [schema]
    from sys.schemas
  
10:00:05.001931 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
10:00:05.001931 [debug] [ThreadPool]: On list_master: No close available on handle
10:00:05.002457 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: macro list_schemas
10:00:05.002457 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
10:00:05.002977 [debug] [MainThread]: Connection 'master' was properly closed.
10:00:05.003493 [debug] [MainThread]: Connection 'list_master' was properly closed.
10:00:05.004020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C289F99EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28A11A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C28A11A560>]}


============================== 2022-08-22 10:02:31.989085 | 0162a9f6-70c4-4242-9922-3fc0f3284bb7 ==============================
10:02:31.989085 [info ] [MainThread]: Running with dbt=1.1.2
10:02:31.989085 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:02:31.990056 [debug] [MainThread]: Tracking: tracking
10:02:31.990056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38B0A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38B0A560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38B0A350>]}
10:02:32.107090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:02:32.107090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:02:32.107090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_sqlserver.dim
- models.dbt_sqlserver
- models.dbt_sqlserver.src

10:02:32.114055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0162a9f6-70c4-4242-9922-3fc0f3284bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38DB80D0>]}
10:02:32.148056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0162a9f6-70c4-4242-9922-3fc0f3284bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38D6A650>]}
10:02:32.149055 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 556 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
10:02:32.149055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0162a9f6-70c4-4242-9922-3fc0f3284bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38D6A7D0>]}
10:02:32.151055 [info ] [MainThread]: 
10:02:32.151055 [debug] [MainThread]: Acquiring new sqlserver connection "master"
10:02:32.152055 [debug] [ThreadPool]: Acquiring new sqlserver connection "list_master"
10:02:32.161055 [debug] [ThreadPool]: SQLServer adapter: Using sqlserver connection "list_master".
10:02:32.161055 [debug] [ThreadPool]: SQLServer adapter: On list_master: USE "master";
    select  name as [schema]
    from sys.schemas
  
10:02:32.161055 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:02:32.161055 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1431;Database=master;UID={SA};PWD=***;Application Name=dbt-sqlserver/1.1.0
10:02:32.190749 [debug] [ThreadPool]: SQLServer adapter: Could not connect to db: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Client unable to establish connection (-2146893019); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0)')
10:02:32.191271 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: USE "master";
    select  name as [schema]
    from sys.schemas
  
10:02:32.191271 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
10:02:32.191802 [debug] [ThreadPool]: On list_master: No close available on handle
10:02:32.191802 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: macro list_schemas
10:02:32.191802 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
10:02:32.192324 [debug] [MainThread]: Connection 'master' was properly closed.
10:02:32.192846 [debug] [MainThread]: Connection 'list_master' was properly closed.
10:02:32.193365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38D69E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38EEA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE38EEA500>]}


============================== 2022-08-22 10:05:25.144482 | a86d1570-f3f8-4649-b145-1378eb200669 ==============================
10:05:25.144482 [info ] [MainThread]: Running with dbt=1.1.2
10:05:25.144482 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\nkduy3\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:05:25.145484 [debug] [MainThread]: Tracking: tracking
10:05:25.145484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E74A9F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E74AA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E74AA440>]}
10:05:25.180484 [info ] [MainThread]: Unable to do partial parsing because profile has changed
10:05:25.181484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a86d1570-f3f8-4649-b145-1378eb200669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E7485600>]}
10:05:25.264484 [debug] [MainThread]: Parsing macros\no_nulls_in_columns.sql
10:05:25.265485 [debug] [MainThread]: Parsing macros\positive_value.sql
10:05:25.266485 [debug] [MainThread]: Parsing macros\adapters.sql
10:05:25.266485 [debug] [MainThread]: Parsing macros\adapters\columns.sql
10:05:25.270485 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
10:05:25.271485 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
10:05:25.278484 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
10:05:25.282485 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
10:05:25.282485 [debug] [MainThread]: Parsing macros\adapters\relation.sql
10:05:25.286485 [debug] [MainThread]: Parsing macros\adapters\schema.sql
10:05:25.289485 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
10:05:25.293485 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
10:05:25.296484 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
10:05:25.297485 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
10:05:25.303485 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
10:05:25.304485 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
10:05:25.305485 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
10:05:25.306485 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
10:05:25.307485 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
10:05:25.311484 [debug] [MainThread]: Parsing macros\adapters\columns.sql
10:05:25.320498 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
10:05:25.322485 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
10:05:25.325485 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
10:05:25.331484 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
10:05:25.334483 [debug] [MainThread]: Parsing macros\adapters\relation.sql
10:05:25.342483 [debug] [MainThread]: Parsing macros\adapters\schema.sql
10:05:25.344484 [debug] [MainThread]: Parsing macros\etc\datetime.sql
10:05:25.351485 [debug] [MainThread]: Parsing macros\etc\statement.sql
10:05:25.355483 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
10:05:25.356484 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
10:05:25.357484 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
10:05:25.358483 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
10:05:25.359484 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
10:05:25.360485 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
10:05:25.361485 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
10:05:25.363484 [debug] [MainThread]: Parsing macros\materializations\configs.sql
10:05:25.365484 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
10:05:25.369484 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
10:05:25.372485 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
10:05:25.381517 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
10:05:25.382516 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
10:05:25.395517 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
10:05:25.408517 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
10:05:25.410519 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
10:05:25.416516 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
10:05:25.419517 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
10:05:25.421516 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
10:05:25.422517 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
10:05:25.428517 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
10:05:25.441517 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
10:05:25.446517 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
10:05:25.457485 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
10:05:25.466485 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
10:05:25.467486 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
10:05:25.481485 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
10:05:25.482486 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
10:05:25.486485 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
10:05:25.488486 [debug] [MainThread]: Parsing tests\generic\builtin.sql
10:05:25.490485 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
10:05:25.494485 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
10:05:25.495486 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
10:05:25.503485 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
10:05:25.506485 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
10:05:25.508486 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
10:05:25.510486 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
10:05:25.512486 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
10:05:25.514485 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
10:05:25.525485 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
10:05:25.528485 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
10:05:25.532485 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
10:05:25.537486 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
10:05:25.539486 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
10:05:25.543485 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
10:05:25.549485 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
10:05:25.550486 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
10:05:25.571486 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
10:05:25.585485 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
10:05:25.595485 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
10:05:25.599486 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
10:05:25.604486 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
10:05:25.608485 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
10:05:25.614486 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
10:05:25.617486 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
10:05:25.620486 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
10:05:25.625486 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
10:05:25.629486 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
10:05:25.636486 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
10:05:25.637486 [debug] [MainThread]: Parsing macros\staging\stage.sql
10:05:25.647486 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
10:05:25.649486 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
10:05:25.650487 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
10:05:25.652486 [debug] [MainThread]: Parsing macros\supporting\hash.sql
10:05:25.671486 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
10:05:25.672487 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
10:05:25.677486 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
10:05:25.710485 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
10:05:25.722486 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
10:05:25.732486 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
10:05:25.742486 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
10:05:25.756486 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
10:05:25.773486 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
10:05:25.781486 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
10:05:25.782487 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
10:05:25.783487 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
10:05:25.817485 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
10:05:25.831486 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
10:05:25.841487 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
10:05:25.853487 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
10:05:25.865486 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
10:05:25.885486 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
10:05:25.894486 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
10:05:25.900487 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
10:05:25.907487 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
10:05:25.940486 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
10:05:25.952487 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
10:05:25.963488 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
10:05:25.973487 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
10:05:25.988487 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
10:05:25.988487 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
10:05:25.996487 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
10:05:25.997488 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
10:05:25.998488 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
10:05:25.999488 [debug] [MainThread]: Parsing macros\cross_db_utils\array_append.sql
10:05:26.001488 [debug] [MainThread]: Parsing macros\cross_db_utils\array_concat.sql
10:05:26.002488 [debug] [MainThread]: Parsing macros\cross_db_utils\array_construct.sql
10:05:26.005488 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
10:05:26.006488 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_array_to_string.sql
10:05:26.008488 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
10:05:26.010488 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
10:05:26.011488 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
10:05:26.014488 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
10:05:26.019488 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
10:05:26.021488 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
10:05:26.029487 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
10:05:26.031488 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
10:05:26.032488 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
10:05:26.033488 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
10:05:26.034488 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
10:05:26.036488 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
10:05:26.037488 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
10:05:26.040488 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
10:05:26.041488 [debug] [MainThread]: Parsing macros\cross_db_utils\listagg.sql
10:05:26.048488 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
10:05:26.049488 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
10:05:26.051488 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
10:05:26.052488 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
10:05:26.054488 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
10:05:26.055488 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
10:05:26.060488 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
10:05:26.064488 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
10:05:26.066488 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
10:05:26.067488 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
10:05:26.069488 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
10:05:26.071488 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
10:05:26.072488 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
10:05:26.075488 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
10:05:26.077488 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
10:05:26.078488 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
10:05:26.080488 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
10:05:26.087488 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
10:05:26.089488 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
10:05:26.090488 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
10:05:26.092488 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
10:05:26.094488 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
10:05:26.096488 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
10:05:26.098488 [debug] [MainThread]: Parsing macros\generic_tests\test_not_null_where.sql
10:05:26.099519 [debug] [MainThread]: Parsing macros\generic_tests\test_unique_where.sql
10:05:26.101520 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
10:05:26.103518 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
10:05:26.104518 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
10:05:26.105516 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
10:05:26.106519 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
10:05:26.107523 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
10:05:26.127519 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
10:05:26.131518 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
10:05:26.137488 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
10:05:26.141488 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
10:05:26.145488 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
10:05:26.148488 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
10:05:26.150489 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
10:05:26.153488 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
10:05:26.156488 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
10:05:26.161488 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
10:05:26.163488 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
10:05:26.164489 [debug] [MainThread]: Parsing macros\sql\groupby.sql
10:05:26.165489 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
10:05:26.170488 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
10:05:26.172489 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
10:05:26.173489 [debug] [MainThread]: Parsing macros\sql\pivot.sql
10:05:26.177488 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
10:05:26.178489 [debug] [MainThread]: Parsing macros\sql\star.sql
10:05:26.181488 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
10:05:26.184489 [debug] [MainThread]: Parsing macros\sql\union.sql
10:05:26.194488 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
10:05:26.200488 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
10:05:26.202489 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
10:05:26.204489 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
10:05:26.850491 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_hosts_cleansed.sql
10:05:26.861492 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_cleansed.sql
10:05:26.863493 [debug] [MainThread]: 1699: static parser successfully parsed dim\dim_listings_w_hosts.sql
10:05:26.865495 [debug] [MainThread]: 1603: static parser failed on fct\fct_reviews.sql
10:05:26.885495 [debug] [MainThread]: 1602: parser fallback to jinja rendering on fct\fct_reviews.sql
10:05:26.886495 [debug] [MainThread]: 1699: static parser successfully parsed mart\mart_fullmoon_reviews.sql
10:05:26.887495 [debug] [MainThread]: 1699: static parser successfully parsed src\src_hosts.sql
10:05:26.889495 [debug] [MainThread]: 1699: static parser successfully parsed src\src_listings.sql
10:05:26.891494 [debug] [MainThread]: 1699: static parser successfully parsed src\src_reviews.sql
10:05:27.039528 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_sqlserver.dim
- models.dbt_sqlserver.src
- models.dbt_sqlserver

10:05:27.045492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a86d1570-f3f8-4649-b145-1378eb200669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E785C190>]}
10:05:27.079526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a86d1570-f3f8-4649-b145-1378eb200669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E74CF340>]}
10:05:27.079526 [info ] [MainThread]: Found 8 models, 6 tests, 1 snapshot, 0 analyses, 556 macros, 0 operations, 1 seed file, 3 sources, 0 exposures, 0 metrics
10:05:27.080523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a86d1570-f3f8-4649-b145-1378eb200669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E779FA90>]}
10:05:27.081525 [info ] [MainThread]: 
10:05:27.082493 [debug] [MainThread]: Acquiring new sqlserver connection "master"
10:05:27.083494 [debug] [ThreadPool]: Acquiring new sqlserver connection "list_test_db"
10:05:27.091524 [debug] [ThreadPool]: SQLServer adapter: Using sqlserver connection "list_test_db".
10:05:27.091524 [debug] [ThreadPool]: SQLServer adapter: On list_test_db: USE "test_db";
    select  name as [schema]
    from sys.schemas
  
10:05:27.092523 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:05:27.092523 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=localhost,1431;Database=test_db;UID={SA};PWD=***;Application Name=dbt-sqlserver/1.1.0
10:05:27.123837 [debug] [ThreadPool]: SQLServer adapter: Could not connect to db: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]SSL Provider: The certificate chain was issued by an authority that is not trusted.\r\n (-2146893019) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Client unable to establish connection (-2146893019); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0)')
10:05:27.124359 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: USE "test_db";
    select  name as [schema]
    from sys.schemas
  
10:05:27.124359 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
10:05:27.124885 [debug] [ThreadPool]: On list_test_db: No close available on handle
10:05:27.124885 [debug] [ThreadPool]: SQLServer adapter: Error running SQL: macro list_schemas
10:05:27.124885 [debug] [ThreadPool]: SQLServer adapter: Rolling back transaction.
10:05:27.125405 [debug] [MainThread]: Connection 'master' was properly closed.
10:05:27.125922 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
10:05:27.126442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E785C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E78C0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E78C0970>]}
